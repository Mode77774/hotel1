!function(){"use strict";!function(){const e={builtVersion:"1.3.6",HOST:"https://test.userview.net",SDKENV:"production",MOCK_API_HOST:"http://172.31.103.7:8080",commitVersion:"unknown",UNUSED:null,version:"1.3.6",isProduction:!0,SDK_SELF_MARK:"userview.net/uv",SDK_SELF_LOG_URL:"https://test.userview.net"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}window&&(window.process={env:e})}();var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(n);var r=t(n.exports),o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function p(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var d,h=function(){function e(){this.list=new Array}return e.prototype.addListener=function(e,t){this.list.push({name:e,listener:t})},e.prototype.removeListener=function(e){this.list=this.list.filter((function(t){return t.name!=e}))},e.prototype.emitSync=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.list.filter((function(t){return t.name===e})).map((function(e){return e.listener})).forEach((function(e){return e.apply(void 0,p([],l(t),!1))}))},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){return n=this.list.filter((function(t){return t.name===e})).map((function(e){return e.listener})).map((function(e){return e.apply(void 0,p([],l(t),!1))})),[2,Promise.allSettled(n)]}))}))},e}(),f=new Uint8Array(16);function m(){if(!d&&!(d="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d(f)}var v=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function g(e){return"string"==typeof e&&v.test(e)}for(var y=[],b=0;b<256;++b)y.push((b+256).toString(16).substr(1));function w(e,t,n){var r=(e=e||{}).random||(e.rng||m)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase();if(!g(n))throw TypeError("Stringified UUID is invalid");return n}(r)}var S=function(){function e(){this.dispatcher=new h,this.streamId=w()}return e.shareInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setup=function(){k.log("[UserView/Stream] 创建流:streamId = ".concat(this.streamId)),window.addEventListener("beforeunload",this.closeStreamSyncHandler.bind(this))},e.prototype.closeStreamSyncHandler=function(){k.log("[UserView/Stream] 关闭流开始: streamId = ".concat(this.streamId)),this.dispatcher.emitSync("close",!1),k.log("[UserView/Stream] 关闭流并完成: streamId = ".concat(this.streamId))},e.prototype.closeStreamHandler=function(e,t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return k.log("[UserView/Stream] 关闭流开始: streamId = ".concat(this.streamId)),[4,this.dispatcher.emit("close",!!t).then((function(e){k.log("[UserView/Stream] 关闭流并完成:".concat(JSON.stringify(e)))}))];case 1:return e.sent(),[2]}}))}))},e.prototype.addCloseStreamListener=function(e){this.dispatcher.addListener("close",e)},e.prototype.removeCloseStreamListener=function(){this.dispatcher.removeListener("close")},e}(),k={log:window.console.log,safelog:window.console.log,error:window.console.error,safeerror:window.console.error,warn:window.console.warn,safewarn:window.console.warn},T=k.log,x=k.error,_=k.warn,I=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},C=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="UV_SDK_DEBUG(".concat(e,"):").concat(S.shareInstance().streamId),o="".concat(Date.now(),":");localStorage.setItem(r,(localStorage.getItem(r)||"")+"\n".concat(o)+t.map((function(e){return String(e)})).join(" "))};function E(e){"production"===e||"staging"===e?(k.log=I,k.error=I,k.warn=I,k.safelog=I,k.safeerror=I,k.safewarn=I):"local"===e?(k.log=C.bind(null,"log"),k.safelog=C.bind(null,"log"),k.error=C.bind(null,"error"),k.safeerror=C.bind(null,"error"),k.warn=C.bind(null,"warn"),k.safewarn=C.bind(null,"warn")):(k.log=T,k.error=x,k.warn=_,k.safelog=T,k.safeerror=x,k.safewarn=_)}E(process.env.SDKENV||"production");var O=process.env.builtVersion;function M(e){var t=!1;return e.filter((function(e){return!(!t&&-1!=e.indexOf("edge.userview.net"))&&(t=!0,!0)}))}function N(){var e=localStorage.getItem("debug_origin");return null!=e?e:location.protocol&&-1!=location.protocol.indexOf("http")?location.origin:""}function R(){var e=navigator.userAgent.toLocaleLowerCase(),t=/(?:windows phone)/.test(e),n=/(?:symbianos)/.test(e)||t,r=/(?:android|harmonyos)/.test(e),o=/(?:ipad|playbook)/.test(e)||/(?:tablet)/.test(e)||r&&!/(?:mobile)/.test(e),i=/(?:iphone)/.test(e)&&!o;return o?"平板":r||i?"手机":!i&&!r&&!n?"电脑":"未知"}function D(e){var t,n,r,o=navigator.userAgent.toLowerCase();return"ActiveXObject"in self?(n=(t=o.match(/msie ([\d.]+)/))||(t=o.match(/rv:([\d.]+)/))?t[1]:0,r=({"trident/7.0":11,"trident/6.0":10,"trident/5.0":9,"trident/4.0":8}[(t=o.match(/(trident\/[\d.]+|edge\/[\d.]+)/))?t[1]:void 0]||n)>0?"IE":void 0):r=(t=o.match(/oppobrowser\/([\d.]+)/))?"Oppo":(t=o.match(/biliapp\/([\d.]+)/))?"BiliApp":(t=o.match(/maimai/))?"MaiMai":(t=o.match(/dingtalk\/([\d.]+)/))?"DingTalk":(t=o.match(/bytedancewebview/))?"ByteDance":(t=o.match(/zhihuhybrid/))?"Zhihu":(t=o.match(/fxios\/([\d.]+)/))?"Firefox":(t=o.match(/crios\/([\d.]+)/))?"Chrome":(t=o.match(/quark\/([\d.]+)/))?"Quark":(t=o.match(/lark\/([\d.]+)/))?"Feishu":(t=o.match(/weibo\_\_([\d.]+)/))?"Weibo":(t=o.match(/vivobrowser\/([\d.]+)/))?"Vivo":(t=o.match(/baiduboxapp\/([\d.]+)/))?"Baidu":(t=o.match(/huaweibrowser\/([\d.]+)/))?"HuaweiBrowser":(t=o.match(/bingweb\/([\d.]+)/))?"Bing":(t=o.match(/miuibrowser\/([\d.]+)/))?"MIUIBrowser":(t=o.match(/qqbrowser\/([\d.]+)/))||(t=o.match(/mqbhd\/([\d.]+)/))||(t=o.match(/mqqbrowser\/([\d.]+)/))?"QQBrowser":(t=o.match(/ucbrowser\/([\d.]+)/))||(t=o.match(/uws\/([\d.]+)/))?"UCBrowser":(t=o.match(/micromessenger\/([\d.]+)/))?"Wechat":(t=o.match(/edga\/([\d.]+)/))||(t=o.match(/edg\/([\d.]+)/))||(t=o.match(/edge\/([\d.]+)/))?"Edge":(t=o.match(/firefox\/([\d.]+)/))?"Firefox":(t=o.match(/opr\/([\d.]+)/))||(t=o.match(/opera.([\d.]+)/))?"Opera":(t=o.match(/chrome\/([\d.]+)/))?"Chrome":(t=o.match(/version\/([\d.]+).*safari/))?"Safari":"Unknown",r}function P(){var e=navigator.userAgent.toLowerCase();return{name:e.indexOf("harmonyos")>-1?"HarmonyOS":e.indexOf("windows nt")>-1?(e.indexOf("win32")>=0||e.indexOf("wow32")>=0||e.indexOf("win64")>=0||e.indexOf("wow64"),"Windows"):e.indexOf("iphone")>-1?"iOS":e.indexOf("ipad")>-1?e.indexOf("like mac")>-1?"iOS":"iPadOS":e.indexOf("mac")>-1?"Mac":e.indexOf("linux")>-1?e.indexOf("android")>-1?"Android":"Linux":e.indexOf("android")>-1?"Android":e.indexOf("x11")>-1||e.indexOf("unix")>-1||e.indexOf("sunname")>-1||e.indexOf("bsd")>-1?"Unix":"Unknown",version:"Unknown"}}window.ReadableStream||(window.ReadableStream={});var A,L,j,F,U=0;function B(e){void 0===e&&(e=!1);var t=null;if(e&&(A=null,"function"==typeof e&&(t=e)),A)return A;var n=0,r=function(e,t){var n,r=function e(t){return n={userdata:{},resetCtx:e,lastCountingTimeStartFlag:t||Date.now(),countingInterval:0,lastCountingValue:null,countingValue:null,countingTimes:0}};n=r();var o="function"==typeof t?t:function(e,r,o){var i=n.lastCountingValue,a=t||{},s=a.msInterval,u=a.incremental,c=a.times,l="function"==typeof c?c:function(){return c||20},p="function"==typeof u?u:function(){return u||10};return e>=("function"==typeof s?s:function(){return s||300})(e)||r>=l(r)||o-i>=p(o-i,o,i)};return function(t){var i=n.lastCountingTimeStartFlag,a=n.countingInterval,s=n.lastCountingValue;n.countingValue;var u=n.countingTimes,c=Date.now();n.countingTimes++;var l=t();n.countingValue=l,null==s&&(n.lastCountingValue=l),n.countingInterval=c-i,!0===o(a,u,l,n)?(e&&e(n),r(c)):n.lastCountingValue=l}}(t,(function(e,t,r,o){var i=o.userdata.addupValue;if(Date.now()-n<=3e4){o.userdata.addupValue=(i||0)+r,k.safelog("cls addup",o.userdata.addupValue);var a=void 0;return a=1,o.countingInterval>4e3||(a=2,t+1>20)||(a=3,i>.05)?(k.safelog("cls launched route",a,o.userdata.addupValue),!0):!1}return o.resetCtx(),k.safelog("cls reset",o),!1}));return A={tag:function(e){var t=e.timestamp||e.clientTs;t>n&&(n=t)},counter:r,clear:function(){A=null}}}L=["log","info","error","warn"],j=window.console,F=j||window.console,L&&L.forEach&&L.forEach((function(e){F["safe".concat(e)]=function(){}}));const q="function"==typeof atob,H="function"==typeof btoa,z="function"==typeof Buffer,V="function"==typeof TextDecoder?new TextDecoder:void 0,W="function"==typeof TextEncoder?new TextEncoder:void 0,$=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),K=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})($),G=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,X=String.fromCharCode.bind(String),J="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),Q=e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")),Y=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Z=e=>{let t,n,r,o,i="";const a=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255||(o=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|r<<8|o,i+=$[t>>18&63]+$[t>>12&63]+$[t>>6&63]+$[63&t]}return a?i.slice(0,a-3)+"===".substring(a):i},ee=H?e=>btoa(e):z?e=>Buffer.from(e,"binary").toString("base64"):Z,te=z?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,r=e.length;n<r;n+=4096)t.push(X.apply(null,e.subarray(n,n+4096)));return ee(t.join(""))},ne=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?X(192|t>>>6)+X(128|63&t):X(224|t>>>12&15)+X(128|t>>>6&63)+X(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return X(240|t>>>18&7)+X(128|t>>>12&63)+X(128|t>>>6&63)+X(128|63&t)},re=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,oe=e=>e.replace(re,ne),ie=z?e=>Buffer.from(e,"utf8").toString("base64"):W?e=>te(W.encode(e)):e=>ee(oe(e)),ae=(e,t=!1)=>t?Q(ie(e)):ie(e),se=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ue=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return X(55296+(t>>>10))+X(56320+(1023&t));case 3:return X((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return X((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},ce=e=>e.replace(se,ue),le=e=>{if(e=e.replace(/\s+/g,""),!G.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,r,o="";for(let i=0;i<e.length;)t=K[e.charAt(i++)]<<18|K[e.charAt(i++)]<<12|(n=K[e.charAt(i++)])<<6|(r=K[e.charAt(i++)]),o+=64===n?X(t>>16&255):64===r?X(t>>16&255,t>>8&255):X(t>>16&255,t>>8&255,255&t);return o},pe=q?e=>atob(Y(e)):z?e=>Buffer.from(e,"base64").toString("binary"):le,de=z?e=>J(Buffer.from(e,"base64")):e=>J(pe(e),(e=>e.charCodeAt(0))),he=z?e=>Buffer.from(e,"base64").toString("utf8"):V?e=>V.decode(de(e)):e=>ce(pe(e)),fe=e=>Y(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),me=e=>he(fe(e)),ve=ae,ge=me;var ye,be=function(){function e(e){this.mapping=new Map,this.host=e}return e.prototype.get=function(e){return this.mapping.get(e)},e.prototype.has=function(e){return this.mapping.has(e)},e.prototype.save=function(e,t){this.mapping.set(e,t)},e.prototype.set=function(e,t){var n=this.mapping.get(e);t&&t(n)||(this.host[e]=n,this.drop(e))},e.prototype.drop=function(e){this.mapping.delete(e)},e}(),we="net.userview.sdk",Se=function(){function e(){this.prefab=new be(this)}return e.shareInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setup=function(t){var n,o;this.projectKey=t;var i=this.mergeDeviceId(),a={deviceId:null!=i?i:e.generateDeviceIdentifier(),projects:[{projectKey:t,user:this.mergeUserInfo()}]};if(window.localStorage){var s=window.localStorage.getItem(we);try{var u=JSON.parse(ge(s));for(var l in u)if("deviceId"===l&&"string"==typeof u.deviceId&&(a.deviceId=u.deviceId),"projects"===l&&"object"===r(u.projects))try{for(var p=(n=void 0,c(u.projects)),d=p.next();!d.done;d=p.next()){var h=d.value;h.projectKey===t&&a.projects.splice(0,1),a.projects.push(h)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}catch(e){}}this.localStorage=a,this.synchronize(this.localStorage)},e.prototype.synchronize=function(e){var t=ve(e?JSON.stringify(e):"");window.localStorage.setItem(we,t)},Object.defineProperty(e.prototype,"deviceId",{get:function(){return this.localStorage.deviceId},enumerable:!1,configurable:!0}),e.prototype.resetDeviceId=function(t){this.localStorage.deviceId=t||e.generateDeviceIdentifier(),this.synchronize(this.localStorage)},Object.defineProperty(e.prototype,"user",{get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.user},set:function(e){var t=a({},e);e.uid?t.uid="string"==typeof e.uid?e.uid:String(e.uid):t.uid="",this.project.user=e,this.synchronize(this.localStorage)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"project",{get:function(){var e,t,n=this;return null===(t=null===(e=this.localStorage)||void 0===e?void 0:e.projects)||void 0===t?void 0:t.find((function(e){return(null==e?void 0:e.projectKey)===n.projectKey}))},enumerable:!1,configurable:!0}),e.generateDeviceIdentifier=function(){return w()},e.prototype.mergeUserInfo=function(){var e={uid:"",info:{}},t=window.localStorage.getItem("eaThirdUserInfo");try{var n=JSON.parse(t);"number"==typeof(null==n?void 0:n.uid)&&(e.uid=(null==n?void 0:n.uid).toString()),e.info.email=null==n?void 0:n.email,e.info.name=null==n?void 0:n.username,e.info.phone=null==n?void 0:n.phone}catch(e){}finally{t&&window.localStorage.removeItem("eaThirdUserInfo")}return e},e.prototype.mergeDeviceId=function(){var e=window.localStorage.getItem("eaDeviceId");return e&&window.localStorage.removeItem("eaDeviceId"),e},e.prototype.get=function(e){return this.project[e]},e.prototype.set=function(e,t){return this.project[e]=t,this.synchronize(this.localStorage),!0},e.prototype.setBool=function(e,t){return"boolean"==typeof t&&this.set(e,t)},e.prototype.setNumber=function(e,t){return"number"==typeof t&&this.set(e,t)},e.prototype.setString=function(e,t){return"string"==typeof t&&this.set(e,t)},e.prototype.setObject=function(e,t){return"object"===r(t)&&this.set(e,JSON.stringify(t))},e.prototype.bool=function(e){var t=this.get(e);return"boolean"==typeof t?t:void 0},e.prototype.number=function(e){var t=this.get(e);return"number"==typeof t?t:void 0},e.prototype.string=function(e){var t=this.get(e);return"string"==typeof t?t:void 0},e.prototype.object=function(e){try{var t=JSON.parse(this.get(e));return"object"===r(t)?t:void 0}catch(e){return}},e}();try{var ke=[we],Te=window.localStorage,xe=Te.clear;Te.clear=function(){var e=ke.map((function(e){return Te.getItem(e)}));xe.call(Te),ke.forEach((function(t,n){null!==e[n]&&Te.setItem(t,e[n])}))}}catch(e){k.safelog(e)}function _e(e,t,n){for(var r=[],o=Math.max(e.length,t.length),i=0,a=0;a<o||i;){var s=i+(a<e.length?e[a]:0)+(a<t.length?t[a]:0);r.push(s%n),i=Math.floor(s/n),a++}return r}function Ie(e,t,n){if(e<0)return null;if(0==e)return[];for(var r=[],o=t;1&e&&(r=_e(r,o,n)),0!=(e>>=1);)o=_e(o,o,n);return r}function Ce(e,t,n){var r=function(e,t){for(var n=e.split(""),r=[],o=n.length-1;o>=0;o--){var i=parseInt(n[o],t);if(isNaN(i))return null;r.push(i)}return r}(e,t);if(null===r)return null;for(var o=[],i=[1],a=0;a<r.length;a++)r[a]&&(o=_e(o,Ie(r[a],i,n),n)),i=Ie(t,i,n);var s="";for(a=o.length-1;a>=0;a--)s+=o[a].toString(n);return s}String.prototype.startsWith=String.prototype.startsWith||function(e){for(var t=0,n=e.length;t<n;){if(this[t]!==e[t])return!1;t++}return t===n-1},function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var o,i=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof e&&e];for(var n=0;n<t.length;++n){var r=t[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function a(e,t){if(t)e:{var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in n))break e;n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function s(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function u(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}if(a("Symbol",(function(e){function t(e,t){this.A=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",o=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+o++,r)}})),a("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<t.length;o++){var a=i[t[o]];"function"==typeof a&&"function"!=typeof a.prototype[e]&&r(a.prototype,e,{configurable:!0,writable:!0,value:function(){return s(n(this))}})}return e})),"function"==typeof Object.setPrototypeOf)o=Object.setPrototypeOf;else{var c;e:{var l={};try{l.__proto__={a:!0},c=l.a;break e}catch(e){}c=!1}o=c?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=o;function d(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function h(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function f(e,t){return e.h=3,{value:t}}function m(e){this.g=new d,this.G=e}function v(e,t,n,r){try{var o=t.call(e.g.j,n);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return e.g.m=!1,o;var i=o.value}catch(t){return e.g.j=null,e.g.s(t),g(e)}return e.g.j=null,r.call(e.g,i),g(e)}function g(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function y(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){h(e.g);var n=e.g.j;return n?v(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),g(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function b(e,t){return t=new y(new m(t)),p&&e.prototype&&p(t,e.prototype),t}if(d.prototype.o=function(e){this.v=e},d.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},d.prototype.return=function(e){this.l={return:e},this.h=this.u},m.prototype.o=function(e){return h(this.g),this.g.j?v(this,this.g.j.next,e,this.g.o):(this.g.o(e),g(this))},m.prototype.s=function(e){return h(this.g),this.g.j?v(this,this.g.j.throw,e,this.g.o):(this.g.s(e),g(this))},a("Array.prototype.entries",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,o={next:function(){if(!r&&n<e.length){var o=n++;return{value:t(o,e[o]),done:!1}}return r=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o}(this,(function(e,t){return[e,t]}))}})),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var w=function(e,t){for(var n=0;n<e.length;n++)t(e[n])},S=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},k=function(e,t,n){return t instanceof Blob?(n=void 0!==n?String(n+""):"string"==typeof t.name?t.name:"blob",t.name===n&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],n)),[String(e),t]):[String(e),String(t)]},T=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},x="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,_=x.FormData,I=x.XMLHttpRequest&&x.XMLHttpRequest.prototype.send,C=x.Request&&x.fetch,E=x.navigator&&x.navigator.sendBeacon,O=x.Element&&x.Element.prototype,M=x.Symbol&&Symbol.toStringTag;M&&(Blob.prototype[M]||(Blob.prototype[M]="Blob"),"File"in x&&!File.prototype[M]&&(File.prototype[M]="File"));try{new File([],"")}catch(e){x.File=function(e,t,n){return e=new Blob(e,n||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(n&&void 0!==n.lastModified?new Date(n.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),M&&Object.defineProperty(e,M,{value:"File"}),e}}var N=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},R=function(e){this.i=[];var t=this;e&&w(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var n=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];w(n,(function(n){t.append(e.name,n)}))}else"select-multiple"===e.type||"select-one"===e.type?w(e.options,(function(n){!n.disabled&&n.selected&&t.append(e.name,n.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(n="textarea"===e.type?S(e.value):e.value,t.append(e.name,n))}))};if((t=R.prototype).append=function(e,t,n){T(arguments,2),this.i.push(k(e,t,n))},t.delete=function(e){T(arguments,1);var t=[];e=String(e),w(this.i,(function(n){n[0]!==e&&t.push(n)})),this.i=t},t.entries=function e(){var t,n=this;return b(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<n.i.length?e=f(e,n.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},t.forEach=function(e,t){T(arguments,1);for(var n=u(this),r=n.next();!r.done;r=n.next()){var o=u(r.value);r=o.next().value,o=o.next().value,e.call(t,o,r,this)}},t.get=function(e){T(arguments,1);var t=this.i;e=String(e);for(var n=0;n<t.length;n++)if(t[n][0]===e)return t[n][1];return null},t.getAll=function(e){T(arguments,1);var t=[];return e=String(e),w(this.i,(function(n){n[0]===e&&t.push(n[1])})),t},t.has=function(e){T(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},t.keys=function e(){var t,n,r,o,i=this;return b(e,(function(e){if(1==e.h&&(t=u(i),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,o=u(r),f(e,o.next().value));n=t.next(),e.h=2}))},t.set=function(e,t,n){T(arguments,2),e=String(e);var r=[],o=k(e,t,n),i=!0;w(this.i,(function(t){t[0]===e?i&&(i=!r.push(o)):r.push(t)})),i&&r.push(o),this.i=r},t.values=function e(){var t,n,r,o,i=this;return b(e,(function(e){if(1==e.h&&(t=u(i),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,(o=u(r)).next(),f(e,o.next().value));n=t.next(),e.h=2}))},R.prototype._asNative=function(){for(var e=new _,t=u(this),n=t.next();!n.done;n=t.next()){var r=u(n.value);n=r.next().value,r=r.next().value,e.append(n,r)}return e},R.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],n="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,r){return"string"==typeof e?t.push(n+N(S(r))+'"\r\n\r\n'+S(e)+"\r\n"):t.push(n+N(S(r))+'"; filename="'+N(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},R.prototype[Symbol.iterator]=function(){return this.entries()},R.prototype.toString=function(){return"[object FormData]"},O&&!O.matches&&(O.matches=O.matchesSelector||O.mozMatchesSelector||O.msMatchesSelector||O.oMatchesSelector||O.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),M&&(R.prototype[M]="FormData"),I){var D=x.XMLHttpRequest.prototype.setRequestHeader;x.XMLHttpRequest.prototype.setRequestHeader=function(e,t){D.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},x.XMLHttpRequest.prototype.send=function(e){e instanceof R?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),I.call(this,e)):I.call(this,e)}}C&&(x.fetch=function(e,t){return t&&t.body&&t.body instanceof R&&(t.body=t.body._blob()),C.call(this,e,t)}),E&&(x.navigator.sendBeacon=function(e,t){return t instanceof R&&(t=t._asNative()),E.call(this,e,t)}),x.FormData=R}}();class Ee{constructor(e){e=e||{},this.seq=0,this.mid=(e.mid||1)%1023,this.offset=e.offset||0,this.lastTime=0}generate(){const e=Date.now(),t=(e-this.offset).toString(2);this.lastTime==e?(this.seq++,this.seq>4095&&(this.seq=0)):this.seq=0,this.lastTime=e;let n=this.seq.toString(2),r=this.mid.toString(2);for(;n.length<12;)n="0"+n;for(;r.length<10;)r="0"+r;const o=t+r+n;let i="";for(let e=o.length;e>0;e-=4)i=parseInt(o.substring(e-4,e),2).toString(16)+i;return"0x"===(a=i).substring(0,2)&&(a=a.substring(2)),Ce(a=a.toLowerCase(),16,10);var a}}!function(e){e[e.USER_IDENTIFY_INVOKED=0]="USER_IDENTIFY_INVOKED",e[e.MAXINACTIVE_REACHED=1]="MAXINACTIVE_REACHED",e[e.MAX_TIME_REACHED=2]="MAX_TIME_REACHED",e[e.NO_CHANGE=3]="NO_CHANGE"}(ye||(ye={}));var Oe,Me="dev"===process.env.SDKENV?{session_log_message:"[UserView/Session]",MAX_TIME_UNIT:12e4,MAX_INACTIVE_DURATION:6e4,MIN_SESSION_DURATION:1e3}:"testing"===process.env.SDKENV||"testing1"===process.env.SDKENV?{session_log_message:"[UserView/Session]",MAX_TIME_UNIT:18e5,MAX_INACTIVE_DURATION:6e5,MIN_SESSION_DURATION:1e3}:{session_log_message:"[UserView/Session]",MAX_TIME_UNIT:864e5,MAX_INACTIVE_DURATION:18e5,MIN_SESSION_DURATION:1e3};!function(e){e[e.SessionStateStart=0]="SessionStateStart",e[e.SessionStateEnd=1]="SessionStateEnd"}(Oe||(Oe={}));var Ne=function(){function e(){this.dispatcher=new h,this.snowflake=new Ee({mid:42,offset:1639872e6}),this.createdTimestamp=-1,this.sliceTimestamp=-1}return e.shareInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setup=function(){},e.prototype.addSessionListener=function(e,t){e&&this.dispatcher.addListener("sessionEnd",e),t&&this.dispatcher.addListener("sessionStart",t)},e.prototype.creatSession=function(e){this.sessionId=Number(this.snowflake.generate()),this.createdTimestamp=e,k.log("[UserView/Session] 初始化会话: sessionId = ".concat(this.sessionId,", createdTimestamp = ").concat(this.createdTimestamp))},e.prototype.trackEvent=function(e){if(!e||!e.time)return{needSplit:!1};if(this.sessionId||this.creatSession(e.time),k.log("[UserView/Session] 追踪事件: sessionId = ".concat(this.sessionId,", deviceId = ").concat(Se.shareInstance().deviceId,", event = ").concat(JSON.stringify(e),", lastEvent = ").concat(JSON.stringify(this.lastActiveEvent))),e.active){var t=this.checkEventActiveState(e);if(this.lastActiveEvent=e,t)return{needSplit:!0,from:ye.MAXINACTIVE_REACHED,isFrequentInvoke:e.time-this.sliceTimestamp<Me.MIN_SESSION_DURATION}}return this.checkMaxDuration(e)?{needSplit:!0,from:ye.MAX_TIME_REACHED,isFrequentInvoke:e.time-this.sliceTimestamp<Me.MIN_SESSION_DURATION}:{needSplit:!1}},e.prototype.updateSession=function(e,t,n,r){void 0===n&&(n=function(){}),void 0===r&&(r=function(){}),this.slice(e,t,n,r)},e.prototype.slice=function(e,t,n,r){void 0===n&&(n=function(){}),void 0===r&&(r=function(){}),n(),this.sliceTimestamp=e,this.dispatcher.emit("sessionEnd",this.sessionId,t,{timestamp:e,lastEvent:this.lastActiveEvent}),k.log("[UserView/Session/slice] 切割会话开始: old sessionId = ".concat(this.sessionId,", time = ").concat(this.createdTimestamp)),this.createdTimestamp=e,this.lastActiveEvent=void 0,this.sessionId=Number(this.snowflake.generate()),r(),this.dispatcher.emit("sessionStart",this.sessionId,t,{timestamp:e,lastEvent:this.lastActiveEvent}),k.log("[UserView/Session/slice] 切割会话结束: new sessionId = ".concat(this.sessionId,", time = ").concat(this.createdTimestamp))},e.prototype.checkEventActiveState=function(e){if(void 0===this.lastActiveEvent)return!1;var t=e.time-this.lastActiveEvent.time;return t>=Me.MAX_INACTIVE_DURATION&&(k.log("[UserView/Session/slice] 满足 30 分钟不活跃切割会话条件: sessionId = ".concat(this.sessionId,", deviceId = ").concat(Se.shareInstance().deviceId,", 间隔 = ").concat(t,", 阈值 = ").concat(Me.MAX_INACTIVE_DURATION)),!0)},e.prototype.checkMaxDuration=function(e){var t=e.time-this.createdTimestamp;return t>=Me.MAX_TIME_UNIT&&(k.log("[UserView/Session/slice] 满足 24 小时切割会话条件: sessionId = ".concat(this.sessionId,", deviceId = ").concat(Se.shareInstance().deviceId,", 间隔 = ").concat(t,"， 阈值 = ").concat(Me.MAX_TIME_UNIT)),!0)},e}(),Re={},De={};Object.defineProperty(De,"__esModule",{value:!0}),De.race=De.run=void 0;De.run=function(e,t){var n,r=0,o=[],i=!1,a=[],s=window.performance.now();return n=function(){if(!i)if(r<e.length)for(;r<e.length;){var u=e[r];if(o.push(t(u)),r++,performance.now()-s>12)return s=performance.now(),void window.requestAnimationFrame(n)}else for(;a.length>0;){a.shift().resolve(o)}},n(),{cancel:function(){if(!i)for(i=!0;a.length>0;){a.shift().reject(o)}},get:function(){return new Promise((function(t,n){i?n(o):o.length!=e.length?a.push({resolve:t,reject:n}):t(o)}))}}},De.race=function(e,t){var n,r,o=0,i=!1,a=[],s=window.performance.now();return r=function(){if(!i)if(o<e.length)for(;o<e.length;){var u=e[o],c=t(u);if(c.success){for(n=c;a.length>0;){a.shift().resolve(c.result)}return}if(o++,performance.now()-s>12)return s=performance.now(),void window.requestAnimationFrame(r)}else for(;a.length>0;){a.shift().reject("No successful tasks")}},r(),{cancel:function(){if(!i)for(i=!0;a.length>0;){a.shift().reject("canceled")}},get:function(){return new Promise((function(t,r){i?r("canceled"):void 0===n?o>=e.length?r("No successful tasks"):a.push({resolve:t,reject:r}):t(n.result)}))}}};var Pe,Ae,Le={},je={};Pe=je,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.scanString=Pe.getString=Pe.scan=Pe.TokenType=void 0,function(e){e[e.Raw=0]="Raw"}(Ae=Pe.TokenType||(Pe.TokenType={})),Pe.scan=function(e,t,n,r){void 0===e.items&&(e.items=[{type:Ae.Raw,start:0,end:e.text.length}]);for(var o=[],i=function(i){var a=e.items[i];if(a.type==Ae.Raw){var s=e.text.substring(a.start,a.end),u=0;s.replace(t,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e.length-2,s=e[0],c=e[i];c>u&&o.push({type:Ae.Raw,start:a.start+u,end:a.start+c});for(var l={type:n,start:a.start+c,end:a.start+c+s.length},p=0;p<i&&p<r.length;p++){var d=r[p];"_"!=d&&(l[d]=e[p])}return o.push(l),u=c+s.length,""})),u<s.length&&o.push({type:Ae.Raw,start:a.start+u,end:a.start+s.length})}else o.push(a)},a=0;a<e.items.length;a++)i(a);e.items=o},Pe.getString=function(e,t){if('"'==e.charAt(t.start))return JSON.parse(e.substring(t.start,t.end));for(var n=[],r=t.start+1;r<t.end-1;r++){var o=e.charAt(r);if("\\"==o){var i=e.charAt(++r);switch(i){case"n":n.push("\n");case"r":n.push("\r");case"f":n.push("\f");case"t":n.push("\t");default:n.push(i)}}else n.push(o)}return n.join("")},Pe.scanString=function(e,t){void 0===e.items&&(e.items=[{type:Ae.Raw,start:0,end:e.text.length}]);for(var n=[],r=0;r<e.items.length;r++){var o=e.items[r];if(o.type==Ae.Raw){for(var i="",a=o.start,s=o.start;s<o.end;s++){var u=e.text[s];""==i?"'"!=u&&'"'!=u||(a<s&&n.push({type:Ae.Raw,start:a,end:s}),i=u,a=s):"\\"==u?s++:u==i&&(n.push({type:t,start:a,end:s+1}),a=s+1,i="")}a<s&&n.push({type:Ae.Raw,start:a,end:s})}else n.push(o)}e.items=n};var Fe={};!function(t){var n=e&&e.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=t.TokenType=void 0,function(e){e[e.RAW=0]="RAW",e[e.WHITESPACE=1]="WHITESPACE",e[e.ID=2]="ID",e[e.TAG=3]="TAG",e[e.CLASS=4]="CLASS",e[e.KEY=5]="KEY",e[e.VALUE=6]="VALUE",e[e.STRING=7]="STRING",e[e.OP=8]="OP",e[e.FUNC=9]="FUNC",e[e.ARG=10]="ARG"}(t.TokenType||(t.TokenType={}));var r=function(e){function t(t){var n=e.call(this)||this;return n.token=t,n}return n(t,e),t}(Error);t.TokenError=r}(Fe),Object.defineProperty(Le,"__esModule",{value:!0}),Le.getSelector=Le.getOptimizedSelector=Le.getOptimizedSelectorString=Le.newSelector=Le.forEach=Le.tokenizer=void 0;var Ue=je,Be=Fe,qe=function(){function e(e){this.source=e}return Object.defineProperty(e.prototype,"tokens",{get:function(){return void 0===this._tokens&&(this._tokens=He(this.source)),this._tokens},enumerable:!1,configurable:!0}),e.prototype.valid=function(){if(void 0===this._valided&&(this._valided=ze(this.tokens,(function(e){})),!0===this._valided&&"undefined"!=typeof document&&"function"==typeof document.querySelector))try{document.querySelector(this.source)}catch(e){this._valided={type:Be.TokenType.RAW,start:0,end:this.source.length}}return this._valided},e.prototype.format=function(e){var t=this;void 0===e&&(e=!0);var n=[],r=!1,o=ze(this.tokens,(function(e){e.type==Be.TokenType.WHITESPACE?r||(n.push(" "),r=!0):e.type==Be.TokenType.STRING?(r=!1,n.push((0,Ue.getString)(t.source,e))):(r=!1,n.push(t.source.substring(e.start,e.end)))}),e);if(!0!==o)throw new Be.TokenError(o);return n.join("")},e}();function He(e){var t={text:e};(0,Ue.scanString)(t,Be.TokenType.STRING),(0,Ue.scan)(t,/[\u3000 \t\r\n]+/g,Be.TokenType.WHITESPACE,[]),(0,Ue.scan)(t,/(\*=)|(\$=)|(\~=)|(\^=)|(\|=)/g,Be.TokenType.OP,[]),(0,Ue.scan)(t,/[\*\=\>\(\)\,\[\]\(\)\+\~]/g,Be.TokenType.OP,[]),(0,Ue.scan)(t,/\:[a-zA-Z\-0-9]+/g,Be.TokenType.FUNC,[]),(0,Ue.scan)(t,/\#[^\#\.\:\[\]]+/g,Be.TokenType.ID,[]),(0,Ue.scan)(t,/\.[^\#\.\:\[\]]+/g,Be.TokenType.CLASS,[]);for(var n=0,r=0,o=t.items;r<o.length;r++){var i=o[r];if(0==n)i.type==Be.TokenType.OP&&"["==e.substring(i.start,i.end)&&(n=1);else if(1==n)i.type==Be.TokenType.RAW?(i.type=Be.TokenType.KEY,n=2):i.type==Be.TokenType.OP&&"]"==e.substring(i.start,i.end)&&(n=0);else if(2==n){if(i.type==Be.TokenType.OP)"]"==e.substring(i.start,i.end)&&(n=0);else i.type==Be.TokenType.RAW&&(i.type=Be.TokenType.VALUE,n=3)}else if(3==n){if(i.type==Be.TokenType.OP)"]"==e.substring(i.start,i.end)&&(n=0)}}n=0;for(var a=0,s=t.items;a<s.length;a++){i=s[a];0==n?i.type==Be.TokenType.OP&&"("==e.substring(i.start,i.end)&&(n=1):1==n&&(i.type==Be.TokenType.RAW?i.type=Be.TokenType.ARG:i.type==Be.TokenType.OP&&")"==e.substring(i.start,i.end)&&(n=0))}return(0,Ue.scan)(t,/[a-zA-Z\-\_0-9]+/g,Be.TokenType.CLASS,[]),t.items}function ze(e,t,n){void 0===n&&(n=!1);for(var r=0,o=e;r<o.length;r++){var i=o[r];if(i.type==Be.TokenType.RAW){if(n)continue;return i}t(i)}return!0}function Ve(e){return new qe(e)}function We(e,t){return $e(e,t).join("")}function $e(e,t){var n=e.id(t),r=e.tagName(t),o=e.className(t);if(n&&!e.idSliceGnore)return["#".concat(n)];var i=[r];n&&i.push("#".concat(n));for(var a=0,s=o.split(" ");a<s.length;a++){var u=s[a].trim();u&&i.push(".".concat(u))}e.forEach(t,(function(e,t){t?i.push("[".concat(e,"='").concat(t,"']")):i.push("[".concat(e,"='']"))}));var c=e.nth(t);return c&&i.push(":nth-child(".concat(c,")")),i}function Ke(e,t){var n=e.id(t),r=e.parent(t),o=!e.idSliceGnore&&!!n;return r&&!o?"".concat(Ke(e,r)," > ").concat(We(e,t)):We(e,t)}function Ge(e,t,n){n=n||2;var r=$e(e,t),o=e.parent(t),i=r.join(""),a=1;for(o&&(a=o.querySelectorAll(i).length||1);o&&r.length>n;){r.pop();var s=r.join("");if((o.querySelectorAll(s).length||1)!==a)return i;i=s}return i}function Xe(e,t){var n=e.id(t),r=e.parent(t),o=!e.idSliceGnore&&!!n;return r&&!o?"".concat(Xe(e,r)," > ").concat(Ge(e,t)):Ge(e,t)}Le.tokenizer=He,Le.forEach=ze,Le.newSelector=Ve,Le.getOptimizedSelectorString=Xe,Le.getOptimizedSelector=function(e,t){return Ve(Xe(e,t))},Le.getSelector=function(e,t){return Ve(Ke(e,t))};var Je=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),Qe=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ye=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&Je(t,e,n);return Qe(t,e),t},Ze=e&&e.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(Re,"__esModule",{value:!0}),Re.getOptimizedSelector=at=Re.getSelector=Re.newSelector=Re.querySelectorAll=Re.querySelector=Re.race=Re.all=Re.is=void 0;var et=Ye(De),tt=Le;if(!Element.prototype.matches){var nt=Element.prototype;nt.matches=nt.matchesSelector||nt.mozMatchesSelector||nt.msMatchesSelector||nt.oMatchesSelector||nt.webkitMatchesSelector}function rt(e,t){return!!e.matches(t.source)&&t}Re.is=rt,Re.all=function(e,t){return et.run(t,(function(t){return rt(e,t)}))},Re.race=function(e,t){return et.race(t,(function(t){return{result:t,success:!1!==rt(e,t)}}))},Re.querySelector=function(e,t){return e.querySelector(t.source)},Re.querySelectorAll=function(e,t){return e.querySelectorAll(t.source)},Re.newSelector=tt.newSelector;var ot=function(){function e(e){this.options=e}return e.prototype.parent=function(e){return this.options.parent?this.options.parent(e):e==e.ownerDocument.body||this.options.root==e.parentElement?null:e.parentElement},e.prototype.firstChild=function(e){return this.options.firstChild?this.options.firstChild(e):e.firstElementChild},e.prototype.lastChild=function(e){return this.options.lastChild?this.options.lastChild(e):e.lastElementChild},e.prototype.nextSibling=function(e){return this.options.nextSibling?this.options.nextSibling(e):e.nextElementSibling},e.prototype.prevSibling=function(e){return this.options.prevSibling?this.options.prevSibling(e):e.previousElementSibling},e.prototype.tagName=function(e){return this.options.tagName?this.options.tagName(e):e.nodeName.toLocaleLowerCase()},e.prototype.className=function(e){return this.options.className?this.options.className(e):e.className},e.prototype.nth=function(e){return"function"==typeof this.options.nth?this.options.nth(e,it):it(e)},e.prototype.id=function(e){return this.options.id?this.options.id(e):e.getAttribute("id")},e.prototype.forEach=function(e,t){if(this.options.forEach)return this.options.forEach(e,t);for(var n=e.attributes.length,r=0;r<n;r++){var o=e.attributes[r];"id"!=o.name&&"class"!=o.name&&"style"!=o.name&&t(o.name,o.value)}},Object.defineProperty(e.prototype,"idSliceGnore",{get:function(){return!!this.options.idSliceGnore},enumerable:!1,configurable:!0}),e}();function it(e){if(!e.parentNode)return null;var t=Ze([],e.parentNode.childNodes,!0),n=null;return t.some((function(t,r){return e===t&&(n=r,!0)})),n}var at=Re.getSelector=function(e,t){return void 0===t&&(t={root:e.ownerDocument.documentElement}),(0,tt.getSelector)(new ot(t),e)};Re.getOptimizedSelector=function(e,t){return void 0===t&&(t={root:e.ownerDocument.documentElement}),(0,tt.getOptimizedSelector)(new ot(t),e)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var st=function(e,t){return st=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},st(e,t)};function ut(e,t){function n(){this.constructor=e}st(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ct,lt=function(){return lt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},lt.apply(this,arguments)};function pt(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(ct||(ct={})),ct.Document,ct.Text,ct.DocumentType,ct.CDATA,ct.Comment;var dt=lt({div:1,p:2,a:3,i:4,span:5,li:9,b:6,u:7,q:8},{"NodeType.Document":0,"NodeType.Text":10,"NodeType.DocumentType":11,"NodeType.CDATA":12,"NodeType.Comment":13}),ht=function(){function e(e,t){this.sourceMap=new Map,this.staticMap={},this.sourceId=8,this.startId=8,this.staticMap=e||{},this.sourceId=t||8,this.startId=t||8}return e.prototype.get=function(e){return this.staticMap[e]||this.sourceMap.get(e)},e.prototype.add=function(e){this.sourceId++,this.sourceMap.set(e,this.sourceId)},e.prototype.delete=function(e){this.sourceMap.delete(e)},e.prototype.clear=function(){this.sourceMap.clear(),this.sourceId=this.startId},e}(),ft=new(function(){function e(){this.TagMap=new ht(dt,16),this.attibuteKeyMap=new ht,this.contextMap=new ht}return e.prototype.get=function(e,t,n){"number"==typeof e&&(e=e.toString());var r=t.get(e);return n&&!r&&t.add(e),r||e},e.prototype.addTag=function(e){this.TagMap.add(e)},e.prototype.addAttribute=function(e){this.attibuteKeyMap.add(e)},e.prototype.addContext=function(e){this.contextMap.add(e)},e.prototype.getTag=function(e,t){return this.get(e,this.TagMap,t)},e.prototype.getAttribute=function(e,t){return this.get(e,this.attibuteKeyMap,t)},e.prototype.getContext=function(e,t){return this.get(e,this.contextMap,t)},e.prototype.clear=function(){this.TagMap.clear(),this.attibuteKeyMap.clear(),this.contextMap.clear()},e}()),mt=function(){function e(){this.searchTree={},this.source=[]}return e.prototype.encodeAdd=function(e,t){var n=this,r=n.source,o=n.searchTree,i=n.currentSearch,a=o;i&&(a=i.map);var s=a[e],u=r.length,c=u-1;if(this.currentSearchIndex=u,s)return this.currentSearch=s,this.currentSearch.vId=t||e,void(i?(r[c][0]=s.i,r[c][1]++,this.currentSearchIndex=c):r[u]=[s.i,1]);if(i){var l=r[c];1===l[1]&&(r[c]=i.vId||i.v),2===l[1]&&r[c].pop()}r[u]=t||e;var p={i:u,v:e,vId:t,map:{}};this.currentSearch=p,a[e]=p},e.prototype.clearEncode=function(){var e=this.currentSearch,t=this.source;if(this.currentSearch){var n=this.currentSearchIndex,r=this.source[n];Array.isArray(r)&&(1===r[1]&&(t[n]=e.vId||e.v),2===r[1]&&t[n].pop()),this.currentSearch=null}},e.prototype.get=function(){return this.source},e}(),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ut(t,e),t.prototype.pushDocument=function(e){this.source.push(e,0)},t.prototype.pushDocumentType=function(e){var t=e.id,n=e.name,r=e.publicId,o=e.systemId,i=ft.getTag("NodeType.DocumentType",!0);this.source.push(t,i,n,r,o)},t.prototype.pushElement=function(e){var t=e.id,n=e.tagName,r=e.isSVG,o=e.needBlock,i=e.attributes,a=e.isShadow,s=e.isShadowHost;this.source.push(t),this.clearEncode();var u=ft.getTag(n,!0);if(this.encodeAdd(n,u),r&&this.encodeAdd("__isSVG",1),o&&this.encodeAdd("__needBlock",2),a&&this.encodeAdd("__isShadow",3),s&&this.encodeAdd("__isShadowHost",4),i)for(var c in i){var l=ft.getAttribute(c,!0),p=ft.getContext(i[c],!0);this.encodeAdd(c,l),this.encodeAdd(i[c],p)}},t.prototype.pushTextNode=function(e){var t=e.id,n=e.textContent,r=e.isStyle,o=ft.getTag("NodeType.Text",!0);this.source.push(t,o),n&&this.source.push(ft.getContext(n,!0)),r&&this.source.push(1)},t.prototype.pushCdataSectionNode=function(e){var t=ft.getTag("NodeType.CDATA",!0);this.source.push(e,t)},t.prototype.pushCommentNode=function(e){var t=ft.getTag("NodeType.Comment",!0);this.source.push(e,t)},t.prototype.pushNodeId=function(e){e>0?this.source.push(-e):this.source.push(-2)},t.prototype.pushNode=function(e){switch(e.type){case ct.Document:this.pushDocument(e.id);break;case ct.DocumentType:this.pushDocumentType(e);break;case ct.Element:this.pushElement(e);break;case ct.Text:this.pushTextNode(e);break;case ct.CDATA:this.pushCdataSectionNode(e.id);break;case ct.Comment:this.pushCommentNode(e.id);break;default:return!1}},t.prototype.pop=function(){this.source.pop()},t}(mt);function gt(e){var t,n=null===(t=e)||void 0===t?void 0:t.host;return Boolean(n&&n.shadowRoot&&n.shadowRoot===e)}function yt(e){return"svg"===e.tagName||e instanceof SVGElement}function bt(e){if(!e||e.nodeType!==e.ELEMENT_NODE)return!1;var t=null==e?void 0:e.getAttribute("contenteditable");if(!0===t||""===t)return!0;var n=e.tagName||"";return"input"===(n=n.toLocaleLowerCase())||"textarea"===n||"select"===n}function wt(e){var t=e.tagName||"";if("img"===(t=t.toLocaleLowerCase()))return!0;if("source"===t){var n=e.parentNode;return"picture"===((null==n?void 0:n.tagName)||"").toLocaleLowerCase()}}function St(e,t){return!!t.test(e.getAttribute("placeholder")||"")||(!!t.test(e.getAttribute("id")||"")||(!!t.test(e.getAttribute("name")||"")||!!t.test(e.getAttribute("class")||"")))}function kt(e,t){var n;return function(){for(var r=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n&&clearTimeout(n),new Promise((function(i){n=setTimeout((function(){i(e.call.apply(e,pt([r],o))),n=null}),t)}))}}var Tt,xt,_t=["checked","data","action"],It=["alt","title","placeholder","value"],Ct=["style","class","id"],Et=String.fromCharCode(32);function Ot(e){if(e.nodeType!==e.ELEMENT_NODE)return"";var t=e.getBoundingClientRect(),n=t.width,r=t.height;return"max-width:"+n+"px;max-height:"+r+"px;min-width:"+n+"px;min-height:"+r+"px;"}function Mt(e,t){if(void 0===t&&(t="*"),!e||"string"!=typeof e)return e;for(var n=e.length,r="";n--;){var o=e[n];/\s|\n/.test(o)||(o=t),r=o+r}return r}function Nt(e){return e&&(_t.forEach((function(t){e.hasOwnProperty(t)&&delete e[t]})),It.forEach((function(t){var n=e[t];"string"==typeof n&&n&&(e[t]=Mt(n))}))),e}function Rt(e){var t=e.attributes,n=e.textContent;return t&&(e.attributes=Nt(t),e.attributes.class=e.attributes.class||"",e.attributes.class+=""+Et+At.maskText),n&&(e.textContent=Mt(n)),e}function Dt(e,t){var n,r=t.attributes||{};switch(null===(n=e.tagName)||void 0===n?void 0:n.toLocaleLowerCase()){case"source":r.srcset&&delete r.srcset;break;case"img":var o=Ot(e);r.style||(r.style=""),r.srcset&&delete r.srcset,r.style+=o,r.src=At.maskImage,r.class=r.class||"",r.class+=""+Et+At.maskImage}return t.attributes=r,t}function Pt(e,t){var n=Ot(e),r=t.attributes,o={};r&&(Ct.forEach((function(e){r.hasOwnProperty(e)&&(o[e]=r[e])})),Object.keys(r).forEach((function(e){/data\-/.test(e)&&(o[e]=r[e])})));var i=window.getComputedStyle(e).display;return i="display:"+(i=/^inline/.test(i)?"inline-block":"block")+";",o.style=(o.style||"")+n+i,o.class=o.class||"",o.class+=""+Et+At.maskAll,t.attributes=o,t.needBlock=!0,t}var At,Lt=function(){function e(){this._sizeMap={},this._cbId=1,this._cbMap={},this._cbOnlyMap={},this._resizeObs=null,this.resizeSupported="function"==typeof window.ResizeObserver,this.debounceHandle=kt(this.handleSize,100)}return e.prototype.initObserve=function(){var e=this;this.resizeSupported&&(this._resizeObs&&this._resizeObs.disconnect(),this._resizeObs=new window.ResizeObserver((function(t){var n=t.map((function(e){var t=e.target;return null==t?void 0:t._uv_id}));e.emit(n)})))},e.prototype.clear=function(){this._sizeMap={},this._cbId=1,this._cbMap={},this._cbOnlyMap={},this._resizeObs&&(this._resizeObs.disconnect(),this._resizeObs=null)},e.prototype.setDebounce=function(e){this.debounceHandle=kt(this.handleSize,e)},e.prototype.addResizeNode=function(e){if(this.resizeSupported){if(this._resizeObs||this.initObserve(),e.nodeType!==e.ELEMENT_NODE)return;this._resizeObs.unobserve(e),this._resizeObs.observe(e)}this.add(e)},e.prototype.removeResizeNode=function(e){this.resizeSupported&&this._sizeMap[e]&&this._resizeObs.unobserve(this._sizeMap[e].node),this.remove(e)},e.prototype.add=function(e){var t=e._uv_id,n=e.getBoundingClientRect(),r=n.width,o=n.height;this._sizeMap[t]={id:t,node:e,size:{width:r,height:o}}},e.prototype.remove=function(e){this._sizeMap[e]&&delete this._sizeMap[e],this._cbOnlyMap[e]&&delete this._cbOnlyMap[e]},e.prototype.resizeOnlyObserve=function(e,t){var n=this;if("function"==typeof t&&void 0!==e)return this._cbOnlyMap[e]=t,function(){delete n._cbOnlyMap[e]}},e.prototype.resizeObserve=function(e){var t=this;if("function"==typeof e){var n=++this._cbId;return this._cbMap[n]=e,function(){delete t._cbMap[n]}}},e.prototype.emit=function(e,t){var n=this;if(Array.isArray(e)){var r=0;if(e.forEach((function(e){n._sizeMap[e]&&(r++,n._sizeMap[e].resize=!0)})),!r)return}else Object.values(this._sizeMap).forEach((function(e){e.resize=!0}));t?this.handleSize():this.debounceHandle()},e.prototype.handleSize=function(){var e=this,t=[];Object.values(this._sizeMap).forEach((function(n){if(n.resize){var r=n.node.getBoundingClientRect(),o=r.width,i=r.height;if(o===n.size.width&&i===n.size.height)return;var a={id:n.id,width:o,height:i};t.push(a),n.resize=!1,n.size={width:o,height:i};var s=e._cbOnlyMap[n.id];"function"==typeof s&&s(a)}})),t.length&&Object.values(this._cbMap).forEach((function(e){"function"==typeof e&&e(t)}))},e}();!function(e){e.maskText="uv-mask-text",e.maskImage="uv-mask-image",e.maskContent="uv-mask-content",e.maskInteract="uv-mask-interact",e.maskAll="uv-mask-all",e.unMask="uv-mask-none",e.maskDefault="uv-mask-default",e.maskInput="uv-mask-input",e.maskPassword="uv-mask-password",e.maskPhone="uv-mask-phone",e.maskIdcard="uv-mask-idcard"}(At||(At={})),(Tt={})[At.maskText]=1,Tt[At.maskImage]=2,Tt[At.maskContent]=3,Tt[At.maskInteract]=4,Tt[At.maskAll]=7,Tt[At.unMask]=998,Tt[At.maskDefault]=999,Tt[At.maskInput]=8,Tt[At.maskPassword]=9,Tt[At.maskPhone]=10,Tt[At.maskIdcard]=11;var jt=((xt={})[At.maskText]=1,xt[At.maskImage]=2,xt[At.maskInput]=1,xt[At.maskPassword]=1,xt[At.maskPhone]=1,xt[At.maskIdcard]=1,xt[At.maskContent]=0,xt[At.maskAll]=0,xt[At.unMask]=0,xt[At.maskInteract]=4,xt[At.maskDefault]=999,xt),Ft=Object.values(At).reduce((function(e,t){return e[t]=!0,e}),{}),Ut=["html","head","style","link","meta"],Bt=function(e){function t(t,n){var r,o=e.call(this)||this;return o._gloabalRules=((r={})[At.maskPassword]=!0,r[At.maskInput]=!1,r[At.maskImage]=!1,r[At.maskPhone]=!0,r[At.maskIdcard]=!0,r),o._cssSelectorRules=[],o._cssSelectorRules=n||[],o.setGlobal(t),o}return ut(t,e),t.prototype.clearCssRule=function(){this._cssSelectorRules=[]},t.prototype.setCssRule=function(e){this._cssSelectorRules=e},t.prototype.addCssRule=function(e){this._cssSelectorRules.push(e)},t.prototype.matchCss=function(e){var t=this._cssSelectorRules.find((function(t){var n=t.selector;try{return e.matches(n)}catch(e){}}))||{};return t.mask},t.prototype.setGlobal=function(e){var t=this;void 0===e&&(e=[]),e.forEach((function(e){t._gloabalRules[e]=!0}))},t.prototype.mergeMask=function(e,t){return(e=e||At.maskDefault)===At.maskAll||e===At.unMask?e:jt[e]+jt[t]===3?At.maskContent:e===At.maskDefault&&Ft[t]?t:e},t.prototype.maskMergeContinue=function(e){return jt[e]>0},t.prototype.getGlobalMask=function(e){var t=function(e){return!(!bt(e)||"password"!==e.getAttribute("id")&&"password"!==e.getAttribute("type")&&"password"!==e.getAttribute("name")&&!/password/.test(e.getAttribute("class")||"")&&!/密码|password/.test(e.getAttribute("placeholder")||""))}(e);if(t)return At.maskPassword;var n=bt(e);return this._gloabalRules[At.maskInput]&&n||this._gloabalRules[At.maskPhone]&&n&&function(e){return!!e&&("tel"===e.getAttribute("type")||St(e,/phone|cell|tel|手机号/))}(e)||this._gloabalRules[At.maskIdcard]&&n&&function(e){return!!e&&("18"===e.getAttribute("maxlength")||St(e,/身份证/))}(e)?At.maskInput:this._gloabalRules[At.maskImage]?At.maskImage:At.maskDefault},t.prototype.checkMask=function(e,t){if(t||(t=this.findParentMask(e)),e.tagName&&Ut.includes(e.tagName.toLocaleLowerCase()))return At.maskDefault;if(e.nodeType!==e.ELEMENT_NODE)return t;var n=this.matchCss(e),r=this.mergeMask(n,e.getAttribute("uv-mask"));return this.maskMergeContinue(r)?(r=this.mergeMask(r,t),this.maskMergeContinue(r)?r=this.mergeMask(r,this.getGlobalMask(e)):r):r},t.prototype.nodeMask=function(e,t,n){this.getGlobalMask(e)===At.maskPassword&&t.attributes&&(t.attributes.value="");var r=this.getNodeMask(e,n);switch(r){case At.unMask:break;case At.maskAll:this.addResizeNode(e),t=Pt(e,t);break;case At.maskContent:t=Rt(t),wt(e)&&(this.addResizeNode(e),t=Dt(e,t));break;case At.maskImage:wt(e)&&(this.addResizeNode(e),t=Dt(e,t));break;case At.maskInput:case At.maskPassword:case At.maskText:t=Rt(t)}return e._uv_mask=r||At.maskDefault,{maskType:r,sNode:t}},t.prototype.getNodeMask=function(e,t){var n=this.checkMask(e,t),r=e._uv_mask;return n===At.maskDefault&&(n=r||n),n},t.prototype.textMask=function(e,t){if(!e||this.getGlobalMask(e)===At.maskPassword)return"";switch(this.getNodeMask(e)){case At.maskAll:case At.maskContent:case At.maskText:case At.maskInput:return Mt(t)}return t},t.prototype.attributesMask=function(e,t){switch(this.getGlobalMask(e)===At.maskPassword&&(t.value=""),this.getNodeMask(e)){case At.maskImage:return Dt(e,{attributes:t}).attributes;case At.maskContent:case At.maskText:case At.maskPassword:case At.maskInput:return Nt(t);case At.maskAll:return Pt(e,{attributes:t}).attributes}return t},t.prototype.findParentMask=function(e){if(!e||!e.parentNode)return At.maskDefault;var t=0,n=[],r=function e(r){if(!r)return At.maskDefault;var o=r._uv_mask;return o||(t++,n.push(r),e(r.parentNode))}(e.parentNode);for(n.pop();--t>0;){var o=n.pop();r=this.checkMask(o,r),o._uv_mask=r}return r},t}(Lt),qt=new Bt,Ht=window.console,zt=1,Vt=RegExp("[^a-z0-9-_]");function Wt(e){try{var t=e.rules||e.cssRules;return t?Array.from(t).map($t).join(""):null}catch(e){return null}}function $t(e){return function(e){return"styleSheet"in e}(e)?Wt(e.styleSheet)||"":e.cssText}var Kt=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,Gt=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Xt=/^(data:)([^,]*),(.*)/i;function Jt(e,t,n,r){return(e||"").replace(Kt,(function(e,n,r,o,i,a){var s,u=r||i||a,c=n||o||"";if(!u)return e;if(!Gt.test(u))return"url("+c+u+c+")";if(Xt.test(u))return"url("+c+u+c+")";if("/"===u[0])return"url("+c+(((s=t).indexOf("//")>-1?s.split("/").slice(0,3).join("/"):s.split("/")[0]).split("?")[0]+u)+c+")";var l=t.split("/"),p=u.split("/");l.pop();for(var d=0,h=p;d<h.length;d++){var f=h[d];"."!==f&&(".."===f?l.pop():l.push(f))}return"url("+c+l.join("/")+c+")"}))}var Qt,Yt,Zt=/^[^ \t\n\r\u000c]+/,en=/^[, \t\n\r\u000c]+/;function tn(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function nn(){var e=document.createElement("a");return e.href="",e.href}function rn(e,t,n,r,o,i){return"src"===n?tn(e,r):"src"===n||("href"===n||"xlink:href"===n)&&r?"use"===t?r:tn(e,r):"background"!==n||!r||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n&&r?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,o=e.exec(t.substring(n));return o?(r=o[0],n+=r.length,r):""}for(var o=[];r(en),!(n>=t.length);){var i=r(Zt);if(","===i.slice(-1))i=tn(e,i.substring(0,i.length-1)),o.push(i);else{var a="";i=tn(e,i);for(var s=!1;;){var u=t.charAt(n);if(""===u){o.push((i+a).trim());break}if(s)")"===u&&(s=!1);else{if(","===u){n+=1,o.push((i+a).trim());break}"("===u&&(s=!0)}a+=u,n+=1}}}return o.join(", ")}(e,r):"style"===n&&r?Jt(r,nn()):r:tn(e,r)}function on(e,t,n){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){if("string"==typeof t){if(e.classList.contains(t))return!0}else e.classList.forEach((function(e){if(t.test(e))return!0}));return!(!n||!e.matches(n))||on(e.parentNode,t,n)}return e.nodeType,e.TEXT_NODE,on(e.parentNode,t,n)}function an(e,t){var n=t.doc,r=t.blockClass,o=t.blockSelector,i=t.maskTextClass,a=t.maskTextSelector,s=t.inlineStylesheet,u=t.maskInputOptions,c=void 0===u?{}:u,l=t.maskTextFn,p=t.recordCanvas;t.serializeArray;var d=t.isShadow;t.eaExtractDataUrl;var h,f=t.nodeFilter;if(n.__sn){var m=n.__sn.id;h=1===m?void 0:m}switch(e.nodeType){case e.DOCUMENT_NODE:return{type:ct.Document,childNodes:[],rootId:h};case e.DOCUMENT_TYPE_NODE:return{type:ct.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:h};case e.ELEMENT_NODE:var v=function(e,t,n){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=0;r<e.classList.length;r++){var o=e.classList[r];if(t.test(o))return!0}return!!n&&e.matches(n)}(e,r,o),g=function(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return Vt.test(t)?"div":t}(e),y={},b=e.attributes,w=!function(e,t){return"script"===e||!("link"!==e||!/\.js$/.test(t.href))||void 0}(g,e);if(w)for(var S=0,k=Array.from(b);S<k.length;S++){var T=k[S],x=T.name,_=T.value;y[x]=rn(n,g,x,_)}if("link"===g&&s){var I,C=Array.from(n.styleSheets).find((function(t){return t.href===e.href}));(I=Wt(C))&&(delete y.rel,delete y.href,y._cssText=Jt(I,C.href))}if("style"===g&&e.sheet&&!(e.innerText||e.textContent||"").trim().length)(I=Wt(e.sheet))&&(y._cssText=Jt(I,nn()));if("input"===g||"textarea"===g||"select"===g){_=e.value;"radio"!==y.type&&"checkbox"!==y.type&&"submit"!==y.type&&"button"!==y.type&&_?y.value=c[y.type]||c[g]?"*".repeat(_.length):_:e.checked&&(y.checked=e.checked)}if("option"===g){var E=e.parentElement;y.value===E.value&&(y.selected=e.selected)}if("canvas"===g&&p&&(y.rr_dataURL=e.toDataURL()),"audio"!==g&&"video"!==g||(y.rr_mediaState=e.paused?"paused":"played"),e.scrollLeft&&(y.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(y.rr_scrollTop=e.scrollTop),v){var O=e.getBoundingClientRect(),M=O.width,N=O.height;y={class:y.class,rr_width:M+"px",rr_height:N+"px"}}if("iframe"===g&&delete y.src,f){var R=g+"."+Array.from(e.classList).join(".");Object.keys(f).some((function(t){return R===t&&(f[t](e,y),!0)}))&&Ht.safeinfo("node filter target found",e)}return{type:ct.Element,tagName:g,attributes:y,childNodes:[],isSVG:yt(e)||void 0,needBlock:v,isShadow:d,isShadowHost:!!e.shadowRoot,rootId:h};case e.TEXT_NODE:var D=e.parentNode&&e.parentNode.tagName,P=e.textContent,A="STYLE"===D||void 0,L="SCRIPT"===D||void 0;return A&&P&&(P=Jt(P,nn())),L&&(P="SCRIPT_PLACEHOLDER"),!A&&!L&&on(e,i,a)&&P&&(P=l?l(P):P.replace(/[\S]/g,"*")),{type:ct.Text,textContent:P||"",isStyle:A,rootId:h};case e.CDATA_SECTION_NODE:return{type:ct.CDATA,textContent:"",rootId:h};case e.COMMENT_NODE:return{type:ct.Comment,textContent:e.textContent||"",rootId:h};default:return!1}}function sn(e){return void 0===e?"":e.toLowerCase()}function un(e,t){var n,r=t.doc,o=t.map,i=t.blockClass,a=t.blockSelector,s=t.maskTextClass,u=t.maskTextSelector,c=t.skipChild,l=void 0!==c&&c,p=t.inlineStylesheet,d=void 0!==p&&p,h=t.maskInputOptions,f=void 0===h?{}:h,m=t.maskTextFn,v=t.slimDOMOptions,g=t.recordCanvas,y=void 0!==g&&g;t.isShadow;var b=t.onSerialize,w=t.onIframeLoad,S=t.iframeLoadTimeout,k=void 0===S?5e3:S,T=t.eaExtractDataUrl,x=void 0!==T&&T,_=t.nodeFilter,I=t.parentMask;!I&&e.parentNode&&(I=null===(n=e.parentNode)||void 0===n?void 0:n.mask);var C=t.preserveWhiteSpace,E=void 0===C||C,O=t.serializeArray;O||(O=new vt);var M,N=an(e,{doc:r,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:u,inlineStylesheet:d,maskInputOptions:f,maskTextFn:m,recordCanvas:y,eaExtractDataUrl:x,nodeFilter:_,serializeArray:O});if(!N)return Ht.safewarn(e,"not serialized"),null;M="__sn"in e?e.__sn.id:!function(e,t){if(t.comment&&e.type===ct.Comment)return!0;if(e.type===ct.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(sn(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===sn(e.attributes.name)||"icon"===sn(e.attributes.rel)||"apple-touch-icon"===sn(e.attributes.rel)||"shortcut icon"===sn(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&sn(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(sn(e.attributes.property).match(/^(og|twitter|fb):/)||sn(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===sn(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===sn(e.attributes.name)||"googlebot"===sn(e.attributes.name)||"bingbot"===sn(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===sn(e.attributes.name)||"generator"===sn(e.attributes.name)||"framework"===sn(e.attributes.name)||"publisher"===sn(e.attributes.name)||"progid"===sn(e.attributes.name)||sn(e.attributes.property).match(/^article:/)||sn(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===sn(e.attributes.name)||"yandex-verification"===sn(e.attributes.name)||"csrf-token"===sn(e.attributes.name)||"p:domain_verify"===sn(e.attributes.name)||"verify-v1"===sn(e.attributes.name)||"verification"===sn(e.attributes.name)||"shopify-checkout-api-token"===sn(e.attributes.name)))return!0}}return!1}(N,v)&&(E||N.type!==ct.Text||N.isStyle||N.textContent.replace(/^\s+|\s+$/gm,"").length)?zt++:-2;var R=Object.assign(N,{id:M});if(e.__sn=R,e._uv_id=R.id,-2===M)return null;var D=qt.nodeMask(e,R,I),P=D.maskType;if(R=D.sNode,O.pushNode(R),o[M]=e,b&&b(e),P===At.maskAll)return R;var A=!l;if(R.type===ct.Element&&(A=A&&!R.needBlock,delete R.needBlock),(R.type===ct.Document||R.type===ct.Element)&&A){v.headWhitespace&&N.type===ct.Element&&"head"===N.tagName&&(E=!1);for(var L={doc:r,map:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:u,skipChild:l,inlineStylesheet:d,maskInputOptions:f,maskTextFn:m,slimDOMOptions:v,recordCanvas:y,preserveWhiteSpace:E,onSerialize:b,onIframeLoad:w,serializeArray:O,iframeLoadTimeout:k,eaExtractDataUrl:x,nodeFilter:_,parentMask:P},j=0,F=Array.from(e.childNodes);j<F.length;j++){var U=F[j];O.pushNodeId(M),(H=un(U,L))?R.childNodes.push(H):O.pop()}if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot){R.isShadowHost=!0;for(var B=0,q=Array.from(e.shadowRoot.childNodes);B<q.length;B++){var H;U=q[B];O.pushNodeId(M),L.isShadow=!0,(H=un(U,L))?(H.isShadow=!0,R.childNodes.push(H)):O.pop()}}}return e.parentNode&&gt(e.parentNode)&&(R.isShadow=!0),R.type===ct.Element&&"iframe"===R.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var o,i=!1;try{o=r.document.readyState}catch(e){return}if("complete"===o){var a="about:blank";r.location.href===a&&e.src!==a&&""!==e.src?e.addEventListener("load",t):t()}else{var s=setTimeout((function(){i||(t(),i=!0)}),n);e.addEventListener("load",(function(){clearTimeout(s),i=!0,t()}))}}}(e,(function(){var t=e.contentDocument;if(t&&w){var n=un(t,{doc:t,map:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:u,skipChild:!1,inlineStylesheet:d,maskInputOptions:f,maskTextFn:m,slimDOMOptions:v,recordCanvas:y,preserveWhiteSpace:E,onSerialize:b,onIframeLoad:w,serializeArray:O,iframeLoadTimeout:k,eaExtractDataUrl:x});n&&w(e,n)}}),k),R}function cn(e){return void 0===e&&(e=""),e.replace(/\:|\+|\~|\=|\[|\]|\(|\)|\*|\/|\\|\,/g,"z")}function ln(e){return at(e,{className:function(e){return function(e){var t=e.classList||[];return(t=pt(t)).map((function(e){return e?cn(e):""}))}(e).join(" ")},id:function(e){return cn(e.id)},forEach:function(e,t){if(!yt(e))for(var n=e.attributes.length,r=0;r<n;r++){var o=e.attributes[r],i=/\:|\+|\~|\=|\[|\]|\(|\)|\*|\/|\\|\,/;if("id"!=o.name&&"class"!=o.name&&"style"!=o.name&&!i.test(o.name+o.value)){var a=o.value;a="string"==typeof a?a.slice(0,1e3):a,t(o.name,a)}}},nth:function(e){if(!e.parentNode)return null;var t=pt(e.parentNode.children),n=null;return t.some((function(t,r){return e===t&&(n=r+1,!0)})),n},idSliceGnore:!0})}Object.keys(dt).reduce((function(e,t){var n=dt[t];return e.set(n,t),e}),new Map),new Set(pt(["uv-input-focus","uv-mouse-active","uv-mouse-hover","uv-input-checked","rrweb-paused"],Object.values(At))),function(e){e[e.string=1]="string",e[e.number=2]="number",e[e.bool=3]="bool",e[e.table=4]="table",e[e.union=5]="union",e[e.array_base=6]="array_base",e[e.array_table=7]="array_table",e[e.array_union=8]="array_union",e[e.any=9]="any"}(Qt||(Qt={})),function(e){e[e.table=0]="table",e[e.union=1]="union"}(Yt||(Yt={}));var pn,dn=function(){function e(e){var t=this;this.schemaMap=new Map,this.unionMap=new Map,this.flowMap=new Map,this.unionCbs={};var n=e||{},r=n.globalSchema,o=n.selfSchema,i=n.defaultWriterConstruct,a=n.defaultreaderConstruct;this.setDefaulteWriter(i),this.setDefaulteReader(a),null==r||r.forEach((function(e){t.addSchema(e,!0)})),null==o||o.forEach((function(e){t.addSchema(e)}))}return e.prototype.translateUnion=function(e){var t={},n=new Map;return e.forEach((function(e){t[e.table]=e.id||"u",n.set(e.id||"u",e.table)})),{read:n,write:t}},e.prototype.setDefaulteWriter=function(e){"function"==typeof e&&(this.defaultWriterConstruct=e)},e.prototype.setDefaulteReader=function(e){"function"==typeof e&&(this.defaultreaderConstruct=e)},e.prototype.addUnionCb=function(t,n,r){var o=r?e.globalUnionCbs:this.unionCbs;"function"==typeof n?o[t]=n:console.error("callback is not function")},e.prototype.addSchema=function(t,n){var r=t.name,o=t.flow,i=t.type,a=t.unionCb,s=t.writer,u=t.reader,c=this.flowMap,l=this.unionMap,p=this.schemaMap;if(n&&(c=e.globalFlowMap,l=e.globalUnionMap,p=e.globalSchemaMap),i===Yt.table){this.defaultWriterConstruct&&!s&&(s=new this.defaultWriterConstruct({flow:o,schemaSource:this})),this.defaultreaderConstruct&&!u&&(u=new this.defaultreaderConstruct({flow:o,schemaSource:this}));var d=c.get(r);o=o||(null==d?void 0:d.flow),s=s||(null==d?void 0:d.writer),u=u||(null==d?void 0:d.reader),c.set(r,{flow:o,writer:s,reader:u})}i===Yt.union&&(l.set(r,this.translateUnion(o)),this.addUnionCb(r,a)),p.set(r,t)},e.prototype.getFlow=function(t){return this.flowMap.get(t)||e.globalFlowMap.get(t)},e.prototype.getUnionFlow=function(e,t){var n=this.getUnionCb(e);if("function"==typeof n){var r=n(t);return this.getFlow(r)||console.error("value is not match union "+e+" "+JSON.stringify(t)),{table:this.getFlow(r),id:this.getUnionTableId(e,r)}}console.error("union: "+e+" has no callback")},e.prototype.getUnionTableId=function(t,n){var r=this.unionMap.get(t)||e.globalUnionMap.get(t),o=null==r?void 0:r.write[n];return o||console.error("union: "+t+" has no table--\x3e"+n),o},e.prototype.getUnionTableName=function(t,n){var r=this.unionMap.get(t)||e.globalUnionMap.get(t),o=null==r?void 0:r.read.get(n);return o||console.error("union: "+t+" has no tableId--\x3e"+n),o},e.prototype.getUnionFlowById=function(e,t){var n=this.getUnionTableName(e,t);return{table:this.getFlow(n),name:n}},e.prototype.getUnionCb=function(t){return this.unionCbs[t]||e.globalUnionCbs[t]},e.prototype.deleteFlow=function(t){this.flowMap.has(t)&&this.flowMap.delete(t),e.globalFlowMap.has(t)&&e.globalFlowMap.delete(t)},e.globalSchemaMap=new Map,e.globalUnionMap=new Map,e.globalFlowMap=new Map,e.globalUnionCbs={},e}(),hn=function(){function e(e){var t=e.selfSchema,n=e.schemaName,r=e.flow,o=e.schemaSource;this.schemaSource=o,r?this.flowList=r:t?(this.schemaSource.addSchema(t),this.flowList=this.schemaSource.getFlow(t.name).flow):this.flowList=this.schemaSource.getFlow(n).flow}return e.prototype.flatJson=function(e,t){for(var n,r=0,o=this.flowList.length,i=t||[];r<o;){var a=this.flowList[r],s=a.type,u=a.union,c=a.table,l=e[a.key];switch((s===Qt.any||s<4)&&this.addBase(l,s,i),s){case Qt.table:var p=null===(n=this.schemaSource.getFlow(c))||void 0===n?void 0:n.writer;this.addTable(p,l,i);break;case Qt.array_base:this.addArrayBase(l,i);break;case Qt.array_table:this.addArrayTable(c,l,i);break;case Qt.union:this.addUnion(u,l,i);break;case Qt.array_union:this.addArrayUnion(u,l,i)}r++}return i},e.prototype.addBase=function(e,t,n){switch(t){case Qt.number:n.push(e||0);break;case Qt.string:n.push(e||"");break;case Qt.bool:n.push(Number(!!e));break;case Qt.any:n.push(e)}},e.prototype.addArrayBase=function(e,t){(t=t||[]).push(0);var n=t.length-1,r=t.length;t.push.apply(t,e),t[n]=t.length-r},e.prototype.addTable=function(e,t,n){(n=n||[]).push(0);var r=n.length-1,o=n.length;e.flatJson(t,n),n[r]=n.length-o},e.prototype.addArrayTable=function(e,t,n){n=n||[];var r=(t=t||[]).length;n.push(0);for(var o=n.length-1,i=n.length,a=this.schemaSource.getFlow(e).writer,s=0;s<r;s++){var u=t[s];this.addTable(a,u,n)}n[o]=n.length-i},e.prototype.addUnion=function(e,t,n){if(n=n||[],t){t=t||{};var r=this.schemaSource.getUnionFlow(e,t),o=r.table,i=r.id;n.push(i),this.addTable(o.writer,t,n)}else n.push(0)},e.prototype.addArrayUnion=function(e,t,n){n=n||[];var r=(t=t||[]).length;n.push(0);for(var o=n.length-1,i=n.length,a=0;a<r;a++){var s=t[a];this.addUnion(e,s,n)}n[o]=n.length-i},e}(),fn={name:"MutationData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"texts",type:Qt.any,sort:2},{key:"attributes",type:Qt.any,sort:3},{key:"adds",type:Qt.any,sort:4},{key:"removes",type:Qt.any,sort:5},{key:"isAttachIframe",type:Qt.bool,sort:6}]},mn={name:"MousePosition",type:Yt.table,flow:[{key:"x",type:Qt.number,sort:1},{key:"y",type:Qt.number,sort:2},{key:"id",type:Qt.number,sort:3},{key:"timeOffset",type:Qt.number,sort:4}]},vn={name:"MousemoveData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"positions",type:Qt.array_table,table:"MousePosition",sort:2}]},gn={name:"MouseInteractionData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"type",type:Qt.number,sort:2},{key:"id",type:Qt.number,sort:3},{key:"x",type:Qt.number,sort:4},{key:"y",type:Qt.number,sort:5}]},yn={name:"ScrollData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"id",type:Qt.number,sort:2},{key:"x",type:Qt.number,sort:3},{key:"y",type:Qt.number,sort:4}]},bn={name:"ViewportResizeData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"width",type:Qt.number,sort:2},{key:"height",type:Qt.number,sort:3}]},wn={name:"SizeInfo",type:Yt.table,flow:[{key:"id",type:Qt.number,sort:1},{key:"width",type:Qt.number,sort:2},{key:"height",type:Qt.number,sort:3}]},Sn={name:"SizeData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"sizes",type:Qt.array_table,table:"SizeInfo",sort:2}]},kn={name:"InputData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"id",type:Qt.number,sort:2},{key:"text",type:Qt.string,sort:3},{key:"isChecked",type:Qt.bool,sort:4}]},Tn={name:"MediaInteractionData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"id",type:Qt.number,sort:2},{key:"type",type:Qt.number,sort:3}]},xn={name:"StyleSheetAddRule",type:Yt.table,flow:[{key:"rule",type:Qt.string,sort:1},{key:"index",type:Qt.number,sort:2}]},_n={name:"StyleSheetRuleData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"id",type:Qt.number,sort:2},{key:"removes",type:Qt.any,sort:3},{key:"adds",type:Qt.array_table,table:"StyleSheetAddRule",sort:4}]},In={name:"FontFaceDescriptors",type:Yt.table,flow:[{key:"style",type:Qt.string,sort:1},{key:"weight",type:Qt.string,sort:2},{key:"stretch",type:Qt.string,sort:3},{key:"unicodeRange",type:Qt.string,sort:4},{key:"variant",type:Qt.string,sort:5},{key:"featureSettings",type:Qt.string,sort:6}]},Cn={name:"FontData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"family",type:Qt.string,sort:2},{key:"fontSource",type:Qt.string,sort:3},{key:"descriptors",type:Qt.table,sort:4},{key:"buffer",type:Qt.bool,sort:5}]},En={name:"FullscreenData",type:Yt.table,flow:[{key:"source",type:Qt.number,sort:1},{key:"id",type:Qt.number,sort:2},{key:"type",type:Qt.string,sort:3}]},On={name:"Offset",type:Yt.table,flow:[{key:"width",type:Qt.number,sort:1},{key:"height",type:Qt.number,sort:2},{key:"left",type:Qt.number,sort:3},{key:"top",type:Qt.number,sort:4}]},Mn={name:"MetaData",type:Yt.table,flow:[{key:"href",type:Qt.string,sort:1},{key:"width",type:Qt.number,sort:2},{key:"height",type:Qt.number,sort:3}]},Nn={name:"FullSnapshotData",type:Yt.table,flow:[{key:"node",type:Qt.any,sort:1},{key:"initialOffset",type:Qt.table,table:"Offset",sort:2}]},Rn={name:"MetaEvent",type:Yt.table,flow:[{key:"type",type:Qt.number,sort:1},{key:"data",type:Qt.table,table:"MetaData",sort:2},{key:"timestamp",type:Qt.number,sort:3}]},Dn={name:"FullSnapshotEvent",type:Yt.table,flow:[{key:"type",type:Qt.number,sort:1},{key:"data",type:Qt.table,table:"FullSnapshotData",sort:2},{key:"timestamp",type:Qt.number,sort:3}]},Pn={name:"DomContentLoadedEvent",type:Yt.table,flow:[{key:"type",type:Qt.number,sort:1},{key:"timestamp",type:Qt.number,sort:2}]},An={name:"LoadEvent",type:Yt.table,flow:[{key:"type",type:Qt.number,sort:1},{key:"timestamp",type:Qt.number,sort:2}]},Ln={name:"IncrementalData",type:Yt.union,flow:[{table:"MutationData",id:1},{table:"MousemoveData",id:2},{table:"MouseInteractionData",id:3},{table:"ScrollData",id:4},{table:"ViewportResizeData",id:5},{table:"InputData",id:6},{table:"MediaInteractionData",id:7},{table:"StyleSheetRuleData",id:8},{table:"FontData",id:9},{table:"SizeData",id:10},{table:"FullscreenData",id:11}],unionCb:function(e){switch(e.source){case pn.Mutation:return"MutationData";case pn.Drag:case pn.TouchMove:case pn.MouseMove:return"MousemoveData";case pn.MouseInteraction:return"MouseInteractionData";case pn.Scroll:return"ScrollData";case pn.ViewportResize:return"ViewportResizeData";case pn.Input:return"InputData";case pn.MediaInteraction:return"MediaInteractionData";case pn.StyleSheetRule:return"StyleSheetRuleData";case pn.Font:return"FontData";case pn.SizeChange:return"SizeData";case pn.fullScreen:return"FullscreenData"}}};!function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.SizeChange=13]="SizeChange",e[e.fullScreen=14]="fullScreen"}(pn||(pn={}));var jn,Fn={name:"IncrementalSnapshotEvent",type:Yt.table,flow:[{key:"type",type:Qt.number,sort:1},{key:"data",type:Qt.union,union:"IncrementalData",sort:2},{key:"timestamp",type:Qt.number,sort:3}]};!function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom"}(jn||(jn={}));var Un,Bn={MutationDataDesc:fn,MousePositionDesc:mn,MousemoveDataDesc:vn,MouseInteractionDataDesc:gn,ScrollDataDesc:yn,ViewportResizeDataDesc:bn,InputDataDesc:kn,MediaInteractionDataDesc:Tn,StyleSheetAddRuleDesc:xn,StyleSheetRuleDataDesc:_n,FontFaceDescriptorsDesc:In,FontDataDesc:Cn,OffsetDesc:On,MetaDataDesc:Mn,SizeDataDesc:Sn,SizeInfoDesc:wn,FullSnapshotDataDesc:Nn,MetaEventDesc:Rn,FullSnapshotEventDesc:Dn,DomContentLoadedEventDesc:Pn,LoadEventDesc:An,IncrementalDataUnion:Ln,IncrementalSnapshotEventDesc:Fn,FullscreenDataDesc:En},qn=new dn({selfSchema:Object.keys(Bn).map((function(e){return Bn[e]})),defaultWriterConstruct:hn}),Hn=((Un={})[jn.DomContentLoaded]=qn.getFlow("DomContentLoadedEvent").writer,Un[jn.Load]=qn.getFlow("LoadEvent").writer,Un[jn.FullSnapshot]=qn.getFlow("FullSnapshotEvent").writer,Un[jn.IncrementalSnapshot]=qn.getFlow("IncrementalSnapshotEvent").writer,Un[jn.Meta]=qn.getFlow("MetaEvent").writer,Un);var zn,Vn,Wn,$n,Kn,Gn,Xn,Jn=function(){function e(e){var t=e.selfSchema,n=e.schemaName,r=e.flow,o=e.schemaSource;this.schemaSource=o,r?this.flowList=r:t?(this.schemaSource.addSchema(t),this.flowList=this.schemaSource.getFlow(t.name).flow):this.flowList=this.schemaSource.getFlow(n).flow}return e.prototype.unpack=function(e,t,n){void 0===t&&(t=0);for(var r=t,o=0,i=this.flowList.length,a={};o<i;){if(n&&t>n)return a;var s=this.flowList[o],u=void 0,c=s.type,l=s.union,p=s.table,d=s.key;switch((c===Qt.any||c<4)&&(u=this.readBase(e,r,c)),c){case Qt.table:var h=this.schemaSource.getFlow(p).reader;u=this.readTable(h,e,r);break;case Qt.array_base:u=this.readArrayBase(e,r);break;case Qt.array_table:u=this.readArrayTable(p,e,r);break;case Qt.union:u=this.readUnion(l,e,r);break;case Qt.array_union:u=this.readArrayUnion(l,e,r)}r=u.position,a[d]=u.val,o++}return a},e.prototype.readBase=function(e,t,n){var r=e[t];switch(n){case Qt.number:case Qt.string:case Qt.any:break;case Qt.bool:r=!!r}return{position:t+1,val:r}},e.prototype.readArrayBase=function(e,t){var n=e[t]+t;return{position:n+1,val:e.slice(t+1,n)}},e.prototype.readTable=function(e,t,n){var r=t[n]+n;return{val:e.unpack(t,n+1,r),position:r+1}},e.prototype.readArrayTable=function(e,t,n){var r,o=null===(r=this.schemaSource.getFlow(e))||void 0===r?void 0:r.reader;o||console.error("table "+e+" is not match reader");var i=t[n],a=i+n,s=[],u=n;for(i&&u++;u<a;){var c=this.readTable(o,t,u);u=c.position,s.push(c.val)}return{position:a+1,val:s}},e.prototype.readUnion=function(e,t,n){var r=t[n];if(!r)return{position:n+1,val:null};var o=this.schemaSource.getUnionFlowById(e,r).table;return o&&o.reader||console.error("tableID "+r+" no match in union "+e),this.readTable(o.reader,t,n+1)},e.prototype.readArrayUnion=function(e,t,n){var r=t[n],o=r+n,i=[],a=n;for(r&&a++;a<o;){var s=this.readUnion(e,t,a);a=s.position,i.push(s.val)}return{position:o+1,val:i}},e}(),Qn=new dn({selfSchema:Object.keys(Bn).map((function(e){return Bn[e]})),defaultreaderConstruct:Jn});function Yn(e,t,n){void 0===n&&(n=document);var r="resize"==e?{capture:!1,passive:!1}:{capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}(zn={})[jn.DomContentLoaded]=Qn.getFlow("DomContentLoadedEvent").reader,zn[jn.Load]=Qn.getFlow("LoadEvent").reader,zn[jn.FullSnapshot]=Qn.getFlow("FullSnapshotEvent").reader,zn[jn.IncrementalSnapshot]=Qn.getFlow("IncrementalSnapshotEvent").reader,zn[jn.Meta]=Qn.getFlow("MetaEvent").reader,function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom"}(Vn||(Vn={})),function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.SizeChange=13]="SizeChange",e[e.fullscreen=14]="fullscreen"}(Wn||(Wn={})),function(e){e.request="request",e.exit="exit"}($n||($n={})),function(e){e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd"}(Kn||(Kn={})),function(e){e[e.Play=0]="Play",e[e.Pause=1]="Pause"}(Gn||(Gn={})),function(e){e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back"}(Xn||(Xn={}));var Zn={map:{},getId:function(e){return e.__sn?e.__sn.id:-1},getNode:function(e){return Zn.map[e]||null},removeNodeFromMap:function(e){var t=e.__sn&&e.__sn.id;delete Zn.map[t],qt.removeResizeNode(t),e.childNodes&&e.childNodes.forEach((function(e){return Zn.removeNodeFromMap(e)}))},has:function(e){return Zn.map.hasOwnProperty(e)},reset:function(){Zn.map={}}};function er(e,t,n){void 0===n&&(n={});var r=null,o=0;return function(i){var a=Date.now();o||!1!==n.leading||(o=a);var s=t-(a-o),u=this,c=arguments;s<=0||s>t?(r&&(window.clearTimeout(r),r=null),o=a,e.apply(u,c)):r||!1===n.trailing||(r=window.setTimeout((function(){o=!1===n.leading?0:Date.now(),r=null,e.apply(u,c)}),s))}}function tr(e,t,n,r,o){void 0===o&&(o=window);var i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set:function(e){var t=this;setTimeout((function(){n.set.call(t,e)}),0),i&&i.set&&i.set.call(this,e)}}),function(){return tr(e,t,i||{},!0)}}function nr(e,t,n){try{if(!(t in e))return function(){};var r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,function(){e[t]=r}}catch(e){return function(){}}}function rr(){return document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||window.innerHeight}function or(){return document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||window.innerWidth}function ir(e,t){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){var n=!1;return"string"==typeof t?n=e.classList.contains(t):e.classList.forEach((function(e){t.test(e)&&(n=!0)})),n||ir(e.parentNode,t)}return e.nodeType,e.TEXT_NODE,ir(e.parentNode,t)}function ar(e){return"__sn"in e&&-2===e.__sn.id}function sr(e){if(gt(e))return!1;var t=Zn.getId(e);return!Zn.has(t)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||sr(e.parentNode))}function ur(e){return Boolean(e.changedTouches)}function cr(e){return Boolean(null==e?void 0:e.shadowRoot)}window.$d=function(e){var t=e.split("."),n=window;return t.forEach((function(e){n=n[e]})),Math.floor(n*window.devicePixelRatio)},(new Date).getTime();var lr=process.env.SDK_SELF_LOG_URL+"/api/v1/gateway/tracking?";window.__USERVIEW_LOG_URL||Object.defineProperty(window,"__USERVIEW_LOG_URL",{value:lr,writable:!1});var pr=function(){if(window.__USERVIEW_PAGE_TAG)return window.__USERVIEW_PAGE_TAG;var e=Math.random().toFixed(10).slice(2),t=(new Date).getTime().toString(32)+(+e).toString(32);return Object.defineProperty(window,"__USERVIEW_PAGE_TAG",{value:t,writable:!1}),t}();function dr(e){var t;if("[object Error]"===Object.prototype.toString.call(e)){var n=void 0;return e.stack&&(console.warn("err:"+e.stack),n=(null===(t=e.stack)||void 0===t?void 0:t.split("\n").slice(1,4).join("\n"))||"",console.warn("err:"+n)),encodeURIComponent(e.message+n)}try{return JSON.stringify(e).slice(0,1e3)}catch(e){return"err"}}function hr(e){"object"!==r(e)&&(e={}),e.streamId=S.shareInstance().streamId||"errorStream",e.sdkVersion=O}var fr,mr=window.fetch.fetchOrigin||window.fetch;!function(e){e.post="POST",e.get="GET",e.put="PUT",e.del="DELETE"}(fr||(fr={}));var vr=process.env.HOST||"",gr=fr.get,yr={"Content-Type":"application/json"},br=S.shareInstance().streamId||"errorStream";function wr(e,t,n){return(n=n||{}).body=t,n.method=fr.post,function(e,t){if(!e)return Promise.resolve(null);var n=new URL(e,vr),r=(t=t||{}).timeout||6e4,o=t.query||{};Object.keys(o).forEach((function(e){n.searchParams.set(e,o[e])})),n.searchParams.set("sid",br),n.searchParams.set("pid",pr);var i="";try{i=JSON.stringify(t.body||null)}catch(e){return Promise.resolve(null)}var s=w(),u=setTimeout((function(){var e=i||"";hr({reqTimeOut:decodeURIComponent(n.href),reqTrace:s,size:e.length})}),2e3),c=t.method||gr;return i="GET"===c?void 0:i,new Promise((function(e){var o=setTimeout((function(){hr({fetchTimeOut:decodeURIComponent(n.href),reqTrace:s,errStr:r}),k.error("fetch is timeout:",n.href),e(null)}),r);mr(n.href,{mode:(null==t?void 0:t.mode)||"cors",headers:a(a(a({},yr),null==t?void 0:t.headers),{trace:s}),body:i,method:c}).then((function(t){if(clearTimeout(u),clearTimeout(o),200!==t.status)return Promise.reject("Fetch Error:"+t.status);e(t.json())})).catch((function(t){clearTimeout(u),clearTimeout(o),hr({reqError:decodeURIComponent(n.href),reqTrace:s,errStr:dr(t)}),k.error(t),e(null)}))}))}(e,n)}var Sr,kr,Tr,xr,_r,Ir,Cr,Er=process.env.HOST,Or="USERVIEW_CONFIG_CH";!function(e){e[e.noProject=1]="noProject",e[e.serveError=2]="serveError",e[e.paramsError=3]="paramsError",e[e.success=4]="success",e[e.noData=5]="noData"}(Sr||(Sr={})),function(e){e[e.urlScope=1]="urlScope",e[e.filterRequsest=2]="filterRequsest",e[e.allowBody=3]="allowBody"}(kr||(kr={})),function(e){e[e.requestAllow=1]="requestAllow",e[e.responseAllow=2]="responseAllow",e[e.all=3]="all"}(Tr||(Tr={})),function(e){e[e.open=1]="open",e[e.close=2]="close"}(xr||(xr={})),function(e){e.sdk="sdk",e.log="log",e.view="view",e.network="network"}(_r||(_r={})),function(e){e.production="production",e.debug="debug",e.test="test"}(Ir||(Ir={})),function(e){e.open="open",e.close="close"}(Cr||(Cr={}));var Mr={get log(){return{maxNum:1024,singlePropMaxLength:1e3,totalPropsMaxLength:1e4,maxProps:100,levels:["info","log","warn","error"]}},get network(){return{maxNum:300,allowRequest:[],allowResponse:[],allowDetails:[],disabledUrls:[]}},get view(){return{global:[],selectors:[]}},mode:process.env.isProduction?Ir.production:Ir.debug,urlScope:[]},Nr=["dev-session-oss.oss-cn-beijing.aliyuncs.com","ts-session-oss.oss-cn-beijing.aliyuncs.com","uv-session-oss.oss-cn-beijing.aliyuncs.com","dev-collect-oss.oss-cn-beijing.aliyuncs.com","uv-collect-oss.oss-cn-beijing.aliyuncs.com","".concat(process.env.HOST),"userview.net/collect"],Rr=function(){function e(){this._projectKey="",this._forbidden=!1,this._controlStatus=Cr.open,this._isAllowScope=!0,this._selfMode=Mr.mode,this._selfLogConfig=Mr.log,this._selfNetworkConfig=Mr.network,this._selfViewConfig=Mr.view,this._seflUrlScope=Mr.urlScope,this._switchMap=new Map,this._isSourceDownloadUseold=!1}return Object.defineProperty(e.prototype,"isSourceDownloadUseold",{get:function(){return this._isSourceDownloadUseold},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){var e=this;return this._remoteReady.then((function(){return e.status}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return!this._forbidden&&this._controlStatus&&this._isAllowScope&&this._projectKey?Cr.open:Cr.close},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"switchList",{get:function(){var e=this,t=this.status===Cr.open,n=function(n){return t&&!e._switchMap.has(n)||!!e._switchMap.get(n)};return{sdk:t,log:n(_r.log),network:n(_r.network),view:n(_r.view)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._selfMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectKey",{get:function(){return this._projectKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"limitUrlScopes",{get:function(){return this._seflUrlScope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logConfig",{get:function(){return this._selfLogConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"networkConfig",{get:function(){return this._selfNetworkConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewConfig",{get:function(){return this._selfViewConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"closeReason",{get:function(){return this._forbidden?"采集禁用, 检查 userview的项目配置":""},enumerable:!1,configurable:!0}),e.prototype.init=function(e){return s(this,void 0,Promise,(function(){var t=this;return u(this,(function(n){switch(n.label){case 0:return this.status===Cr.open&&this.close(),this._switchMap=new Map,this._projectKey=e.projectKey,this._projectKey?(e.closedSwitchs&&e.closedSwitchs.forEach((function(e){t.setSwitch(e,!1)})),this.setMode(e.mode),this._remoteReady=(r=this._projectKey,wr("".concat(Er).concat("/api/v1/configs/get_switch_info"),{project_id:r}).then((function(e){var t={forbidden:!1};if(e||(e=Se.shareInstance().object(Or)),!e)return t;if("00042"===e.code||e.forbidden_record||1!==e.video_switch)return t.forbidden=!0,t;if(Se.shareInstance().setObject(Or,e),e.status===Sr.success){t.oldswitches={sourceDownload:e.source_download_useold},t.log={maxNum:e.console_limit},t.network={maxNum:e.network_limit,allowRequest:[],allowResponse:[],allowDetails:[],disabledUrls:[]},t.urlScope=[],t.view={global:[],selectors:[]};var n=e.rule_list||[],r=[],o=e.host_collection_switch===xr.open;return n.forEach((function(e){var n,i,a,s,u,c,l;if(e.rule_type===kr.urlScope&&r.push(e),e.switch===xr.open){var p=e.regular;switch(e.rule_type){case kr.urlScope:o&&(null===(n=t.urlScope)||void 0===n||n.push(p));break;case kr.filterRequsest:null===(i=t.network)||void 0===i||i.disabledUrls.push(p);break;case kr.allowBody:switch(null===(a=t.network)||void 0===a||a.allowDetails.push(e),e.network_request_desc_collect_range){case Tr.all:null===(s=t.network)||void 0===s||s.allowRequest.push(p),null===(u=t.network)||void 0===u||u.allowResponse.push(p);break;case Tr.requestAllow:null===(c=t.network)||void 0===c||c.allowRequest.push(p);break;case Tr.responseAllow:null===(l=t.network)||void 0===l||l.allowResponse.push(p)}}}})),t.forbidden=o&&!!r.length&&r.every((function(e){return e.switch!==xr.open})),[["shield_input_box",At.maskInput],["shield_picture",At.maskImage],["shield_phone",At.maskPhone],["shield_uid",At.maskIdcard]].forEach((function(n){var r;1===e[n[0]]&&(null===(r=t.view)||void 0===r||r.global.push(n[1]))})),(e.custom_shield_list||[]).forEach((function(e){var n;null===(n=t.view)||void 0===n||n.selectors.push({selector:e.css_select_context,mask:e.shield_way})})),t}return t}))).then((function(e){e.forbidden?t._forbidden=!0:(e.oldswitches&&(t._isSourceDownloadUseold=e.oldswitches.sourceDownload),t.setLogConfig(e.log),t.setNetworkConfig(e.network),t.setViewConfig(e.view),t.setUrlScope(e.urlScope))})),[4,this._remoteReady]):[2,this.status];case 1:return n.sent(),[2,this.status]}var r}))}))},e.prototype.open=function(){this.status!==Cr.open&&(this._controlStatus=Cr.open)},e.prototype.close=function(){this._controlStatus=Cr.close},e.prototype.setSwitch=function(e,t){return this._switchMap.set(e,t),{key:e,status:t}},e.prototype.setMode=function(e){this._selfMode=e||this._selfMode||Mr.mode},e.prototype.setLogConfig=function(e){return this._selfLogConfig=e?a(a({},Mr.log),e):Mr.log,this._selfLogConfig},e.prototype.checkUrlScope=function(){if(!this.limitUrlScopes.length)return!0;var e=window.location.host;return this.limitUrlScopes.some((function(t){var n=("^"+t).replace(/\./g,"\\.").replace(/\*/g,"\\w+");return e.match(n)}))},e.prototype.setUrlScope=function(e){this._seflUrlScope=e||Mr.urlScope,this._isAllowScope=this.checkUrlScope()},e.prototype.setNetworkConfig=function(e){return this._selfNetworkConfig=e?a(a({},Mr.network),e):Mr.network,this._selfNetworkConfig.disabledUrls=Nr.concat(this._selfNetworkConfig.disabledUrls||[]).map((function(e){return new RegExp(e)})),this._selfNetworkConfig},e.prototype.setViewConfig=function(e){return this._selfViewConfig=e?a(a({},Mr.view),e):Mr.view,this._selfViewConfig},e}(),Dr=new Rr;function Pr(e,t){var n=e[0],r=e[1],o=e[2],i=e[3];n=Lr(n,r,o,i,t[0],7,-680876936),i=Lr(i,n,r,o,t[1],12,-389564586),o=Lr(o,i,n,r,t[2],17,606105819),r=Lr(r,o,i,n,t[3],22,-1044525330),n=Lr(n,r,o,i,t[4],7,-176418897),i=Lr(i,n,r,o,t[5],12,1200080426),o=Lr(o,i,n,r,t[6],17,-1473231341),r=Lr(r,o,i,n,t[7],22,-45705983),n=Lr(n,r,o,i,t[8],7,1770035416),i=Lr(i,n,r,o,t[9],12,-1958414417),o=Lr(o,i,n,r,t[10],17,-42063),r=Lr(r,o,i,n,t[11],22,-1990404162),n=Lr(n,r,o,i,t[12],7,1804603682),i=Lr(i,n,r,o,t[13],12,-40341101),o=Lr(o,i,n,r,t[14],17,-1502002290),n=jr(n,r=Lr(r,o,i,n,t[15],22,1236535329),o,i,t[1],5,-165796510),i=jr(i,n,r,o,t[6],9,-1069501632),o=jr(o,i,n,r,t[11],14,643717713),r=jr(r,o,i,n,t[0],20,-373897302),n=jr(n,r,o,i,t[5],5,-701558691),i=jr(i,n,r,o,t[10],9,38016083),o=jr(o,i,n,r,t[15],14,-660478335),r=jr(r,o,i,n,t[4],20,-405537848),n=jr(n,r,o,i,t[9],5,568446438),i=jr(i,n,r,o,t[14],9,-1019803690),o=jr(o,i,n,r,t[3],14,-187363961),r=jr(r,o,i,n,t[8],20,1163531501),n=jr(n,r,o,i,t[13],5,-1444681467),i=jr(i,n,r,o,t[2],9,-51403784),o=jr(o,i,n,r,t[7],14,1735328473),n=Fr(n,r=jr(r,o,i,n,t[12],20,-1926607734),o,i,t[5],4,-378558),i=Fr(i,n,r,o,t[8],11,-2022574463),o=Fr(o,i,n,r,t[11],16,1839030562),r=Fr(r,o,i,n,t[14],23,-35309556),n=Fr(n,r,o,i,t[1],4,-1530992060),i=Fr(i,n,r,o,t[4],11,1272893353),o=Fr(o,i,n,r,t[7],16,-155497632),r=Fr(r,o,i,n,t[10],23,-1094730640),n=Fr(n,r,o,i,t[13],4,681279174),i=Fr(i,n,r,o,t[0],11,-358537222),o=Fr(o,i,n,r,t[3],16,-722521979),r=Fr(r,o,i,n,t[6],23,76029189),n=Fr(n,r,o,i,t[9],4,-640364487),i=Fr(i,n,r,o,t[12],11,-421815835),o=Fr(o,i,n,r,t[15],16,530742520),n=Ur(n,r=Fr(r,o,i,n,t[2],23,-995338651),o,i,t[0],6,-198630844),i=Ur(i,n,r,o,t[7],10,1126891415),o=Ur(o,i,n,r,t[14],15,-1416354905),r=Ur(r,o,i,n,t[5],21,-57434055),n=Ur(n,r,o,i,t[12],6,1700485571),i=Ur(i,n,r,o,t[3],10,-1894986606),o=Ur(o,i,n,r,t[10],15,-1051523),r=Ur(r,o,i,n,t[1],21,-2054922799),n=Ur(n,r,o,i,t[8],6,1873313359),i=Ur(i,n,r,o,t[15],10,-30611744),o=Ur(o,i,n,r,t[6],15,-1560198380),r=Ur(r,o,i,n,t[13],21,1309151649),n=Ur(n,r,o,i,t[4],6,-145523070),i=Ur(i,n,r,o,t[11],10,-1120210379),o=Ur(o,i,n,r,t[2],15,718787259),r=Ur(r,o,i,n,t[9],21,-343485551),e[0]=Vr(n,e[0]),e[1]=Vr(r,e[1]),e[2]=Vr(o,e[2]),e[3]=Vr(i,e[3])}function Ar(e,t,n,r,o,i){return t=Vr(Vr(t,e),Vr(r,i)),Vr(t<<o|t>>>32-o,n)}function Lr(e,t,n,r,o,i,a){return Ar(t&n|~t&r,e,t,o,i,a)}function jr(e,t,n,r,o,i,a){return Ar(t&r|n&~r,e,t,o,i,a)}function Fr(e,t,n,r,o,i,a){return Ar(t^n^r,e,t,o,i,a)}function Ur(e,t,n,r,o,i,a){return Ar(n^(t|~r),e,t,o,i,a)}function Br(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var qr="0123456789abcdef".split("");function Hr(e){for(var t="",n=0;n<4;n++)t+=qr[e>>8*n+4&15]+qr[e>>8*n&15];return t}function zr(e){return function(e){for(var t=0;t<e.length;t++)e[t]=Hr(e[t]);return e.join("")}(function(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Pr(r,Br(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(Pr(r,o),t=0;t<16;t++)o[t]=0;return o[14]=8*n,Pr(r,o),r}(e))}var Vr=function(e,t){return e+t&4294967295};"5d41402abc4b2a76b9719d911017c592"!=zr("hello")&&(Vr=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n});var Wr=function(){function e(){this.finishedCallBack=null,this.taskstack={},this.initBind()}return e.prototype.init=function(){this.taskstack={}},Object.defineProperty(e.prototype,"initiated",{get:function(){return!!this.taskstack},enumerable:!1,configurable:!0}),e.prototype.initLoad=function(){var e=this;this.init(),"complete"===document.readyState?setTimeout((function(){return e.recursiveLoadUploadScriptsOnce()}),0):(window.removeEventListener("load",this.recursiveLoadUploadScriptsOnce),window.addEventListener("load",this.recursiveLoadUploadScriptsOnce))},e.prototype.destory=function(){window.removeEventListener("load",this.recursiveLoadUploadScriptsOnce),this.finishedCallBack=null},e.prototype.registerFinishCallback=function(e){this.finishedCallBack=e},e.prototype.removeTask=function(e){delete this.taskstack[e]},e.prototype.addSources=function(e,t){if(this.taskstack){var n=[],r=[];this.$parseResourceUrls(e,t,(function(e,t,o){"css"===e.$filetype?n.push(e):r.push(e)})),n.length>0&&this.bindCSSSources(n,{passthrough:!0}),r.length>0&&(Dr.isSourceDownloadUseold?this.downloadSourceFiles(r,t):this.addJSSources(r,{passthrough:!0}))}else k.safewarn("SourceManager not inited yet!")},e.prototype.$parseResourceUrls=function(e,t,n){return s(this,void 0,void 0,(function(){var r,o,i,a,l,p,d,h,f,m,v,g,y,b,w,S,k,T,x,_,I,C,E,O,M,N=this;return u(this,(function(R){switch(R.label){case 0:if(o=(r=t||{}).callback,i=r.name,a=r.replace,l=void 0===a||a,p=r.passthrough,d=r.syncInOrder,h=void 0!==d&&d,!e||0===e.length)return[2];if(i=i||"".concat(Object.keys(this.taskstack).length),m=e.length,v=[],g=[],0,this.taskstack[i]&&!l?((f=this.taskstack[i]).task=e,f.total+=m,f.orderedbaking=[]):f=this.taskstack[i]={name:i,task:e,resources:v,errorlist:g,repeat:0,total:m,successPush:function(e){var t;f.resources.push(e),null===(t=f.orderedbaking)||void 0===t||t.push(e)},callback:o},y=function(){if(m==f.errorlist.length+f.resources.length+f.repeat){var e=f.callback||N.finishedCallBack;e&&e(f.orderedbaking||f.resources)}},!p||!n)return[3,11];if(!h)return[3,9];R.label=1;case 1:R.trys.push([1,6,7,8]),b=c(e),w=b.next(),R.label=2;case 2:return w.done?[3,5]:(_=w.value,[4,n(_,f,y)]);case 3:R.sent(),R.label=4;case 4:return w=b.next(),[3,2];case 5:return[3,8];case 6:return S=R.sent(),C={error:S},[3,8];case 7:try{w&&!w.done&&(E=b.return)&&E.call(b)}finally{if(C)throw C.error}return[7];case 8:return[3,10];case 9:e.forEach((function(e){n(e,f,y)})),R.label=10;case 10:return[3,21];case 11:if(k=function(e){return s(N,void 0,void 0,(function(){var t,r,o,i,a,s,c,l,p,d,h,m,v,g;return u(this,(function(u){switch(u.label){case 0:if(t=e.originUrl,r=e.node,o=e.attributes,i=e.tag,a=e.index,s=t||e.src||e.href||r&&r.href||o.href,f.errorlist.some((function(e){e.originUrl}))||f.resources.some((function(e){e.originUrl===s&&(c=e)})))return f.repeat++,c&&(null===(g=f.orderedbaking)||void 0===g||g.push(c)),y(),[2];u.label=1;case 1:return u.trys.push([1,4,,5]),l=new URL(s),p=l.origin+l.pathname,d=l.pathname.split("/").pop(),h=-1!=d.indexOf(".")?function(){var e,t=d.split(".").pop();return(e=/([^#\?]+)/.exec(t))?e[0].toLowerCase():t.toLowerCase()}():d,m="ico"===h||"m4a"===h||"jpg"===h?"blob":"text",n?[4,n({src:s,tag:i,index:a,$url:l,$pureurl:p,name:d,$filetype:h,$type:m},f,y)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:return v=u.sent(),f.errorlist.push({originUrl:s,error:v}),y(),[3,5];case 5:return[2]}}))}))},!h)return[3,20];R.label=12;case 12:R.trys.push([12,17,18,19]),T=c(e),x=T.next(),R.label=13;case 13:return x.done?[3,16]:(_=x.value,[4,k(_)]);case 14:R.sent(),R.label=15;case 15:return x=T.next(),[3,13];case 16:return[3,19];case 17:return I=R.sent(),O={error:I},[3,19];case 18:try{x&&!x.done&&(M=T.return)&&M.call(T)}finally{if(O)throw O.error}return[7];case 19:return[3,21];case 20:e.forEach(k),R.label=21;case 21:return[2]}}))}))},e.prototype.initBind=function(){var e=this;this.recursiveLoadUploadScriptsOnce=function(){e.recursiveLoadUploadScripts(),window.removeEventListener("load",e.recursiveLoadUploadScriptsOnce)}},e.prototype.recursiveLoadUploadScripts=function(){var e=Array.from(document.head.children).concat(Array.from(document.body.children)).filter((function(e){return"SCRIPT"===e.nodeName&&-1==(null==e?void 0:e.src.indexOf(process.env.SDK_SELF_MARK))||"LINK"===e.nodeName&&("stylesheet"===e.rel||"modulepreload"===e.rel)}));this.addSources(e,{name:"".concat(S.shareInstance().streamId),replace:!1})},e.prototype.addJSSources=function(e,t){this.$parseResourceUrls(e,t,(function(e,t,n){var r=e.src;e.$url,e.$pureurl;var o=e.name,i=e.$filetype,a=e.$type,s=t.successPush;t.errorlist,s({originUrl:r,name:o,$filetype:i,$type:a}),n()}))},e.prototype.bindCSSSources=function(e,t){var n=this;this.$parseResourceUrls(e,a(a({},t||{}),{syncInOrder:!1}),(function(e,t,r){return s(n,void 0,void 0,(function(){var n,o,i,a,s;return u(this,(function(u){return n=e.src,e.$url,e.$pureurl,o=e.name,i=e.$filetype,a=e.$type,s=t.successPush,t.errorlist,s({originUrl:n,name:o,$filetype:i,$type:a}),r(),[2]}))}))}))},e.prototype.downloadSourceFiles=function(e,t){var n=this;this.$parseResourceUrls(e,t,(function(e,r,o){return s(n,void 0,void 0,(function(){var n,i,a,s,c,l,p,d,h,f;return u(this,(function(u){return n=e.src,e.$url,e.$pureurl,i=e.name,a=e.$filetype,s=e.$type,c=e.tag,l=e.index,p=(t||{}).uploadcss,d=void 0!==p&&p,h=r.successPush,f=r.errorlist,mr(n).then((function(e){return"text"===s?"text/html"===e.headers.get("content-type")?"":e.text():"blob"===s?e.blob():void 0})).then((function(e){e?h({index:l,originUrl:n,name:i,tag:c,$filetype:a,$type:s,file:e,md5:zr(e),$length:e.length,uploadcss:d}):(k.safewarn("error download html",n),f.push({originUrl:n,error:"error download html"})),o()})).catch((function(e){k.safewarn("error url",n),k.safewarn(e),f.push({originUrl:n,error:e}),o()})),[2]}))}))}))},e}(),$r=new Wr;function Kr(e){return"__ln"in e}var Gr=function(){function e(){this.length=0,this.head=null}return e.prototype.get=function(e){if(e>=this.length)throw new Error("Position outside of list range");for(var t=this.head,n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t},e.prototype.addNode=function(e){var t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Kr(e.previousSibling)){var n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Kr(e.nextSibling)&&e.nextSibling.__ln.previous){n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++},e.prototype.removeNode=function(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)},e}(),Xr=function(e,t){return"".concat(e,"@").concat(t)};function Jr(e){return"__sn"in e}var Qr=function(){function e(){var e=this;this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=function(t){t.forEach(e.processMutation),e.emit()},this.emit=function(){var t,n,r,o;if(!e.frozen&&!e.locked){for(var i=[],a=new Gr,s=function(t){for(var n=t,r=-2;-2===r;)r=(n=n&&n.nextSibling)&&Zn.getId(n);return-1===r&&ir(t.nextSibling,e.blockClass)&&(r=null),r},u=[],l=function(t){var n,r=t.getRootNode?null===(n=t.getRootNode())||void 0===n?void 0:n.host:null,o=!e.doc.contains(t)&&!e.doc.contains(r);if(t.parentNode&&!o){var c=gt(t.parentNode)?Zn.getId(r):Zn.getId(t.parentNode),l=s(t);if(-1===c||-1===l)return a.addNode(t);if(qt.findParentMask(t)!==At.maskAll){var p=new vt,d=un(t,{doc:e.doc,map:Zn.map,blockClass:e.blockClass,blockSelector:e.blockSelector,maskTextClass:e.maskTextClass,maskTextSelector:e.maskTextSelector,skipChild:!0,inlineStylesheet:e.inlineStylesheet,maskInputOptions:e.maskInputOptions,maskTextFn:e.maskTextFn,slimDOMOptions:e.slimDOMOptions,recordCanvas:e.recordCanvas,eaExtractDataUrl:e.extractDataUrl,serializeArray:p,onSerialize:function(n){cr(t)&&e.shadowDomManager.addShadowRoot(t.shadowRoot,document)},nodeFilter:e.nodeFilter});d&&("link"===d.tagName&&u.push(d),i.push(c,l,d.id,p.get()))}}};e.mapRemoves.length;)Zn.removeNodeFromMap(e.mapRemoves.shift());try{for(var p=c(e.movedSet),d=p.next();!d.done;d=p.next()){var h=d.value;Zr(e.removes,h)&&!e.movedSet.has(h.parentNode)||l(h)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}try{for(var f=c(e.addedSet),m=f.next();!m.done;m=f.next()){h=m.value;eo(e.droppedSet,h)||Zr(e.removes,h)?eo(e.movedSet,h)?l(h):e.droppedSet.add(h):l(h)}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}for(var v=null;a.length;){var g=null;if(v){var y=Zn.getId(v.value.parentNode),b=s(v.value);-1!==y&&-1!==b&&(g=v)}if(!g)for(var w=a.length-1;w>=0;w--){var S=a.get(w);y=Zn.getId(S.value.parentNode),b=s(S.value);if(-1!==y&&-1!==b){g=S;break}}if(!g){for(;a.head;)a.removeNode(a.head.value);break}v=g.previous,a.removeNode(g.value),l(g.value)}var k={texts:e.texts.reduce((function(e,t){var n=Zn.getId(t.node),r=qt.findParentMask(t.node);if(Zn.has(n)&&r!==At.maskAll){var o=qt.textMask(Zn.getNode(n),t.value),i=ft.getContext(o,!0);e.push(n,i)}return e}),[]),attributes:e.attributes.reduce((function(e,t){var n=Zn.getId(t.node),r=qt.findParentMask(t.node);if(Zn.has(n)&&r!==At.maskAll)for(var o in e.push(-n),t.attributes=qt.attributesMask(Zn.getNode(n),t.attributes),t.attributes){var i=t.attributes[o],a=ft.getAttribute(o,!0),s=ft.getContext(i,!0);e.push(a,s)}return e}),[]),removes:e.removes,adds:i};(k.texts.length||k.attributes.length||k.removes.length||k.adds.length)&&(e.texts=[],e.attributes=[],e.removes=[],e.addedSet=new Set,e.movedSet=new Set,e.droppedSet=new Set,e.movedMap={},u.length>0&&$r.recursiveLoadUploadScripts(),e.emissionCallback(k),qt.resizeSupported||qt.emit())}},this.processMutation=function(t){if(!ar(t.target))switch(t.type){case"characterData":var n=t.target.textContent;if(!ir(t.target,e.blockClass)&&n!==t.oldValue){var r=on(t.target,e.maskTextClass,e.maskTextSelector)&&n?e.maskTextFn?e.maskTextFn(n):n.replace(/[\S]/g,"*"):n;e.texts.push({value:r,node:t.target})}break;case"attributes":n=t.target.getAttribute(t.attributeName);var o=t.attributeName;if(ir(t.target,e.blockClass)||n===t.oldValue)return;if("href"===o&&"use"===t.target.nodeName){var i=t.target.getAttribute("xlink:href");i&&!n&&(n=i,o="xlink:href")}var a=e.attributes.find((function(e){return e.node===t.target}));a||(a={node:t.target,attributes:{}},e.attributes.push(a)),a.attributes[o]=rn(e.doc,t.target.tagName,o,n,t.target);break;case"childList":t.addedNodes.forEach((function(n){return e.genAdds(n,t.target)})),t.removedNodes.forEach((function(n){var r=Zn.getId(n),o=gt(t.target)?Zn.getId(t.target.host):Zn.getId(t.target);ir(n,e.blockClass)||ir(t.target,e.blockClass)||ar(n)||(e.addedSet.has(n)?(Yr(e.addedSet,n),e.droppedSet.add(n)):e.addedSet.has(t.target)&&-1===r||sr(t.target)||(e.movedSet.has(n)&&e.movedMap[Xr(r,o)]?Yr(e.movedSet,n):-1!==r&&e.removes.push({parentId:o,id:r,isShadow:!!gt(t.target)||void 0})),e.mapRemoves.push(n))}))}},this.genAdds=function(t,n){if(!(ir(t,e.blockClass)||n&&ir(n,e.blockClass))){if(Jr(t)){if(ar(t))return;e.movedSet.add(t);var r=null;n&&Jr(n)&&(r=n.__sn.id),r&&(e.movedMap[Xr(t.__sn.id,r)]=!0)}else e.addedSet.add(t),e.droppedSet.delete(t);t.childNodes.forEach((function(t){return e.genAdds(t)}))}}}return e.prototype.init=function(e,t,n,r,o,i,a,s,u,c,l,p,d,h,f){this.blockClass=t,this.blockSelector=n,this.maskTextClass=r,this.maskTextSelector=o,this.inlineStylesheet=i,this.maskInputOptions=a,this.maskTextFn=s,this.recordCanvas=u,this.extractDataUrl=c,this.slimDOMOptions=l,this.emissionCallback=e,this.doc=p,this.iframeManager=d,this.shadowDomManager=h,this.nodeFilter=f},e.prototype.freeze=function(){this.frozen=!0},e.prototype.unfreeze=function(){this.frozen=!1,this.emit()},e.prototype.isFrozen=function(){return this.frozen},e.prototype.lock=function(){this.locked=!0},e.prototype.unlock=function(){this.locked=!1,this.emit()},e}();function Yr(e,t){e.delete(t),t.childNodes.forEach((function(t){return Yr(e,t)}))}function Zr(e,t){var n=t.parentNode;if(!n)return!1;var r=Zn.getId(n);return!!e.some((function(e){return e.id===r}))||Zr(e,n)}function eo(e,t){var n=t.parentNode;return!!n&&(!!e.has(n)||eo(e,n))}var to="WARN:ObjectKeyNumberExceed",no="WARN:ObjectStringTypeLengthExceed";function ro(e,t,n){void 0===n&&(n={keyNumbers:0,stringTypeLengthTotal:0});var o,i={numOfKeysLimit:100,stringLengthLimit:1e3,stringTypeValuesTotalLengthLimit:1e4};if(Object.assign(i,t),n.keyNumbers>i.numOfKeysLimit)return to;if(n.stringTypeLengthTotal>i.stringTypeValuesTotalLengthLimit)return no;if("number"==typeof e)return isNaN(e)?"NaN":e;if(null===e||"boolean"==typeof e)return e;if(void 0===e)return"undefined";if("string"==typeof e)return e.length>i.stringLengthLimit?(n.stringTypeLengthTotal+=i.stringLengthLimit,e.substring(0,i.stringLengthLimit)):(n.stringTypeLengthTotal+=e.length,e);if("object"===r(e)&&e.type&&"unhandledrejection"===e.type)return ro(e.reason);if(e.$slots&&e.$refs&&e.$store)return"VueComponent";if(e===window)return"window对象";if(e===document)return"document对象";if("object"===r(e)){var a={};return(o=e,o instanceof Error?["name","message","stack"]:o instanceof RegExp?["dotAll","flags","global","source","hasIndices","ignoreCase","lastIndex","multiline","sticky","unicode"]:Object.keys(o)).some((function(t){try{var r=e[t];if("function"==typeof r)return!1;n.keyNumbers++;var o=a[t]=ro(r,i,n);return o===to||o===no}catch(e){return!1}})),a}return"ERR:CanNotBeStringified"}var oo,io=function(){function e(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}return e.prototype.toString=function(){var e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?this.functionName+" ("+this.fileName+":"+e+":"+t+")":this.fileName+":"+e+":"+t},e}(),ao=/(^|@)\S+:\d+/,so=/^\s*at .*(\S+:\d+|\(native\))/m,uo=/^(eval@)?(\[native code])?$/,co={parse:function(e){return e?void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(so)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):[]:[]},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error("Cannot parse given url: ".concat(e));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(so)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=t.match(/ (\((.+):(\d+):(\d+)\)$)/),r=(t=n?t.replace(n[0],""):t).split(/\s+/).slice(1),o=this.extractLocation(n?n[1]:r.pop()),i=r.join(" ")||void 0,a=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new io({functionName:i,fileName:a,lineNumber:o[1],columnNumber:o[2]})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(uo)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new io({functionName:e});var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),r=n&&n[1]?n[1]:void 0,o=this.extractLocation(e.replace(t,""));return new io({functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[],o=2,i=n.length;o<i;o+=2){var a=t.exec(n[o]);a&&r.push(new io({fileName:a[2],lineNumber:parseFloat(a[1])}))}return r},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o+=2){var a=t.exec(n[o]);a&&r.push(new io({functionName:a[3]||void 0,fileName:a[2],lineNumber:parseFloat(a[1])}))}return r},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(ao)&&!e.match(/^Error created at/)}),this).map((function(e){var t=e.split("@"),n=this.extractLocation(t.pop()),r=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new io({functionName:r,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})}),this)}},lo=[];function po(e,t,n,r,o,i,a,s,u,c,l,p,d,h,f,m){var v,g,y=new Qr;lo.push(y),y.init(e,n,r,o,i,a,s,u,c,l,p,t,d,h,m);var b=window.MutationObserver||window.__rrMutationObserver,w=null===(g=null===(v=null===window||void 0===window?void 0:window.Zone)||void 0===v?void 0:v.__symbol__)||void 0===g?void 0:g.call(v,"MutationObserver");w&&window[w]&&(b=window[w]);var S=new b(y.processMutations.bind(y));return S.observe(f,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),S}function ho(e,t,n,r){if(!1===r.mouseInteraction)return function(){};var o=!0===r.mouseInteraction||void 0===r.mouseInteraction?{}:r.mouseInteraction,i=[];return Object.keys(Kn).filter((function(e){return Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==o[e]})).forEach((function(n){var r=n.toLowerCase(),o=function(t){return function(n){if(qt.checkMask(n.target)!==At.maskAll){var r=ur(n)?n.changedTouches[0]:n;if(r){var o=Zn.getId(n.target),i=r.clientX,a=r.clientY;e({type:Kn[t],id:o,x:i,y:a})}}}}(n);i.push(Yn(r,o,t))})),function(){i.forEach((function(e){return e()}))}}function fo(e){var t=function(e,t,n,r){var o=t||{wait:500},i=o.wait||500,s=n||function(e,t){return!1},u=!0,c=null,d={mark:null,copied_ctx:null};return function(){var t=Date.now();c||(c=t);var n=t-c>=i,r=!n,h=!!d.mark,f=!1,m=function(e){return f=!!e},v={userdata:o,runtime:{timeout:d,timestamp:t,willDirectCall:n,willClearTimeout:h,willRemoteCall:r}},g=function(){var t=this.timeout.copied_ctx;if(null===t)return!1;var n=t;return!1!==e.apply(null,[{userdata:n.userdata,runtime:a(a({},n.runtime),{willExecutePrevFunc:!0})}])},y=function(){return{userdata:v.userdata,runtime:a(a({},v.runtime),{executePrevFunc:g.bind(v.runtime)})}};if(u&&s&&!0===s.apply(void 0,p([m,y()],l(arguments),!1))&&(u=!1),!0===f)return c=t,void e.apply(null,p([y()],l(arguments),!1));h&&(window.clearTimeout(d.mark),d.mark=null);var b=i-(t-c);if(n)c=t,e.apply(null,p([y()],l(arguments),!1));else{d.copied_ctx=function(){var e=0;try{return JSON.parse(JSON.stringify(v,(function(t,n){return"copied_ctx"===t&&++e>=10?null:n})))}catch(e){return null}}();var w=arguments;d.mark=window.setTimeout((function(){c=Date.now(),e.apply(null,p([y()],l(w),!1)),d.copied_ctx=null,d.mark=null}),b)}}}((function(t){var n=Number(or()),r=Number(rr()),o=t.userdata,i=o.lastWidth,a=o.lastHeight,s=o.prevWidth,u=o.prevHeight;o.conditionWidth,o.conditionHeight,o.index;var c=t.runtime,l=c.willExecutePrevFunc,p=c.executePrevFunc,d=c.timestamp;if(l||i!==n||a!==r||p())if(l){if(i===s&&a===u)return!1;e({width:s,height:u,timestamp:d})}else e({width:n,height:r,timestamp:d}),t.userdata.lastWidth=n,t.userdata.lastHeight=r,t.userdata.index++}),{wait:200,index:1,lastWidth:Number(or()),lastHeight:Number(rr())},(function(e,t){var n=Number(or()),r=Number(rr());t.userdata.prevWidth=t.userdata.conditionWidth||t.userdata.lastWidth,t.userdata.prevHeight=t.userdata.conditionHeight||t.userdata.lastHeight,t.userdata.conditionWidth=n,t.userdata.conditionHeight=r}));return Yn("resize",t,window)}var mo=["INPUT","TEXTAREA","SELECT"],vo=new WeakMap;var go=null===(oo=HTMLElement.prototype)||void 0===oo?void 0:oo.requestFullscreen;function yo(e,t,n){void 0===t&&(t={}),function(e,t){var n=e.mutationCb,r=e.mousemoveCb,o=e.mouseInteractionCb,i=e.scrollCb,a=e.viewportResizeCb,s=e.inputCb,u=e.mediaInteractionCb,c=e.styleSheetRuleCb,d=e.canvasMutationCb,h=e.fontCb,f=e.logCb;e.mutationCb=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.mutation&&t.mutation.apply(t,p([],l(e),!1)),n.apply(void 0,p([],l(e),!1))},e.mousemoveCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mousemove&&t.mousemove.apply(t,p([],l(e),!1)),r.apply(void 0,p([],l(e),!1))},e.mouseInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mouseInteraction&&t.mouseInteraction.apply(t,p([],l(e),!1)),o.apply(void 0,p([],l(e),!1))},e.scrollCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.scroll&&t.scroll.apply(t,p([],l(e),!1)),i.apply(void 0,p([],l(e),!1))},e.viewportResizeCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.viewportResize&&t.viewportResize.apply(t,p([],l(e),!1)),a.apply(void 0,p([],l(e),!1))},e.inputCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.input&&t.input.apply(t,p([],l(e),!1)),s.apply(void 0,p([],l(e),!1))},e.mediaInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mediaInteaction&&t.mediaInteaction.apply(t,p([],l(e),!1)),u.apply(void 0,p([],l(e),!1))},e.styleSheetRuleCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.styleSheetRule&&t.styleSheetRule.apply(t,p([],l(e),!1)),c.apply(void 0,p([],l(e),!1))},e.canvasMutationCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.canvasMutation&&t.canvasMutation.apply(t,p([],l(e),!1)),d.apply(void 0,p([],l(e),!1))},e.fontCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.font&&t.font.apply(t,p([],l(e),!1)),h.apply(void 0,p([],l(e),!1))},e.logCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.log&&!0===t.log.apply(t,p([],l(e),!1))||f.apply(void 0,p([],l(e),!1))}}(e,t);var r,o,i,s,u,d,h=po(e.mutationCb,e.doc,e.blockClass,e.blockSelector,e.maskTextClass,e.maskTextSelector,e.inlineStylesheet,e.maskInputOptions,e.maskTextFn,e.recordCanvas,e.extractDataUrl,e.slimDOMOptions,e.iframeManager,e.shadowDomManager,e.doc,e.nodeFilter),f=function(e,t,n){if(!1===t.mousemove)return function(){};var r,o="number"==typeof t.mousemove?t.mousemove:50,i="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500,a=[],s=er((function(t){var n=Date.now()-r;e(a.map((function(e){return e.timeOffset-=n,e})),t),a=[],r=null}),i),u=er((function(e){var t=e.target,n=ur(e)?e.changedTouches[0]:e,o=n.clientX,i=n.clientY;r||(r=Date.now()),a.push({x:o,y:i,id:Zn.getId(t),timeOffset:Date.now()-r}),s(e instanceof MouseEvent?Wn.MouseMove:e instanceof TouchEvent?Wn.TouchMove:Wn.Drag)}),o,{trailing:!1}),c=[Yn("mousemove",u,n),Yn("touchmove",u,n),Yn("drag",u,n)];return function(){c.forEach((function(e){return e()}))}}(e.mousemoveCb,e.sampling,e.doc),m=ho(e.mouseInteractionCb,e.doc,e.blockClass,e.sampling),v=(r=e.scrollCb,o=e.doc,e.blockClass,Yn("scroll",er((function(e){var t=(e.path||e.composedPath&&e.composedPath()||[]).length<=13;if(e.target&&(qt.resizeSupported||qt.emit(),qt.checkMask(e.target)!==At.maskAll)){var n=Zn.getId(e.target);if(e.target===o){var i=o.scrollingElement||o.documentElement;r({id:n,x:i.scrollLeft,y:i.scrollTop,viewportScroll:t})}else r({id:n,x:e.target.scrollLeft,y:e.target.scrollTop,viewportScroll:t})}}),e.sampling.scroll||100))),g=fo(e.viewportResizeCb),y=function(e,t,n,r,o,i,s){function u(e){var r=e.target;if(r&&r.tagName&&!(mo.indexOf(r.tagName)<0)&&!ir(r,n)){var o=r.type;if("password"!==o){var i=r.value,a=!1;"radio"!==o&&"checkbox"!==o||(a=r.checked);var s=qt.checkMask(r);if(s!==At.maskAll){s!==At.unMask&&s!==At.maskDefault&&(a=!1,i&&(i=qt.textMask(r,i))),c(r,{text:i,isChecked:a});var u=r.name;"radio"===o&&u&&a&&t.querySelectorAll('input[type="radio"][name="'.concat(u,'"]')).forEach((function(e){e!==r&&c(e,{text:e.value,isChecked:!a})}))}}}}function c(t,n){var r=vo.get(t);if(!r||r.text!==n.text||r.isChecked!==n.isChecked){vo.set(t,n);var o=Zn.getId(t);e(a(a({},n),{id:o}))}}var d=("last"===s.input?["change"]:["input","change"]).map((function(e){return Yn(e,u,t)})),h=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),f=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"]];return h&&h.set&&d.push.apply(d,p([],l(f.map((function(e){return tr(e[0],e[1],{set:function(){u({target:this})}})}))),!1)),function(){d.forEach((function(e){return e()}))}}(e.inputCb,e.doc,e.blockClass,e.ignoreClass,e.maskInputOptions,e.maskInputFn,e.sampling),b=(i=e.mediaInteractionCb,s=e.blockClass,d=[Yn("play",(u=function(e){return function(t){var n=t.target;n&&!ir(n,s)&&i({type:"play"===e?Gn.Play:Gn.Pause,id:Zn.getId(n)})}})("play")),Yn("pause",u("pause"))],function(){d.forEach((function(e){return e()}))}),w=function(e){var t=CSSStyleSheet.prototype.insertRule;CSSStyleSheet.prototype.insertRule=function(n,r){var o=Zn.getId(this.ownerNode);return-1!==o&&e({id:o,adds:[{rule:n,index:r}]}),t.apply(this,arguments)};var n=CSSStyleSheet.prototype.deleteRule;return CSSStyleSheet.prototype.deleteRule=function(t){var r=Zn.getId(this.ownerNode);return-1!==r&&e({id:r,removes:[{index:t}]}),n.apply(this,arguments)},function(){CSSStyleSheet.prototype.insertRule=t,CSSStyleSheet.prototype.deleteRule=n}}(e.styleSheetRuleCb),S=e.recordCanvas?function(e,t,n,r,o){var i,a,s=Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype),u=[],d=function(i){try{if("function"!=typeof CanvasRenderingContext2D.prototype[i])return"continue";var a=nr(CanvasRenderingContext2D.prototype,i,(function(a){return function(){for(var s=this,u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];return ir(this.canvas,t)||setTimeout((function(){var t=p([],l(u),!1);if("drawImage"===i)if(t[0]&&t[0]instanceof HTMLCanvasElement)t[0]=t[0].toDataURL();else if(t[0]&&t[0]instanceof HTMLImageElement){var a=t[0].src;if(n&&a){var c=!0,d=null,h=n.imageSrcToDataUrl;if(!0===h||!1!==h&&null!=h&&-1!=h.indexOf(new URL(a).hostname))if(!0===r&&Zn.map.dataurl&&a in Zn.map.dataurl)c=!0;else{var f=document.createElement("canvas"),m=f.getContext("2d");f.width=t[0].width,f.height=t[0].height,null==m||m.drawImage(t[0],0,0),d=f.toDataURL(),c=!1}!0!==r||!Zn.map.dataurl||Zn.map.dataurl[a]||c||null==d||(Zn.map.dataurl[a]=d,c=!0,null==o||o.call(null,{type:Vn.Custom,data:{tag:"snapshot_source",payload:{sourceid:a,data:d}}})),!0===c?t[0]=a:d&&(t[0]=d)}else t[0]=a}e({id:Zn.getId(s.canvas),property:i,args:t})}),0),a.apply(this,u)}}));u.push(a)}catch(t){var s=tr(CanvasRenderingContext2D.prototype,i,{set:function(t){e({id:Zn.getId(this.canvas),property:i,args:[t],setter:!0})}});u.push(s)}};try{for(var h=c(s),f=h.next();!f.done;f=h.next())d(f.value)}catch(e){i={error:e}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}return function(){u.forEach((function(e){return e()}))}}(e.canvasMutationCb,e.blockClass,e.canvasOptions,e.extractDataUrl,n):function(){},k=e.collectFonts?function(e){var t=[],n=new WeakMap,r=FontFace;window.FontFace=function(e,t,o){var i=new r(e,t,o);return n.set(i,{family:e,buffer:"string"!=typeof t,descriptors:o,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),i};var o=nr(document.fonts,"add",(function(t){return function(r){return setTimeout((function(){var t=n.get(r);t&&(e(t),n.delete(r))}),0),t.apply(this,[r])}}));return t.push((function(){window.FontFace=r})),t.push(o),function(){t.forEach((function(e){return e()}))}}(e.fontCb):function(){},T=e.logOptions?function(e,t){var n,r,o=this,i=t.logger;if(!i)return function(){};var a=0,s=[],u=function(n){var r=n();r&&(++a<=t.lengthThreshold?e(r):a>t.lengthThreshold&&a<=t.lengthThreshold+1&&e({level:"warn",trace:[],payload:[ro("The number of log records reached the threshold ".concat(t.lengthThreshold,"!"))]}))};if(t.level.includes("error")&&window){var d=window.onerror;window.onerror=function(e,n,r,i,a){try{d&&d.apply(o,[e,n,r,i,a]),u((function(){try{var n=M(co.parse(a).map((function(e){return e.toString()}))),r=[ro(e,t.stringifyOptions)];return n.length>0&&{level:"error",errorType:"onError",trace:n,payload:r}}catch(e){}}))}catch(e){}},s.push((function(){window.onerror=d}));var h=function(e){u((function(){try{var n=M(co.parse(e.error).map((function(e){return e.toString()}))),r=[ro(e.message,t.stringifyOptions)];return n.length>0&&{level:"error",errorType:"eventError",trace:n,payload:r}}catch(e){}}))};window.addEventListener("error",h),s.push((function(){window.removeEventListener("error",h)}));var f=function(e){u((function(){try{var n=M(co.parse(e.reason).map((function(e){return e.toString()}))),r=[ro(e.reason,t.stringifyOptions)];return n.length>0&&{level:"error",errorType:"promiseError",trace:n,payload:r}}catch(e){}}))};window.addEventListener("unhandledrejection",f),s.push((function(){window.removeEventListener("unhandledrejection",f)}))}try{for(var m=c(t.level),v=m.next();!v.done;v=m.next()){var g=v.value;s.push(y(i,g))}}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}return function(){s.forEach((function(e){return e()}))};function y(e,n){var r=this;return e[n]?nr(e,n,(function(e){return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];try{e.apply(r,o),u((function(){try{var r=M(co.parse(new Error).map((function(e){return e.toString()})).splice(1)),i=o.map((function(e){return ro(e,t.stringifyOptions)}));return r.length>0&&{level:n,trace:r,payload:i}}catch(t){e.apply(void 0,p(["rrweb logger error:",t],l(o),!1))}}))}catch(t){e.apply(void 0,p(["rrweb logger error:",t],l(o),!1))}}})):function(){}}}(e.logCb,e.logOptions):function(){},x="function"==typeof e.fullScreenCb?function(e){return go&&(HTMLElement.prototype.requestFullscreen=function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(e({id:Zn.getId(this),type:$n.request}),this.addEventListener){var o=function n(){document.fullscreenElement||(e({id:Zn.getId(t),type:$n.exit}),t.removeEventListener("fullscreenchange",n))};this.addEventListener("fullscreenchange",o)}return go.apply(this,n)}),function(){go&&(HTMLElement.prototype.requestFullscreen=go)}}(e.fullScreenCb):function(){};return function(){h.disconnect(),f(),m(),v(),g(),y(),b(),w(),S(),k(),T(),x()}}var bo=function(){function e(e){this.iframes=new WeakMap,this.mutationCb=e.mutationCb}return e.prototype.addIframe=function(e){this.iframes.set(e,!0)},e.prototype.addLoadListener=function(e){this.loadListener=e},e.prototype.attachIframe=function(e,t){var n;this.mutationCb({adds:[{parentId:e.__sn.id,nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e)},e}(),wo=function(){function e(e){this.mutationCb=e.mutationCb,this.bypassOptions=e.bypassOptions}return e.prototype.addShadowRoot=function(e,t){po(this.mutationCb,t,this.bypassOptions.blockClass,this.bypassOptions.blockSelector,this.bypassOptions.maskTextClass,this.bypassOptions.maskTextSelector,this.bypassOptions.inlineStylesheet,this.bypassOptions.maskInputOptions,this.bypassOptions.maskTextFn,this.bypassOptions.recordCanvas,this.bypassOptions.extractDataUrl,this.bypassOptions.slimDOMOptions,this.bypassOptions.iframeManager,this,e)},e}();function So(){return s(this,void 0,Promise,(function(){return u(this,(function(e){return[2,{currentServerTime:(new Date).getTime(),pageNowTime:performance.now()}]}))}))}var ko,To,xo,_o,Io=1e4,Co=function(){function e(){var e=this;this._startServerTime=0,this._startBrowerTime=0,this._sleepTime=0,this._BrowerChangeTime=0,this._loading=this.init().then((function(){return e._loading=!1,!0}))}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._loading},enumerable:!1,configurable:!0}),e.prototype.init=function(){return s(this,void 0,void 0,(function(){var e,t,n;return u(this,(function(r){switch(r.label){case 0:return[4,So()];case 1:return e=r.sent(),t=e.currentServerTime,n=e.pageNowTime,this._startServerTime=t-n,this._startBrowerTime=(new Date).getTime()-performance.now(),[2]}}))}))},e.prototype.getSleepTime=function(e,t){return e-t-this._startServerTime},e.prototype.getBrowerTimeDeviation=function(){var e=performance.now();return(new Date).getTime()-e-this._startBrowerTime-this._BrowerChangeTime-this._sleepTime},e.prototype.checkTimeValid=function(){return this.getBrowerTimeDeviation()<Io},e.prototype.fixTime=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return u(this,(function(s){switch(s.label){case 0:return[4,So()];case 1:return e=s.sent(),t=e.currentServerTime,n=e.pageNowTime,r=this.getSleepTime(t,n),o=r-this._sleepTime,(i=o>Io)&&(this._sleepTime=r),(a=this.getBrowerTimeDeviation())>Io&&(this._BrowerChangeTime+=a),this._loading=!1,[2,i]}}))}))},e.prototype.isLoadingServeTime=function(){return!this.checkTimeValid()&&(this._loading||(this._loading=this.fixTime()),this._loading)},e.prototype.getTime=function(e){var t=(e=void 0===e?performance.now():e)+this._sleepTime+this._startServerTime;return Math.ceil(t)},e.prototype.getTimePair=function(){return[performance.now(),Date.now()]},Object.defineProperty(e.prototype,"startServerTime",{get:function(){return this._startServerTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"undefinedPair",{get:function(){return[void 0,void 0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sleepTimePerformaceNow",{get:function(){return performance.now()+this._sleepTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sleepTime",{get:function(){return this._sleepTime},enumerable:!1,configurable:!0}),e}(),Eo=new Co;function Oo(e,t){void 0===t&&(t=Eo.undefinedPair);var n=Eo.getTimePair();return a(a({},e),{timestamp:ko=void 0===t[0]?n[0]:t[0],clienttime:To=void 0===t[1]?n[1]:t[1]})}function Mo(e){void 0===e&&(e={});var t=e.eaExtractDataUrl,n=void 0!==t&&t,r=e.nodeFilter,o=e.canvasOptions,i=e.emit,s=e.checkoutEveryNms,u=e.checkoutEveryNth,c=e.blockClass,p=void 0===c?"rr-block":c,d=e.blockSelector,h=void 0===d?null:d,f=e.ignoreClass,m=void 0===f?"rr-ignore":f,v=e.maskTextClass,g=void 0===v?"rr-mask":v,y=e.maskTextSelector,b=void 0===y?null:y,w=e.inlineStylesheet,S=void 0!==w&&w,T=e.maskAllInputs,x=e.maskInputOptions,_=e.slimDOMOptions,I=e.maskInputFn,C=e.maskTextFn,E=e.hooks,O=e.packFn,M=e.sampling,N=void 0===M?{}:M,R=e.mousemoveWait,D=e.recordCanvas,P=void 0!==D&&D,A=e.collectFonts,L=void 0!==A&&A,j=e.recordLog,F=void 0!==j&&j;if(!i)throw new Error("emit function is required");void 0!==R&&void 0===N.mousemove&&(N.mousemove=R);var U,B,q=!0===T?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:void 0!==x?x:{},H=!0===_||"all"===_?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===_,headMetaDescKeywords:"all"===_}:_||{},z={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:console},V=F?!0===F?z:Object.assign({},z,F):{};void 0===U&&(U=window),"NodeList"in U&&!U.NodeList.prototype.forEach&&(U.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in U&&!U.DOMTokenList.prototype.forEach&&(U.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(e){if(!(0 in arguments))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1});var W=0;xo=function(e,t){var n;if(!(null===(n=lo[0])||void 0===n?void 0:n.isFrozen())||e.type===Vn.FullSnapshot||e.type===Vn.IncrementalSnapshot&&e.data.source===Wn.Mutation||lo.forEach((function(e){return e.unfreeze()})),i(O?O(e):e,t),e.type===Vn.FullSnapshot)B=e,W=0;else if(e.type===Vn.IncrementalSnapshot){if(e.data.source===Wn.Mutation&&e.data.isAttachIframe)return;W++;var r=u&&W>=u,o=s&&e.timestamp-B.timestamp>s;(r||o)&&_o(!0)}};var $=function(e){xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.Mutation},e)}))},K=new bo({mutationCb:$}),G=new wo({mutationCb:$,bypassOptions:{blockClass:p,blockSelector:h,maskTextClass:g,maskTextSelector:b,inlineStylesheet:S,maskInputOptions:q,maskTextFn:C,recordCanvas:P,extractDataUrl:n,slimDOMOptions:H,iframeManager:K}});_o=function(e){var t,o,i,a;void 0===e&&(e=!1);performance.now();ft.clear();var s=or(),u=rr();xo(Oo({type:Vn.Meta,data:{href:window.location.href,width:s,height:u}}),e),lo.forEach((function(e){return e.lock()}));var c=l(function(e,t){var n=t||{},r=n.blockClass,o=void 0===r?"rr-block":r,i=n.blockSelector,a=void 0===i?null:i,s=n.maskTextClass,u=void 0===s?"rr-mask":s,c=n.maskTextSelector,l=void 0===c?null:c,p=n.inlineStylesheet,d=void 0!==p&&p,h=n.recordCanvas,f=void 0!==h&&h,m=n.maskAllInputs,v=void 0!==m&&m,g=n.maskTextFn,y=n.slimDOM,b=void 0!==y&&y,w=n.preserveWhiteSpace,S=n.onSerialize,k=n.onIframeLoad,T=n.iframeLoadTimeout,x=n.eaExtractDataUrl,_=void 0!==x&&x,I=n.nodeFilter,C={},E=new vt;return[un(e,{doc:e,map:C,blockClass:o,blockSelector:a,maskTextClass:u,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:!0===v?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===v?{password:!0}:v,maskTextFn:g,slimDOMOptions:!0===b||"all"===b?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===b,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===b?{}:b,recordCanvas:f,preserveWhiteSpace:w,onSerialize:S,onIframeLoad:k,serializeArray:E,iframeLoadTimeout:T,eaExtractDataUrl:_,nodeFilter:I}),C,E.get()]}(document,{eaExtractDataUrl:n,nodeFilter:r,blockClass:p,blockSelector:h,maskTextClass:g,maskTextSelector:b,inlineStylesheet:S,maskAllInputs:q,maskTextFn:C,slimDOM:H,recordCanvas:P,onSerialize:function(e){cr(e)&&G.addShadowRoot(e.shadowRoot,document)}}),3),d=c[0],f=c[1],m=c[2];if(!d)return performance.now(),k.safewarn("Failed to snapshot the document");performance.now(),Zn.map=f,xo(Oo({type:Vn.FullSnapshot,data:{node:m,initialOffset:{width:s,height:u,left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(o=null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.parentElement)||void 0===o?void 0:o.scrollLeft)||(null===document||void 0===document?void 0:document.body.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(a=null===(i=null===document||void 0===document?void 0:document.body)||void 0===i?void 0:i.parentElement)||void 0===a?void 0:a.scrollTop)||(null===document||void 0===document?void 0:document.body.scrollTop)||0}}}));var v=Zn.map,y=v.dataurl,w=v.idnodes;y&&w&&Object.keys(y).forEach((function(e){if("length"!=e){var t=y[e];xo(Oo({type:Vn.Custom,data:{tag:"snapshot_source",payload:{id:Zn.getId(w[e][0]),ids:w[e].map((function(e){return Zn.getId(e)})),sourceid:e,data:t}}},[ko,To]))}})),lo.forEach((function(e){return e.unlock()}))};try{var X=[];K.addLoadListener((function(e){}));var J=function(){var e;qt.clear(),qt.resizeObserve((function(e){xo(Oo({type:Vn.IncrementalSnapshot,data:{source:Wn.SizeChange,sizes:e}}))})),_o(),X.push((e=document,yo({mutationCb:$,mousemoveCb:function(e,t){return xo(Oo({type:Vn.IncrementalSnapshot,data:{source:t,positions:e}}))},mouseInteractionCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.MouseInteraction},e)}))},scrollCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.Scroll},e)}))},viewportResizeCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.ViewportResize},e)}))},inputCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.Input},e)}))},mediaInteractionCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.MediaInteraction},e)}))},styleSheetRuleCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.StyleSheetRule},e)}))},canvasMutationCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.CanvasMutation},e)}))},fontCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.Font},e)}))},fullScreenCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.fullscreen},e)}))},logCb:function(e){return xo(Oo({type:Vn.IncrementalSnapshot,data:a({source:Wn.Log},e)}))},blockClass:p,ignoreClass:m,maskTextClass:g,maskTextSelector:b,maskInputOptions:q,inlineStylesheet:S,sampling:N,recordCanvas:P,collectFonts:L,doc:e,maskInputFn:I,maskTextFn:C,logOptions:V,blockSelector:h,slimDOMOptions:H,iframeManager:K,shadowDomManager:G,extractDataUrl:n,canvasOptions:o,nodeFilter:r},E,(function(e){xo(Oo(e))}))))};return"complete"===document.readyState?J():"interactive"===document.readyState?(J(),X.push(Yn("load",(function(){xo(Oo({type:Vn.Load,data:{}}))}),window))):(X.push(Yn("DOMContentLoaded",(function(){xo(Oo({type:Vn.DomContentLoaded,data:{}})),J()}))),X.push(Yn("load",(function(){xo(Oo({type:Vn.Load,data:{}}))}),window))),function(){X.forEach((function(e){return e()}))}}catch(e){k.safewarn(e)}}Mo.addCustomEvent=function(e,t,n){if(!xo)throw new Error("please add custom event after start recording");xo(Oo({type:Vn.Custom,data:{tag:e,payload:t}},n))},Mo.freezePage=function(){lo.forEach((function(e){return e.freeze()}))},Mo.takeFullSnapshot=function(e){if(!_o)throw new Error("please take full snapshot after start recording");_o(e)},Mo.getNode=function(e){return Zn.getNode(e)};var No,Ro=function(){function e(){this.firstResourceSnapshotFlag=!1}return e.prototype.emit=function(e,t){return e},e.prototype.initSet=function(){k.safelog("rrwebManager.initSet"),this.destroy(),this.stopFn=Mo({checkoutEveryNth:2e3,emit:this.emit.bind(this),slimDOMOptions:!0,blockClass:"rr-block",hooks:{mutation:function(e){},mousemove:function(e){},mouseInteraction:function(e){},scroll:function(e){}},recordLog:!1,packFn:function(e){return e},sampling:{mousemove:!0,mouseInteraction:{MouseUp:!1,MouseDown:!1,ContextMenu:!1,DblClick:!1,Focus:!0,Blur:!0,TouchStart:!1,TouchEnd:!1},scroll:150,input:"all"}})},e.prototype.reset=function(){this.destroy(),this.initSet()},e.prototype.destroy=function(){this.stopFn&&(this.stopFn(),this.stopFn=null),this.snapShotTimestamp=null},e.prototype.getNodeFilter=function(e){if(e){var t={};return e.forEach((function(e){var n=e.indexOf("{");if(-1!=n){var r=e.substring(0,n),o=e.substring(n+1,e.length);t[r]=function(e,t){new Function("n","attr",o).call(null,e,t)}}})),t}},e.prototype.emitCustomEvent=function(e,t){var n=Eo.getTimePair();this.emit({type:Vn.Custom,timestamp:n[0],clienttime:n[1],data:{tag:e,payload:t}})},e}(),Do=new Ro;!function(e){e.ReportEvents="/api/v1/collect/webapi/receive_event_data",e.ReportPlayRange="/api/v1/collect/webapi/receive_file_data",e.ReportDevRange="/api/v1/collect/webapi/log_report",e.ResourceDetectJS="/api/v1/filesystem/stream/detect/js",e.ResourceBindCSS="/api/v1/filesystem/stream/bind_css",e.ResourceUpladCSS="/api/v1/filesystem/stream/upload/css",e.BasicGetLocalTime="/api/v1/filesystem/local_time",e.BasicPostOssToken="/api/v1/collect/webapi/oss_token",e.BasicPostUserSet="/api/v1/collect/webapi/user_set"}(No||(No={}));var Po,Ao="log",Lo="filedata",jo=function(){function e(){this.ossPromise={},this.oss={}}return e.prototype.init=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.waitSetValue(Ao,this.newOSSConfig(Ao))];case 1:return e.sent(),[4,this.waitSetValue(Lo,this.newOSSConfig(Lo))];case 2:return e.sent(),[2]}}))}))},e.prototype.waitSetValue=function(e,t){return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),this.oss[e]&&k.safewarn("oss config ".concat(e," updated"),n),[2,this.oss[e]=n]}}))}))},e.prototype.newOSSConfig=function(e){var t=this;return this.ossPromise[e]=wr(process.env.HOST+No.BasicPostOssToken,{source_id:S.shareInstance().streamId,project_id:Se.shareInstance().projectKey,type:e}).then((function(n){return t.ossPromise[e]=void 0,n}))},e.prototype.getOSSConfigPromise=function(e){if(this.ossPromise[e])return this.ossPromise[e];var t=this.newOSSConfig(e);return this.waitSetValue(e,t),t},e}(),Fo=new jo;!function(e){e[e.anonymousSwitch=1]="anonymousSwitch",e[e.anonymousToLogin=2]="anonymousToLogin",e[e.logout=3]="logout",e[e.relogin=4]="relogin",e[e.loginSwitch=5]="loginSwitch"}(Po||(Po={}));var Uo=function(){function e(){this.prefab=new be(this)}return e.prototype.setup=function(){k.log("[UserView/User] 用户中心初始化完成")},e.shareInstance=function(){return e.instance||(e.instance=new e),e.instance},Object.defineProperty(e.prototype,"uid",{get:function(){var e,t=null===(e=Se.shareInstance().user)||void 0===e?void 0:e.uid;return null!=t||null!=t?String(t):""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"info",{get:function(){var e;return null===(e=Se.shareInstance().user)||void 0===e?void 0:e.info},enumerable:!1,configurable:!0}),e.prototype.userSet=function(e){return s(this,void 0,Promise,(function(){var t,n,r,o,i,a;return u(this,(function(s){switch(s.label){case 0:if(!e||"{}"===JSON.stringify(e))throw new Error("userSet userinfo should not be null, undefined or empty object");return t=Se.shareInstance(),n=this.prefab.has("uid")&&this.prefab.get("uid")||this.uid,r=t.prefab.has("device_id")&&t.prefab.get("device_id")||t.deviceId,o=t.projectKey,i=S.shareInstance().streamId,Do.emitCustomEvent("USERSET_INVOKE_LOG",{userinfo:e}),a={},Object.entries(e).forEach((function(e){var t=l(e,2),n=t[0],r=t[1];a[n]=String(r)})),[4,wr(process.env.HOST+No.BasicPostUserSet,{uid:n?"".concat(n):void 0,device_id:r,project_key:o,info_list:a,streamId:i})];case 1:return[2,s.sent().errStr]}}))}))},e.prototype.identify=function(e,t){return k.log("[UserView/User] 绑定用户: userId:".concat(e," email:").concat(null==t?void 0:t.email," phone:").concat(null==t?void 0:t.phone," name:").concat(null==t?void 0:t.name)),k.log("[UserView/User] old userId = ".concat(this.uid,", new userId = ").concat(e)),setTimeout((function(){Do.emitCustomEvent("IDENTIFY_INVOKE_LOG",{userId:e,info:t})}),0),this.uid?e?this.uid===e?(k.log("[UserView/User] 绑定用户：实名 -> 实名(uid相同)"),this.storeUser(e,t),{status:Po.relogin}):(k.log("[UserView/User] 绑定用户：实名 -> 实名(uid不同)"),this.prefab.save("uid",e),Se.shareInstance().prefab.save("device_id",Se.generateDeviceIdentifier()),{status:Po.loginSwitch,data:{uid:e,info:t}}):(k.log("[UserView/User] 绑定用户：实名 -> 匿名"),this.storeUser(e,t),{status:Po.logout}):e?(k.log("[UserView/User] 绑定用户：匿名 -> 实名"),this.storeUser(e,t),{status:Po.anonymousToLogin}):(k.log("[UserView/User] 绑定用户：匿名 -> 匿名"),this.storeUser(e,t),{status:Po.anonymousSwitch})},e.prototype.storeUser=function(e,t){var n={uid:e,info:a({},t)};k.log("[UserView/User] 存储新用户信息 = ".concat(JSON.stringify(n))),Se.shareInstance().user=n},e.prototype.trackUserEvent=function(e,t){},e}(),Bo={},qo=function(){function e(){this._processStatus=!1,this._pauseIndex=0,this._processList=[]}return Object.defineProperty(e.prototype,"status",{get:function(){return this._processStatus},enumerable:!1,configurable:!0}),e.prototype.create=function(e,t,n){void 0===t&&(t=!0),n||(n="pipe");var r=e[n];if("function"!=typeof r)return console.error(new Error("".concat(n," must be a funtion"))),this;var o=r.__HAS_PROCESS;return o&&o.has(this)||(o||(o=new Set,e[n]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=r.apply(this,e);return o.forEach((function(e){e.status&&(t?e.handle(i):e.asyncHnadle(i))})),i}),o.add(this)),this},e.prototype.start=function(){return this._processStatus=!0,this},e.prototype.stop=function(){return this._processStatus=!1,this},e.prototype.next=function(e){return this._processList.push(e),this},e.prototype.pipe=function(e){return e},e.prototype.asyncHnadle=function(e){return s(this,void 0,Promise,(function(){var t,n,r,o;return u(this,(function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),[4,e];case 1:e=i.sent(),t=this._processList.length,n=null,r=0,i.label=2;case 2:return r<t?[4,(0,this._processList[r])(e,Bo)]:[3,5];case 3:if((n=i.sent())===Bo)return[2,null];i.label=4;case 4:return r++,[3,2];case 5:return this.pipe(n),[2,n];case 6:return hr({asyncProcessError:dr(o=i.sent())}),k.error(o),[2,null];case 7:return[2]}}))}))},e.prototype.handle=function(e){try{for(var t=this._processList.length,n=0;n<t;n++){if((e=(0,this._processList[n])(e,Bo))===Bo)return null}return this.pipe(e),e}catch(e){return hr({syncProcessError:dr(e)}),k.error(e),null}},e}();function Ho(e,t){return(new qo).create(e,!0,t)}var zo,Vo=function(){function e(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}return e.prototype.toString=function(){var e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?this.functionName+" ("+this.fileName+":"+e+":"+t+")":this.fileName+":"+e+":"+t},e}(),Wo=/(^|@)\S+:\d+/,$o=/^\s*at .*(\S+:\d+|\(native\))/m,Ko=/^(eval@)?(\[native code])?$/,Go={parse:function(e){return e?void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match($o)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):[]:[]},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error("Cannot parse given url: ".concat(e));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match($o)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=t.match(/ (\((.+):(\d+):(\d+)\)$)/),r=(t=n?t.replace(n[0],""):t).split(/\s+/).slice(1),o=this.extractLocation(n?n[1]:r.pop()),i=r.join(" ")||void 0,a=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new Vo({functionName:i,fileName:a,lineNumber:o[1],columnNumber:o[2]})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(Ko)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new Vo({functionName:e});var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),r=n&&n[1]?n[1]:void 0,o=this.extractLocation(e.replace(t,""));return new Vo({functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),r=[],o=2,i=n.length;o<i;o+=2){var a=t.exec(n[o]);a&&r.push(new Vo({fileName:a[2],lineNumber:parseFloat(a[1])}))}return r},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o+=2){var a=t.exec(n[o]);a&&r.push(new Vo({functionName:a[3]||void 0,fileName:a[2],lineNumber:parseFloat(a[1])}))}return r},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(Wo)&&!e.match(/^Error created at/)}),this).map((function(e){var t=e.split("@"),n=this.extractLocation(t.pop()),r=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new Vo({functionName:r,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})}),this)}},Xo=function(){function e(t){this.levelMapping=t||function(e){return e.data.level},this.__queue=[e.HistoryMark]}return e.prototype.filter=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.queue).filter.apply(e,p([],l(t),!1))},e.prototype.push=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.__queue).push.apply(e,p([],l(t),!1))},Object.defineProperty(e.prototype,"queue",{get:function(){return this.__queue.filter((function(t){return t!=e.HistoryMark}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"infos",{get:function(){return this.__subQueueGetter(this.queue,"log","info")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"warnings",{get:function(){return this.__subQueueGetter(this.queue,"warn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errors",{get:function(){return this.__subQueueGetter(this.queue,"error")},enumerable:!1,configurable:!0}),e.prototype.__subQueueGetter=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return e.filter((function(e){return n.some((function(n){return t.levelMapping(e)===n}))}))},Object.defineProperty(e.prototype,"newly",{get:function(){var t;return-1!=(t=this.__queue.indexOf(e.HistoryMark))?this.__queue.slice(t+1):this.queue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newlyInfos",{get:function(){return this.__subQueueGetter(this.newly,"log","info")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newlyWarnings",{get:function(){return this.__subQueueGetter(this.newly,"warn")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newlyErrors",{get:function(){return this.__subQueueGetter(this.newly,"error")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.__queue.filter((function(t){return t!=e.HistoryMark})).length},enumerable:!1,configurable:!0}),e.prototype.markAllAsHistory=function(){var t;-1!=(t=this.__queue.indexOf(e.HistoryMark))&&this.__queue.splice(t,1),this.__queue.push(e.HistoryMark)},e.prototype.clear=function(){this.__queue=[e.HistoryMark]},e.HistoryMark={message:"this is marked message"},e}(),Jo=function(){function e(){this.dispatcher=new h,this.queue=new Xo((function(e){return e.level})),this.disconnectors=[]}return Object.defineProperty(e.prototype,"options",{get:function(){return{level:Dr.logConfig.levels||["info","log","warn","error"],lengthThreshold:Dr.logConfig.maxNum,stringifyOptions:{stringTypeValuesTotalLengthLimit:Dr.logConfig.totalPropsMaxLength||1e4,stringLengthLimit:Dr.logConfig.singlePropMaxLength||1e3,numOfKeysLimit:Dr.logConfig.maxProps||100}}},enumerable:!1,configurable:!0}),e.prototype.next=function(e){return k.safelog("LoggerNext",e),this.queue.push(e),this.dispatcher.emitSync("next",e),e},e.prototype.disconnect=function(){for(;this.disconnectors.length>0;){this.disconnectors.shift()()}},e.prototype.observe=function(){var e,t,n=this;if(window){k.safelog("logManager.observe");var r=0;this.disconnect();var o=this.options,i=function(e){var t=e();t&&(++r<=o.lengthThreshold?n.next(t):r>o.lengthThreshold&&r<=o.lengthThreshold+1&&n.next({level:"warn",trace:[],payload:[ro("The number of log records reached the threshold ".concat(o.lengthThreshold,"!"))]}))};if(o.level.includes("error")){var a=function(e){i((function(){try{var t=M(Go.parse(e.error).map((function(e){return e.toString()}))),n=[ro(e.message,o.stringifyOptions)];return t.length>0&&{level:"error",errorType:"event",trace:t,payload:n}}catch(e){}}))};window.addEventListener("error",a),this.disconnectors.push((function(){window.removeEventListener("error",a)}));var s=function(e){i((function(){try{var t=M(Go.parse(e.reason).map((function(e){return e.toString()}))),n=[ro(e.reason,o.stringifyOptions)];return t.length>0&&{level:"error",errorType:"promise",trace:t,payload:n}}catch(e){}}))};window.addEventListener("unhandledrejection",s),this.disconnectors.push((function(){window.removeEventListener("unhandledrejection",s)}))}try{for(var u=c(o.level),d=u.next();!d.done;d=u.next()){var h=d.value;this.disconnectors.push(f(window.console,h))}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}}function f(e,t){var n=this;return e[t]?nr(e,t,(function(e){return function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];try{e.apply(n,r),i((function(){try{var n=M(Go.parse(new Error).map((function(e){return e.toString()})).splice(1)),i=r.map((function(e){return ro(e,o.stringifyOptions)}));return n.length>0&&{level:t,trace:n,payload:i}}catch(t){e.apply(void 0,p(["userview logger error:",t],l(r),!1))}}))}catch(t){e.apply(void 0,p(["userview logger error:",t],l(r),!1))}}})):function(){}}},e.prototype.resetConsoleQueue=function(){this.queue.clear()},e}(),Qo=new Jo,Yo=function(){},Zo=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(this,t)}},ei=function(){function e(e,t){this.target=e,this._before=Yo,this._afterSync=Yo,this._afterAsync=Yo,this.propertyName=t}return e.prototype.before=function(e){return this._before=Zo(e)},e.prototype.afterSync=function(e){return this._afterSync=Zo(e)},e.prototype.afterAsync=function(e){return this._afterAsync=Zo(e)},e.prototype.enable=function(){this.shim=this.makeShim();try{this.target[this.propertyName]=this.shim.proxy}catch(e){return!1}return!0},e.prototype.disable=function(){var e=this.shim.native;this.target[this.propertyName]=e,this.shim=null},e.prototype.makeShim=function(){var e=this.target[this.propertyName],t=this;return{native:e,proxy:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={that:this,args:n,result:null};t._before(o);var i=e.apply(this,n);return o.result=i,t._afterSync(o),t._afterAsync(o),i}}},e}(),ti=function(){function e(e){this.ajaxOpenHook=null,this.ajaxHeaderHook=null,this.ajaxSendHook=null,this._requestData=new WeakMap,this.reporter=e}return e.prototype._getRequestData=function(e){var t=this._requestData.get(e);if(t)return t;var n={};return this._requestData.set(e,n),n},e.prototype.enable=function(){var e=XMLHttpRequest.prototype;this.ajaxOpenHook=new ei(e,"open");var t=this;this.ajaxOpenHook.enable(),this.ajaxOpenHook.before((function(e){var n=t._getRequestData(e.that);n.method=e.args[0],n.url=e.args[1]})),this.ajaxHeaderHook=new ei(e,"setRequestHeader"),this.ajaxHeaderHook.enable(),this.ajaxHeaderHook.before((function(e){var n=e.that,r=e.args[0],o=e.args[1],i=t._getRequestData(n);i.headers||(i.headers={}),i.headers[r]=o})),this.ajaxSendHook=new ei(e,"send"),this.ajaxSendHook.enable(),this.ajaxSendHook.before((function(e){var n=e.that;t._getRequestData(n).payload=e.args[0],n.addEventListener("readystatechange",(function(){n.readyState===XMLHttpRequest.DONE&&t.processReqAndRes(n)})),n.addEventListener("error",(function(e){t.processReqAndRes.call(t,e)})),n.addEventListener("abort",(function(e){t.processReqAndRes.call(t,e)})),n.addEventListener("timeout",(function(e){t.processReqAndRes.call(t,e)}))}))},e.prototype.processReqAndRes=function(e){var t,n,o,i,a={tag:"Ajax",request:{url:"",method:"",headers:{},body:null},response:{headers:{},status:"",body:null}};if(e.type){var s=this._getRequestData(e.target);a.request.method=s.method,a.request.url=s.url;var u=s.payload;switch(r(u)){case"string":a.request.body=u;break;case"object":switch(u?u.constructor:null){case FormData:case URLSearchParams:var p={};try{for(var d=c(u.entries()),h=d.next();!h.done;h=d.next()){var f=l(h.value,2),m=f[0],v=f[1];p[m]=v}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}a.request.body=p;break;case Blob:case ArrayBuffer:case Document:case ReadableStream:a.request.body=null;break;default:a.request.body=u}}a.response.status="4xx-5xx",a.request.headers=s.headers?s.headers:{},this.filter(a,s)}else{s=this._getRequestData(e);a.request.method=s.method,a.request.url=s.url;u=s.payload;switch(r(u)){case"string":a.request.body=u;break;case"object":switch(u?u.constructor:null){case FormData:p={};try{for(var g=c(u.entries()),y=g.next();!y.done;y=g.next()){var b=l(y.value,2);m=b[0],v=b[1];p[m]=v}}catch(e){o={error:e}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}a.request.body=p;break;case URLSearchParams:a.request.body=u.toString();break;case Blob:case ArrayBuffer:case Document:case ReadableStream:a.request.body=null;break;default:a.request.body=u}}a.request.headers=s.headers?s.headers:{},a.response.status=e.status||"2xx-3xx",e.getAllResponseHeaders().split("\r\n").filter((function(e){return e})).forEach((function(e){var t=e.split(":")[0],n=e.substring(t.length+1);a.response.headers[t]=n}));var w=e.response;switch(r(w)){case"string":a.response.body=w;break;case"object":switch(w?w.constructor:null){case Blob:case ArrayBuffer:case Document:case FormData:case URLSearchParams:case ReadableStream:a.response.body=null;break;default:a.response.body=w}}this.filter(a,s)}},e.prototype.disable=function(){this.ajaxOpenHook&&this.ajaxOpenHook.disable(),this.ajaxHeaderHook&&this.ajaxHeaderHook.disable(),this.ajaxSendHook&&this.ajaxSendHook.disable()},e.prototype.filter=function(e,t){e.request.url.match(/v2.Collect/)||e.request.url.match(/userview.net\/collect/)?this._requestData.delete(t):this.recordAjax(e)},e.prototype.recordAjax=function(e){this.reporter&&this.reporter(e)},e}(),ni="arrayBuffer",ri="blob",oi="formData",ii="json",ai="text",si=function(){function e(e){this._hook=null,this.reporter=e}return e.prototype.enable=function(){var e=this;this._hook=new ei(window,"fetch"),this._hook.enable(),this._hook.shim.proxy.fetchOrigin=this._hook.shim.native,this._hook&&this._hook.afterSync((function(t){return e.recordFetch(t.result,t.args[0],t.args[1])}))},e.prototype.disable=function(){this._hook&&this._hook.disable(),this._hook=null},e.prototype.recordFetch=function(e,t,n){var r=this,o=n||{},i=o.headers,a=o.method;o._eaOptions;var p=o.body;s(r,void 0,void 0,(function(){var n,r,o,d,h,f,m,v,g,y,b,w=this;return u(this,(function(S){switch(S.label){case 0:n={tag:"fetch",request:{url:t,method:a||"GET",headers:i||{},body:p||null},response:{headers:{},status:"",statusText:"",body:null}},S.label=1;case 1:return S.trys.push([1,3,,4]),[4,e];case 2:r=S.sent(),n.response.status="".concat(r.status)||"2xx-3xx";try{for(o=c(r.headers.entries()),d=o.next();!d.done;d=o.next())h=l(d.value,2),f=h[0],m=h[1],n.response.headers[f]=m}catch(e){y={error:e}}finally{try{d&&!d.done&&(b=o.return)&&b.call(o)}finally{if(y)throw y.error}}return v=[],g=function(e){var t=new ei(r,e);v.push(t),t.enable(),t.afterAsync((function(t){return s(w,void 0,void 0,(function(){var r;return u(this,(function(o){switch(o.label){case 0:switch(e){case ni:case ri:return[3,1];case oi:case ii:case ai:return[3,2]}return[3,4];case 1:return n.response.body=null,[3,4];case 2:return r=n.response,[4,t.result];case 3:return r.body=o.sent(),[3,4];case 4:return v.forEach((function(e){return e.disable()})),this.reporter&&this.reporter(n),[2]}}))}))}))},g(ni),g(ri),g(oi),g(ii),g(ai),[3,4];case 3:return S.sent(),n.response.status="4xx-5xx",this.reporter&&this.reporter(n),[3,4];case 4:return[2]}}))}))},e}(),ui=function(){function e(e){this._observer=null,this.enqueue=[],this.reporter=e,this.performance=window.performance,this.recordLength=0}return Object.defineProperty(e.prototype,"networkConfig",{get:function(){return Dr.networkConfig},enumerable:!1,configurable:!0}),e.prototype.init=function(){var e=this;window.PerformanceObserver?(this.performance.getEntriesByType("resource").forEach((function(t){e.filter(t)})),this._observer&&this._observer.disconnect&&this._observer.disconnect(),this._observer=new window.PerformanceObserver((function(t){t.getEntries().forEach((function(t){e.filter(t)}))}))):this.performance.getEntries().forEach((function(t){e.filter(t)})),this.errorListener&&window.removeEventListener("error",this.errorListener),window.addEventListener("error",this.errorListener=function(t){if(t.target&&(t.target.src||t.target.href)){var n=t.target.src||t.target.href;e.reporter&&e.reporter(void 0,n)}},!0)},e.prototype.filter=function(e){var t,n,r,o=null===(t=this.networkConfig.disabledUrls)||void 0===t?void 0:t.some((function(t){if(null!=e.name.match(t))return r=t,!0}));if(o)k.safewarn("network resource filtered name: ".concat(e.name," regular: ").concat(r));else{if(k.safelog("network resource name: ".concat(e.name)),("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)&&(null===(n=this.networkConfig.allowDetails)||void 0===n?void 0:n.length))for(var i=0;i<this.networkConfig.allowDetails.length;i++){var s=this.networkConfig.allowDetails[i];if(e.name.match(s.regular)){var u={};switch(s.network_request_desc_collect_range){case 1:u.request=!0,u.response=!1;break;case 2:u.request=!1,u.response=!0;break;case 3:u.request=!0,u.response=!0}e.recordDetail=a({},u);break}}++this.recordLength>this.networkConfig.maxNum||this.recordEntry(e)}},e.prototype.recordEntry=function(e){if("resource"===e.entryType)this.recordResource(e)},e.prototype.recordResource=function(e){this.reporter&&this.reporter(e)},e.prototype.start=function(){var e=["resource"];window.PerformancePaintTiming&&e.push("paint"),this._observer&&this._observer.observe({entryTypes:e})},e.prototype.reset=function(){this.recordLength=0},e.prototype.shutdown=function(){this._observer&&this._observer.disconnect&&this._observer.disconnect()},e}(),ci=["mp4","m4v","3gp","mpg","flv","f4v","swf","avi","wmv","rmvb","mov","mts","m2t","webm","ogg","mkv"],li=["png","jpeg","jpg","webp","svg","gif"],pi=["css","ttf","woff","woff2","eot","otf","ttc"],di=["js"];!function(e){e[e.xhr=1]="xhr",e[e.js=2]="js",e[e.css=3]="css",e[e.img=4]="img",e[e.media=5]="media",e[e.other=6]="other"}(zo||(zo={}));var hi=function(){function e(){this.dispatcher=new h,this.context={networkMap:new Map,errResource:new Map}}return e.prototype.disconnect=function(){this.ajaxInterceptorInstance&&this.ajaxInterceptorInstance.disable(),this.fetchInterceptorInstance&&this.fetchInterceptorInstance.disable(),this.staticResourceInterceptorInstance&&this.staticResourceInterceptorInstance.shutdown()},e.prototype.next=function(e){return k.safelog("NetworkNext",e),this.dispatcher.emitSync("next",e),e},e.prototype.resourceHandler=function(e,t){var n,r,o,i;if(!t){var a=e.name,s=e.initiatorType,u=e.duration,p=e.startTime,d=e.decodedBodySize,h=e.recordDetail,f="";if("xmlhttprequest"===s||"fetch"===s){var m=null,v=function(e){var t,n=new URL(e);return{General:{"Request URL":e,"Request Method":"GET"},Request:{},Response:{},payload:null!==(t=n.search.slice(1))&&void 0!==t?t:""}}(a),g="-";if(s="xhr",f="xhr",this.context.networkMap.size)try{for(var y=c(this.context.networkMap.entries()),b=y.next();!b.done;b=y.next()){var w=l(b.value,2),S=w[0];if((I=w[1]).request.url===a){var k=I.request,T=I.response;v.General["Request Method"]=k.method,g=T.status,v.Request=Object.assign(v.Request,k.headers),v.Response=T.headers,h&&(h.request&&("null"!==k.body&&k.body?v.requestBody=k.body:v.requestBody=v.payload),h.response&&(v.responseBody=T.body||null)),this.context.networkMap.delete(S)}}}catch(e){n={error:e}}finally{try{b&&!b.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}return m={timingDetail:fi(e,!0),headersDetail:v,sourceSize:"number"==typeof d?d:"-"},this.next({status:"".concat(g),name:a,type:zo[s],sourceType:f,content:m,consumeTime:u,relativelyTime:p})}g="2xx-3xx";if(this.context.errResource.size)try{for(var x=c(this.context.errResource.entries()),_=x.next();!_.done;_=x.next()){var I,C=l(_.value,2);S=C[0];(I=C[1])===a&&(g="4xx-5xx",this.context.errResource.delete(S))}}catch(e){o={error:e}}finally{try{_&&!_.done&&(i=x.return)&&i.call(x)}finally{if(o)throw o.error}}var E=a.slice(a.lastIndexOf(".")+1,a.length),O=/(.+)\?/.exec(E.toLowerCase());E=O?O[1]:E.toLowerCase(),~di.indexOf(E)?(s="js",f="script"):~pi.indexOf(E)?(s="css",f="stylesheet"):~li.indexOf(E)?(s="img",f="img"):~ci.indexOf(E)?(s="media",f="media"):(s="other",f="other");m={timingDetail:"4xx-5xx"===g?null:fi(e),headersDetail:{General:{"Request URL":a,"Request Method":"GET"}},sourceSize:"number"==typeof d?d:"-"};return this.next({status:"".concat(g),name:a,type:zo[s],sourceType:f,content:m,consumeTime:u,relativelyTime:p})}this.context.errResource.set(t,t)},e.prototype.waitResourceHandleNext=function(e){this.context.networkMap.set(e,e)},e.prototype.observe=function(){k.safelog("networkManager.observe"),this.ajaxInterceptorInstance=new ti(this.waitResourceHandleNext.bind(this)),this.fetchInterceptorInstance=new si(this.waitResourceHandleNext.bind(this)),this.staticResourceInterceptorInstance=new ui(this.resourceHandler.bind(this)),this.ajaxInterceptorInstance.enable(),this.fetchInterceptorInstance.enable(),this.staticResourceInterceptorInstance.init(),this.staticResourceInterceptorInstance.start()},e}();function fi(e,t){var n=e.domainLookupEnd,r=e.duration,o=e.domainLookupStart,i=e.connectEnd,a=e.connectStart,s=e.secureConnectionStart,u=e.responseStart,c=e.responseEnd,l=e.requestStart,p=n-o,d=i-a,h=u?c-u:r,f=u?u-l<r?u-l:0:"-",m=u?r-p-d-("-"===f?0:f)-h:"-";return t&&(f="-"===f?0:f,m="-"===m?0:m),{Stalled:m,"DNS Lookup":p,"Initial Connection":d,SSL:u?s>0?i-s:0:"-","Sent/Waiting(TTFB)":f,"Content Download":h}}var mi,vi,gi,yi,bi=new hi,wi=function(){function e(){this.datas=[]}return Object.defineProperty(e.prototype,"latestUserData",{get:function(){var e;return null===(e=this.latest)||void 0===e?void 0:e.userdata},enumerable:!1,configurable:!0}),e.prototype.getUserData=function(e){var t;return null===(t=this.datas[e])||void 0===t?void 0:t.userdata},Object.defineProperty(e.prototype,"firstUserData",{get:function(){var e;return null===(e=this.first)||void 0===e?void 0:e.userdata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this.datas.length>0?this.datas[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latest",{get:function(){return this.datas.length>0?this.datas[this.datas.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.push=function(e){this.datas.push({userdata:e})},Object.defineProperty(e.prototype,"length",{get:function(){return this.datas.length},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.datas&&(this.datas=[])},e.prototype.createError=function(){throw new Error("我是测试的错误信息")},e}(),Si="hashchange",ki="pushState",Ti="replaceState",xi="popstate",_i=function(){function e(){this.dispatcher=new h,this.history=new wi,this.pageWhich=1}return Object.defineProperty(e.prototype,"previousHistoryUrl",{get:function(){var e;return null===(e=this.history.latestUserData)||void 0===e?void 0:e.pageUrl},enumerable:!1,configurable:!0}),e.prototype.getPageDataByTimestamp=function(e){for(var t=this.history.length-1;t>=0;t--){var n=this.history.datas[t];if(n.userdata.relativeTime<e)return n}},e.prototype.pushHistory=function(e){this.history.push(e)},Object.defineProperty(e.prototype,"latestHistory",{get:function(){return this.history.latest},enumerable:!1,configurable:!0}),e.prototype.getPageUrlByTimestamp=function(e){var t;return null===(t=this.getPageDataByTimestamp(e))||void 0===t?void 0:t.userdata.pageUrl},e.prototype.next=function(e){return this.dispatcher.emitSync("nextpre",e),k.safelog("RouteNext",e,this.history),this.dispatcher.emitSync("next",e),e},e.prototype.initRefresh=function(){var e=performance.timing.navigationStart;this.init([0,e],!0)},e.prototype.getInitNext=function(e){this.observe();var t=e||Eo.getTimePair();return{pageUrl:window.location.href,pageWhich:this.pageWhich=1,relativeTime:t[0],clientTime:t[1],isRefresh:!1,method:"init"}},e.prototype.init=function(e,t){void 0===t&&(t=!1),this.observe();var n=e||Eo.getTimePair();this.next({pageUrl:window.location.href,pageWhich:this.pageWhich=1,relativeTime:n[0],clientTime:n[1],isRefresh:t,method:"init"})},e.prototype.observe=function(){var e=this;k.safelog("routeManager.observe"),this.disconnect(),this.jumpPagesFn=function(t,n){if(window.location.href!=e.previousHistoryUrl){var r=Eo.getTimePair();e.next({pageUrl:window.location.href,pageWhich:++e.pageWhich,relativeTime:r[0],clientTime:r[1],isRefresh:!1,method:t})}},window.addEventListener(Si,this.jumpHashPagesFn=this.jumpPagesFn.bind(this,Si),!1);var t=function(e,t){var n,r=e[t];return e.__userview_origin__&&e.__userview_origin__[t]?r:(e.__userview_origin__=a(a({},e.__userview_origin__||{}),((n={})[t]=r,n)),e[t]=function(){var e=new Event(t),n=r.apply(this,arguments);return e.arguments=arguments,window.dispatchEvent(e),n})};t(window.history,ki),t(window.history,Ti),window.addEventListener(ki,this.jumpPushStatePagesFn=this.jumpPagesFn.bind(this,ki),!1),window.addEventListener(Ti,this.jumpReplaceStatePagesFn=this.jumpPagesFn.bind(this,Ti),!1),window.addEventListener(xi,this.jumpPopStatePagesFn=this.jumpPagesFn.bind(this,xi),!1)},e.prototype.disconnect=function(){this.jumpPagesFn&&(window.removeEventListener(Si,this.jumpHashPagesFn,!1),window.removeEventListener(ki,this.jumpPushStatePagesFn,!1),window.removeEventListener(Ti,this.jumpReplaceStatePagesFn,!1),window.removeEventListener(xi,this.jumpPopStatePagesFn,!1),this.jumpPagesFn=null),this.history.reset(),this.pageWhich=1},e}(),Ii=new _i,Ci=Eo.getTime.bind(Eo),Ei=1e5,Oi=function(){function e(e){this._castId=-1,this.id=0,this._timeWaitQueue=new Map,this._isClearing=!1,this._max=Ei,this._max=e||Ei}return Object.defineProperty(e.prototype,"queueLength",{get:function(){return this.id-this._castId-1},enumerable:!1,configurable:!0}),e.prototype.add=function(e){"function"==typeof e&&(this._max<this.queueLength?this.overLimit():(this._timeWaitQueue.set(this.id,e),this.id++,this.clearQueue()))},e.prototype.clearQueue=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return this._isClearing?[2]:(this._isClearing=!0,(e=Eo.isLoadingServeTime())?[4,e]:[3,2]);case 1:t.sent(),t.label=2;case 2:for(;this.queueLength;)this.castWait();return this._isClearing=!1,[2]}}))}))},e.prototype.castWait=function(){this._castId++;var e=this._timeWaitQueue.get(this._castId);if("function"==typeof e){var t=e(Ci);this.pipe(t)}this._timeWaitQueue.delete(this._castId)},e.prototype.pipe=function(e){return e},e.prototype.overLimit=function(){},e}(),Mi=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},Ni=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},Ri=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},Di=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)},Pi=function(e,t,n){var r;return function(o){t.value>=0&&(o||n)&&(t.delta=t.value-(r||0),(t.delta||void 0===r)&&(r=t.value,e(t)))}},Ai=-1,Li=function(){return"hidden"===document.visibilityState?0:1/0},ji=function(){Ri((function(e){var t=e.timeStamp;Ai=t}),!0)},Fi=function(){return Ai<0&&(Ai=Li(),ji(),Di((function(){setTimeout((function(){Ai=Li(),ji()}),0)}))),{get firstHiddenTime(){return Ai}}},Ui=function(e,t){var n,r=Fi(),o=Mi("FCP"),i=function(e){"first-contentful-paint"===e.name&&(s&&s.disconnect(),e.startTime<r.firstHiddenTime&&(o.value=e.startTime,o.entries.push(e),n(!0)))},a=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],s=a?null:Ni("paint",i);(a||s)&&(n=Pi(e,o,t),a&&i(a),Di((function(r){o=Mi("FCP"),n=Pi(e,o,t),requestAnimationFrame((function(){requestAnimationFrame((function(){o.value=performance.now()-r.timeStamp,n(!0)}))}))})))},Bi=!1,qi=-1,Hi={passive:!0,capture:!0},zi=new Date,Vi=function(e,t){mi||(mi=t,vi=e,gi=new Date,Ki(removeEventListener),Wi())},Wi=function(){if(vi>=0&&vi<gi-zi){var e={entryType:"first-input",name:mi.type,target:mi.target,cancelable:mi.cancelable,startTime:mi.timeStamp,processingStart:mi.timeStamp+vi};yi.forEach((function(t){t(e)})),yi=[]}},$i=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){Vi(e,t),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,Hi),removeEventListener("pointercancel",r,Hi)};addEventListener("pointerup",n,Hi),addEventListener("pointercancel",r,Hi)}(t,e):Vi(t,e)}},Ki=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,$i,Hi)}))},Gi=function(){function e(){this.dispatcher=new h,this.LCP=0,this.CLS=0,this.initTime=[performance.now(),Date.now()]}return e.prototype.next=function(e){return k.safelog("PerformanceNext",e),this.dispatcher.emitSync("next",e),e},e.prototype.observe=function(){var e,t=this;void 0!==window.PerformanceObserver&&(null===(e=PerformanceObserver.supportedEntryTypes)||void 0===e?void 0:e.includes("largest-contentful-paint"))?new PerformanceObserver((function(e){var n,r;try{for(var o=c(e.getEntries()),i=o.next();!i.done;i=o.next()){var a=i.value;if(!t.LCP){t.LCP=a.startTime;var s=performance.timing,u=s.loadEventEnd,l=s.navigationStart,p=u?u-l:performance.now();t.next({name:"LCP",LCP:t.LCP,pageLoad:p,timestamp:[p,Math.floor(l+p)]})}break}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}})).observe({type:"largest-contentful-paint",buffered:!0}):window.onload=function(){var e=performance.now(),n=[e,Date.now()];t.next({name:"LCP",pageLoad:e,timestamp:n})},function(e,t){var n,r=Fi(),o=Mi("FID"),i=function(e){e.startTime<r.firstHiddenTime&&(o.value=e.processingStart-e.startTime,o.entries.push(e),n(!0))},a=Ni("first-input",i);n=Pi(e,o,t),a&&Ri((function(){a.takeRecords().map(i),a.disconnect()}),!0),a&&Di((function(){var r;o=Mi("FID"),n=Pi(e,o,t),yi=[],vi=-1,mi=null,Ki(addEventListener),r=i,yi.push(r),Wi()}))}((function(e){t.next({name:"FID",FID:e,timestamp:Eo.getTimePair()})}),!0),B((function(e){var n=e.userdata.addupValue;t.next({name:"CLS",CLS:n,timestamp:Eo.getTimePair()})}));var n=B().counter;!function(e,t){Bi||(Ui((function(e){qi=e.value})),Bi=!0);var n,r=function(t){qi>-1&&e(t)},o=Mi("CLS",0),i=0,a=[],s=function(e){if(!e.hadRecentInput){var t=a[0],r=a[a.length-1];i&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,a.push(e)):(i=e.value,a=[e]),i>o.value&&(o.value=i,o.entries=a,n())}},u=Ni("layout-shift",s);u&&(n=Pi(r,o,t),Ri((function(){u.takeRecords().map(s),n(!0)})),Di((function(){i=0,qi=-1,o=Mi("CLS",0),n=Pi(r,o,t)})))}((function(e){var t=e.delta;n((function(){return t}))}),!0)},Object.defineProperty(e.prototype,"pageLoadTime",{get:function(){var e=this;return this.pageStartTime.map((function(t){return t+e.pageLoad}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageLoad",{get:function(){var e=performance.timing,t=e.loadEventEnd,n=e.navigationStart;return t?t-n:Eo.sleepTimePerformaceNow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageStartTime",{get:function(){var e;return[Eo.startServerTime,(null===(e=null===performance||void 0===performance?void 0:performance.timing)||void 0===e?void 0:e.navigationStart)||performance.timeOrigin]},enumerable:!1,configurable:!0}),e}(),Xi=new Gi,Ji=[3e3,1e4,3e4,6e4,12e4,18e4,3e5],Qi={name:"BlankAsyncTask",run:function(){return Promise.resolve()},context:{}},Yi=function(){function e(e){this.runninglist=[],this.isRunning=!1,this.log=[],this.retryFailedTimesIndex=-1,this.queuedCount=0,this.queuedMaxLock=!1,this.name=e,this.untilFlag=null}return e.prototype.toggleLog=function(e){},e.prototype.run=function(e,t){var n=this;if(this.queuedMaxLock)return k.warn("发送机达到储存任务上限(100条)"),Promise.resolve(!0);var r={future:function(e,t,r){return s(n,void 0,void 0,(function(){var n,o,i,a,s,c,l,p=this;return u(this,(function(u){switch(u.label){case 0:o=void 0,s=function(e,t){i=!0===t.lock,k.safeerror("AsyncTaskRunner:",p.name," TaskName:",t.name," Final Error:",e),o=void 0,a=e},u.label=1;case 1:if(!(e.length>0))return[3,13];u.label=2;case 2:return u.trys.push([2,4,,12]),n=e.shift(),k.safewarn("AsyncTaskRunner:",this.name," TaskName:",n.name," start"),[4,n.run(n.context,o)];case 3:return o=u.sent(),k.safewarn("AsyncTaskRunner:",this.name," TaskName:",n.name," done"),[3,12];case 4:return c=u.sent(),-1!==this.retryFailedTimesIndex?[3,10]:(k.safeerror("AsyncTaskRunner:",this.name," TaskName:",n.name," Error:",null==c?void 0:c.message,"1s Later Retry!"),[4,this.timeoutRetry(1e3)]);case 5:u.sent(),u.label=6;case 6:return u.trys.push([6,8,,9]),k.safewarn("AsyncTaskRunner:",this.name," TaskName:",n.name," restart"),[4,n.run(n.context,o)];case 7:return o=u.sent(),k.safewarn("AsyncTaskRunner:",this.name," TaskName:",n.name," restart done"),[3,9];case 8:return l=u.sent(),s(l,n),[3,9];case 9:return[3,11];case 10:s(c,n),u.label=11;case 11:return[3,12];case 12:return i&&a?[3,13]:[3,1];case 13:return i&&a?[2,r(a)]:[2,t(o)]}}))}))}.bind(this),task:e,name:t};return k.log("AsyncTaskRunner:",this.name," BundleName:",r.name," pushed",++this.queuedCount),this.queuedCount>=100&&(this.queuedMaxLock=!0),this.tailTask?(this.tailTask.next=r,this.tailTask=this.tailTask.next):(this.tailTask=r,this.rootTask=this.tailTask,this.runningPromise=this.runninglink()),this.runningPromise},Object.defineProperty(e.prototype,"stopped",{get:function(){return this.runningPromise},enumerable:!1,configurable:!0}),e.prototype.runninglink=function(){var e=this;return this.rootTask?(k.safewarn("AsyncTaskRunner:",this.name," BundleName:",this.rootTask.name," start",this.queuedCount),new Promise((function(t,n){var r;e.rootTask.future(Array.from(null===(r=e.rootTask)||void 0===r?void 0:r.task),t,n)})).then((function(t){var n,r,o;return null===(n=e.rootTask)||void 0===n||n.task.forEach((function(e){return e.bundleDone&&e.bundleDone(t)})),k.safewarn("AsyncTaskRunner:",e.name," BundleName:",null===(r=e.rootTask)||void 0===r?void 0:r.name," done",--e.queuedCount),e.rootTask=null===(o=e.rootTask)||void 0===o?void 0:o.next,e.retryFailedTimesIndex=-1,e.runninglink()})).catch((function(t){return new Promise((function(t,n){setTimeout((function(){return s(e,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return k.safewarn("AsyncTaskRunner:",this.name,"网络重试第".concat(this.retryFailedTimesIndex+1,"次")),[4,this.runninglink()];case 1:return e.sent(),t(!0),[2]}}))}))}),Ji[e.retryFailedTimesIndex=++e.retryFailedTimesIndex%Ji.length])}))}))):(this.tailTask=void 0,Promise.resolve(!0))},e.prototype.timeoutRetry=function(e){return new Promise((function(t,n){window.setTimeout((function(){return t(!0)}),e)}))},e.prototype.pushAllRun=function(e,t){return this.run(e,t)},e.prototype.pushRun=function(e,t){return this.run([e],t)},e}();new Yi("for test");var Zi=function(){function e(e,t,n,r){this.finished=!1,this._locked=!1,this.messageBox=[],this.messageIndex=t,this.debugInfo=e.debugInfo,this.messageTaskRunner=n,this.messageStrategy=r,this.start()}return Object.defineProperty(e.prototype,"locked",{get:function(){return this._locked},set:function(e){!0===e&&this.messageStrategy&&this.messageStrategy.cancel(" lock"),this._locked=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canSend",{get:function(){return this.messageBox.length>0&&!1===this.finished&&!1===this.locked},enumerable:!1,configurable:!0}),e.prototype.start=function(){var e=this;this.messageStrategy.restart((function(t,n){e.finished=!0,!0===t?(k.safewarn("beforesend:",e.debugInfo+":"+e.messageIndex,e.messageBox,n),e.send(n)):k.safeerror("cancelsend",e.debugInfo+":"+e.messageIndex,e.messageBox,n)}),(function(t){e.finished=!0,k.safeerror("errorsend",e.debugInfo+":"+e.messageIndex,e.messageBox)}))},e.prototype.closeSend=function(e,t){return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return n=!1,this.canSend?(this.messageStrategy.cancel(e),[4,this.send(e,t)]):[3,2];case 1:n=r.sent(),r.label=2;case 2:return this.locked=!0,[2,n]}}))}))},e.prototype.safeSend=function(e){this.canSend&&(this.messageStrategy.cancel(e),this.send(e),this.finished=!0)},e.prototype.safeSendBeacon=function(e,t){var n=!1;return this.canSend?(this.messageStrategy.cancel(e),n=this.sendBeacon(t,e),this.finished=!0,"sendBeacon:".concat(this.messageIndex,"-").concat(n)):"sending:".concat(this.messageIndex)},e.prototype.push=function(e){return!!this.messageStrategy.beforePush(e)||(this.messageBox.push(e),this.messageStrategy.afterPush(e),!1)},e.prototype.lock=function(){this.locked=!0},e}(),ea="STATE_RESOLVE_TRUE",ta="STATE_REJECT",na="METHOD_INVOKED_RETURN_TRUE",ra="METHOD_ADD_EXECUTOR",oa="beforePush",ia="afterPush",aa=[oa,ia],sa=function(){function e(e,t){this.lifecycleCallings={},this.watchers=[],this.executors=[],this.option=e,this.parasite=t}return e.prototype.informOptionChange=function(e){var t=this;this.option=a(a({},this.option),e),this.executors.forEach((function(e){return e.optionChange(t.option)}))},e.prototype.addWatcher=function(e){var t=e(this);return t&&this.watchers.push(t),this},e.prototype.stateChangeWatching=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.watchers.forEach((function(n){return n.stateChange.apply(n,p([e],l(t),!1))})),!0},e.prototype.methodInvokeWatching=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.watchers.forEach((function(n){return n.methodInvoke.apply(n,p([e],l(t),!1))})),!0},e.prototype.addExecutor=function(e){var t=e(this);return t&&(this.executors.push(t),this.hasWatcher&&this.methodInvokeWatching(ra,t,"addExecutor")),this},e.prototype.register=function(){var e=this;return aa.forEach((function(t){var n=[];e.executors.forEach((function(e){var r=e.registerInvokingPriority(t);if(r>=0){var o=e[t].bind(e);n.push({priority:r,register:o,executor:e})}})),e.lifecycleCallings[t]=n.sort((function(e,t){return t.priority-e.priority}))})),this},e.prototype.removeExecutor=function(e){this.executors.indexOf(e);return-1&&(e.disconnect(this),this.executors.splice(-1,1)),this},e.prototype.start=function(e,t){var n=this;this.__resolve=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n.__resolve=void 0,n.__reject=void 0,e.apply(void 0,p([],l(t),!1)),!0},this.__reject=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n.__resolve=void 0,n.__reject=void 0,t.apply(void 0,p([],l(e),!1)),!0}},e.prototype.restart=function(e,t){return this.cancel(),this.start(e,t)},e.prototype.cancel=function(e){return this.__resolve&&this.__resolve(!1," from cancel"+(e||""))},e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.__resolve&&this.__resolve.apply(this,p([!0],l(e),!1))},e.prototype.reject=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.__reject&&this.__reject.apply(this,p([],l(e),!1))},Object.defineProperty(e.prototype,"hasWatcher",{get:function(){return this.watchers.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canResolve",{get:function(){return!!this.__resolve},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canReject",{get:function(){return!!this.__reject},enumerable:!1,configurable:!0}),e.prototype.beforePush=function(e){var t,n=this;return(null===(t=this.lifecycleCallings.beforePush)||void 0===t?void 0:t.some((function(t){var r=t.register(e);return r&&n.hasWatcher&&n.methodInvokeWatching(na,t.executor,oa),r})))||!1},e.prototype.afterPush=function(e){var t,n=this;return(null===(t=this.lifecycleCallings.afterPush)||void 0===t?void 0:t.some((function(t){var r=t.register(e);return r&&n.hasWatcher&&n.methodInvokeWatching(na,t.executor,ia),r})))||!1},e}(),ua=function(){function e(e){this.watch(e)}return e.prototype.watch=function(e){return this.strategy=e,this},e.prototype.informOptionChange=function(e){var t;null===(t=this.strategy)||void 0===t||t.informOptionChange(e)},e}(),ca=function(){function e(e){this.executor=e,this.optionCreate(this.executor.option)}return e.prototype.executorCancel=function(e,t){this.executor.cancel(t)&&this.executor.hasWatcher&&this.executor.stateChangeWatching("STATE_CANCEL_RESOLVE_FALSE",e)},e.prototype.executorResolve=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(t=this.executor).resolve.apply(t,p([],l(n),!1))&&this.executor.hasWatcher&&this.executor.stateChangeWatching(ea,e)},e.prototype.executorReject=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(t=this.executor).reject.apply(t,p([],l(n),!1))&&this.executor.hasWatcher&&this.executor.stateChangeWatching(ta,e)},e}(),la=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.optionChange=function(e){},Object.defineProperty(t.prototype,"parasite",{get:function(){return this.executor.parasite},enumerable:!1,configurable:!0}),t.prototype.optionCreate=function(e){var t=this;this.initSetWithin1SecondForceSendCallBack((function(){t.executorResolve(t,"前1s强制发送")}))},t.prototype.initSetWithin1SecondForceSendCallBack=function(e){var t=this;this.parasite.within_1second_forcesent||(this.parasite.within_1second_forcesend_timer||(this.parasite.within_1second_forcesend_timer=window.setTimeout((function(){t.parasite.within_1second_forcesend_cb&&t.parasite.within_1second_forcesend_cb()&&(t.parasite.within_1second_forcesent=!0)}),1e3)),this.parasite.within_1second_forcesend_cb=e)},t.prototype.registerInvokingPriority=function(e){return-1},t.prototype.beforePush=function(e){throw new Error("Method not implemented.")},t.prototype.afterPush=function(e){throw new Error("Method not implemented.")},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca),pa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.counting=0,t}return i(t,e),t.prototype.optionChange=function(e){this.maxCount=e.maxCount,this.maxCountDisabled=!!e.maxCountDisabled},t.prototype.optionCreate=function(e){this.optionChange(e)},t.prototype.registerInvokingPriority=function(e){return"afterPush"===e?100:-1},t.prototype.beforePush=function(e){throw new Error("Method not implemented.")},t.prototype.afterPush=function(e){return++this.counting,!this.maxCountDisabled&&this.counting>=this.maxCount&&(this.executorResolve(this,"满足数量发送(".concat(this.maxCount,")")),!0)},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca),da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"parasite",{get:function(){return this.executor.parasite},enumerable:!1,configurable:!0}),t.prototype.optionChange=function(e){},t.prototype.optionCreate=function(e){var t=this;this.parasite.useractive_time_mark||(this.parasite.useractive_time_mark=Eo.sleepTimePerformaceNow),this.setUserActiveThrottleForceSendCallBack((function(e){t.executorResolve(t,"活跃防抖发送(".concat(e,"ms)"))}))},t.prototype.resetUserActiveTimer=function(){var e=this;window.clearTimeout(this.parasite.useractive_event_throttle_forcesend_timer);var t=Eo.sleepTimePerformaceNow-this.parasite.useractive_time_mark>4e3?2e3:500;this.parasite.useractive_event_throttle_forcesend_timer=window.setTimeout((function(){e.parasite.useractive_event_throttle_forcesend_cb&&e.parasite.useractive_event_throttle_forcesend_cb(t)}),t)},t.prototype.setUserActiveThrottleForceSendCallBack=function(e){this.parasite.useractive_event_throttle_forcesend_cb=e},t.prototype.registerInvokingPriority=function(e){return"afterPush"===e?1:-1},t.prototype.beforePush=function(e){throw new Error("Method not implemented.")},t.prototype.afterPush=function(e){return e.userActive&&this.resetUserActiveTimer(),!1},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca),ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.optionChange=function(e){this.delay=e.maxTime},Object.defineProperty(t.prototype,"parasite",{get:function(){return this.executor.parasite},enumerable:!1,configurable:!0}),t.prototype.resetDelaySendTimer=function(){var e=this;window.clearTimeout(this.parasite.delay_forcesend_timer),this.parasite.delay_forcesend_timer=window.setTimeout((function(){e.parasite.delay_forcesend_cb&&e.parasite.delay_forcesend_cb()}),this.delay)},t.prototype.setDelayForceSendCallBack=function(e){this.parasite.delay_forcesend_cb=e},t.prototype.optionCreate=function(e){var t=this;this.optionChange(e),this.setDelayForceSendCallBack((function(){return t.executorResolve(t,"满足时间发送")}))},t.prototype.registerInvokingPriority=function(e){return"afterPush"===e?0:-1},t.prototype.beforePush=function(e){throw new Error("Method not implemented.")},t.prototype.afterPush=function(e){return this.resetDelaySendTimer(),!1},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca);function fa(e){if(e[0].type)return e.some((function(e){return e.type===Vn.FullSnapshot}))?3:2}function ma(e){var t,n,r,o,i=e.filter((function(e){return e.userActive}));return{rangeType:fa(e),activity:i.length>0,currentLength:e.length,rangeStartTime:null!==(n=null===(t=e[0])||void 0===t?void 0:t.timestamp)&&void 0!==n?n:0,rangeEndTime:null!==(o=null===(r=e[e.length-1])||void 0===r?void 0:r.timestamp)&&void 0!==o?o:0}}function va(e){var t=[];if(e.filter((function(e){return e.sentCallBack})).forEach((function(e){var n=e.sentCallBack;delete e.sentCallBack,t.push({callback:n,item:e})})),t.length>0)return function(){t.forEach((function(e){return(0,e.callback)(e.item)}))}}var ga=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.counting=0,t.inactive=!0,t}return i(t,e),t.prototype.optionChange=function(e){this.inactiveMaxCount=e.inactiveMaxCount||500,this.activeMaxCount=e.maxCount},Object.defineProperty(t.prototype,"inactiveCounting",{get:function(){return this.counting>=this.activeMaxCount&&this.inactive},enumerable:!1,configurable:!0}),t.prototype.afterPush=function(e){return++this.counting,this.inactiveCounting?(this.executor.informOptionChange({maxCountDisabled:!0}),this.afterInactivePush(e)):(this.inactive&&e.userActive&&(this.inactive=!1),!1)},t.prototype.afterInactivePush=function(e){return this.counting>=this.inactiveMaxCount&&(this.executorResolve(this,"满足不活跃数量(".concat(this.inactiveMaxCount,")发送")),!0)},t.prototype.optionCreate=function(e){this.optionChange(e)},t.prototype.registerInvokingPriority=function(e){return 1e3},t.prototype.beforePush=function(e){return!(!this.inactiveCounting||!e.userActive)&&(this.executorResolve(this,"不活跃包活跃前踢发送"),!0)},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca),ya=function(e){function t(t){var n=e.call(this,t)||this;return n.initMaxCount=n.nextMaxCount=n.strategy.option.maxCount,n.inactiveMaxCount=n.strategy.option.inactiveMaxCount||500,n}return i(t,e),t.prototype.methodInvoke=function(e,t){if(e===ra&&t instanceof pa)return window.clearTimeout(this.timerFlag),void this.informOptionChange({maxCount:this.nextMaxCount})},t.prototype.stateChange=function(e,t){var n=this;if(e===ea&&t instanceof pa)return this.nextMaxCount+this.initMaxCount<=this.inactiveMaxCount&&(this.nextMaxCount+=this.initMaxCount),void(this.timerFlag=window.setTimeout((function(){n.nextMaxCount=n.initMaxCount}),2e3));this.nextMaxCount=this.initMaxCount},t}(ua),ba=function(e){function t(t,n,r,o){return e.call(this,a(a({},t),{index:n}),n,r,new sa(a(a({},t),{index:n}),o).addWatcher((function(e){var t;return(null===(t=o.watcher)||void 0===t?void 0:t.watch(e))||(o.watcher=new ya(e))})).addExecutor((function(e){return new da(e)})).addExecutor((function(e){return new la(e)})).addExecutor((function(e){return new pa(e)})).addExecutor((function(e){return new ha(e)})).register())||this}return i(t,e),t.prototype.buildSendingOption=function(e){var t={deviceId:Se.shareInstance().deviceId,streamId:S.shareInstance().streamId,projectKey:Se.shareInstance().projectKey,sdkVersion:O,sdkType:"WEB",deviceType:R(),browser:D(),screenWidth:window.innerWidth,screenHeight:window.innerHeight,operatingSystem:P().name,eventData:this.messageBox,index:this.messageIndex,debugInfo:this.debugInfo+(e||"")};return{url:process.env.HOST+No.ReportEvents,body:t}},t.prototype.sendBeacon=function(e,t){var n=e||this.buildSendingOption(t),r=n.url,o=n.body,i=new Blob([JSON.stringify(o)],{type:"application/json"});return navigator.sendBeacon(r+"?index=".concat(this.messageIndex,"&length=").concat(this.messageBox.length,"&sid=").concat(S.shareInstance().streamId,"&pid=").concat(pr),i)},t.prototype.send=function(e,t){return s(this,void 0,Promise,(function(){var n,r,o,i=this;return u(this,(function(a){return n=this.buildSendingOption(e),r=n.body,o=n.url,t?[2,Promise.resolve(this.sendBeacon({body:r,url:o},e))]:[2,this.messageTaskRunner.pushRun({lock:!0,run:function(e){return s(i,void 0,void 0,(function(){var t=this;return u(this,(function(n){return[2,wr(o,e,{query:{index:String(this.messageIndex),length:String(this.messageBox.length)}}).then((function(n){if(null===n)throw Error("Inner Handled Error");return n&&0!=n.errNo&&(hr({name:t.debugInfo,index:String(t.messageIndex),errno:n.errNo,errstr:n.errStr}),Do.emitCustomEvent("EVENT_LOG_ERR",{body:e,res:n})),n}))]}))}))},bundleDone:va(this.messageBox),name:"event_".concat(this.messageIndex,".task"),context:r},"event_".concat(this.messageIndex,".bundle"))]}))}))},t}(Zi),wa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.empty=!0,t}return i(t,e),t.prototype.optionChange=function(e){},t.prototype.optionCreate=function(e){},t.prototype.registerInvokingPriority=function(e){return 1100},t.prototype.isFullSnapshot=function(e){return e.type===Vn.FullSnapshot},t.prototype.beforePush=function(e){return!(!this.isFullSnapshot(e)||this.empty)&&(this.executorResolve(this,"全量前踢发送"),!0)},t.prototype.afterPush=function(e){return this.empty=!1,!!this.isFullSnapshot(e)&&(this.executorResolve(this,"全量独立发送"),!0)},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca),Sa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.optionCreate=function(e){},t.prototype.optionChange=function(e){},t.prototype.beforePush=function(e){var t=e.sessionId;if(!this.firstSessionId&&t)this.firstSessionId=t;else if(this.firstSessionId&&t&&this.firstSessionId!=t)return this.executorResolve(this,"会话分包发送"),!0;return!1},t.prototype.registerInvokingPriority=function(e){return"beforePush"===e?1100:-1},t.prototype.afterPush=function(e){throw new Error("Method not implemented.")},t.prototype.disconnect=function(e){throw new Error("Method not implemented.")},t}(ca),ka=function(e){function t(t,n,r,o){return e.call(this,t,n,r,o)||this}return i(t,e),t.prototype.checkOssExpireLegal=function(e){return e&&1e3*e.expire>Eo.getTime()},t.prototype.sendByOSSAddress=function(e,t,n){return s(this,void 0,void 0,(function(){var r,o,i,a;return u(this,(function(s){switch(s.label){case 0:return k.log("ossTokenInfo",this.getOssTokenInfoType(),n),this.checkOssExpireLegal(n)?(r="".concat(n.dir).concat(this.rangeIndex(),".json"),o={key:r,policy:n.policy,OSSAccessKeyId:n.accessKeyId,success_action_status:"200",signature:n.signature,"x-oss-meta-rangeIndex":e.rangeIndex,"x-oss-meta-currentLength":e.currentLength,"x-oss-meta-rangeLength":e.rangeLength,"x-oss-meta-rangeType":e.rangeType,"x-oss-meta-startTime":e.rangeStartTime,"x-oss-meta-endTime":e.rangeEndTime,file:new Blob([t],{type:"text/plain"})},i=function(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return t},[4,mr(n.host,{method:"post",body:i(o)})]):[3,2];case 1:if(a=s.sent()){if(200===a.status)return[2,r];hr({name:this.debugInfo,index:String(this.messageIndex),errno:a.status,errstr:"osserr_".concat(a.statusText)})}else hr({name:this.debugInfo,index:String(this.messageIndex),errstr:"osserr_no_response"});s.label=2;case 2:return[2]}}))}))},t.prototype.sendBeacon=function(e,t){var n=e||this.buildSendingOption(t),r=n.url,o=n.body,i=process.env.HOST+r,a=new Blob([JSON.stringify(o)],{type:"application/json"});return navigator.sendBeacon(i+"?index=".concat(this.messageIndex,"&length=").concat(this.messageBox.length,"&sid=").concat(S.shareInstance().streamId,"&pid=").concat(pr),a)},t.prototype.sendRange=function(e,t,n){return void 0===n&&(n={extra:{},useOssFlag:!0}),s(this,void 0,void 0,(function(){var r,o,i,s,c,l,p,d,h,f=this;return u(this,(function(u){return r=n.extra,o=void 0===r?{}:r,i=n.useOssFlag,s=void 0===i||i,c=n.tag,l=ma(t),p=this.fileDataString(),d=Fo.oss[this.getOssTokenInfoType()],h=this.checkOssExpireLegal(null==d?void 0:d.data)&&d.data,k.log("ossTokenInfo before send range",this.getOssTokenInfoType(),h),[2,this.messageTaskRunner.pushAllRun([s&&!h?{run:function(){var e=Fo.oss[f.getOssTokenInfoType()];return f.checkOssExpireLegal(null==e?void 0:e.data)?Promise.resolve(e):Fo.ossPromise[f.getOssTokenInfoType()]?Fo.ossPromise[f.getOssTokenInfoType()]:Fo.getOSSConfigPromise(f.getOssTokenInfoType())},name:"rangeosstoken_".concat(this.getOssTokenInfoType(),"_").concat(this.messageIndex,".task"),context:{}}:Qi,s?{run:function(e,t){var n=e.rangeInfo,r=e.fileData,o=e.ossTokenInfo,i=(null==t?void 0:t.data)||o;return i?f.sendByOSSAddress(n,r,i):Promise.resolve()},name:"rangeoss_".concat(this.getOssTokenInfoType(),"_").concat(this.messageIndex,".task"),context:{rangeInfo:l,fileData:p,ossTokenInfo:h}}:Qi,{lock:!0,run:function(t,n){return n=n||"",wr(process.env.HOST+e,t=f.mapBody(a(a({},t),{debugInfo:f.debugInfo+(c||""),ossAddress:n,fileData:n?"":p})),{query:{index:String(f.messageIndex),length:String(l.currentLength)}}).then((function(e){if(null===e)throw Error("Inner Handled Error");return e&&0!=e.errNo&&(hr({name:f.debugInfo,index:String(f.messageIndex),errno:e.errNo,errstr:e.errStr}),Do.emitCustomEvent("RANGE_LOG_ERR",{body:t,res:e})),e}))},bundleDone:va(this.messageBox),name:"range_".concat(this.getOssTokenInfoType(),"_").concat(this.messageIndex,".task"),context:a(a({},this.buildBaseRangeBody(l,p)),o)}],"".concat(this.getOssTokenInfoType(),"_").concat(this.messageIndex,".bundle"))]}))}))},t.prototype.buildBaseRangeBody=function(e,t){return a(a({sessionId:this.messageBox[0].sessionId,streamId:S.shareInstance().streamId,projectKey:Se.shareInstance().projectKey,sdkVersion:O,sdkType:"WEB",fileData:t||this.fileDataString(),ossAddress:""},e||ma(this.messageBox)),{index:this.messageIndex})},t}(Zi),Ta=function(e){function t(t,n,r,o){return e.call(this,a(a({},t),{index:n}),n,r,new sa(a(a({},t),{index:n}),o).addWatcher((function(e){var t;return(null===(t=o.watcher)||void 0===t?void 0:t.watch(e))||(o.watcher=new ya(e))})).addExecutor((function(e){return new Sa(e)})).addExecutor((function(e){return new wa(e)})).addExecutor((function(e){return new ga(e)})).addExecutor((function(e){return new da(e)})).addExecutor((function(e){return new la(e)})).addExecutor((function(e){return new pa(e)})).addExecutor((function(e){return new ha(e)})).register())||this}return i(t,e),t.prototype.getOssTokenInfoType=function(){return Lo},t.prototype.fileDataString=function(){var e=this.messageBox.map((function(e){return t=(n=e).type===jn.Custom?n:Hn[n.type].flatJson(n),JSON.stringify(t,(function(e,t){return void 0===t?0:t}));var t,n})).join(",");return""!=e?e+",":""},t.prototype.rangeIndex=function(){return this.messageIndex},t.prototype.mapBody=function(e){return e},t.prototype.buildSendingOption=function(e){return{url:No.ReportPlayRange,body:a(a({},this.mapBody(this.buildBaseRangeBody())),{preIndex:this.messageIndex-1>0?this.messageIndex-1:void 0,debugInfo:this.debugInfo+(e||"")})}},t.prototype.send=function(e,t){return s(this,void 0,Promise,(function(){return u(this,(function(n){return t?[2,Promise.resolve(this.sendBeacon(this.buildSendingOption(e)))]:[2,this.sendRange(No.ReportPlayRange,this.messageBox,{extra:{preIndex:this.messageIndex-1>0?this.messageIndex-1:void 0,nextIndex:this.messageIndex+1},tag:e})]}))}))},t}(ka),xa=function(e){function t(t,n,r,o){return e.call(this,a(a({},t),{index:n}),n,r,new sa(a(a({},t),{index:n}),o).addWatcher((function(e){var t;return(null===(t=o.watcher)||void 0===t?void 0:t.watch(e))||(o.watcher=new ya(e))})).addExecutor((function(e){return new Sa(e)})).addExecutor((function(e){return new la(e)})).addExecutor((function(e){return new pa(e)})).addExecutor((function(e){return new ha(e)})).register())||this}return i(t,e),t.prototype.getOssTokenInfoType=function(){return Ao},t.prototype.fileDataString=function(){var e=this.messageBox.map((function(e){return JSON.stringify(e)})).join(",");return""!=e?e+",":""},t.prototype.rangeIndex=function(){return this.messageIndex},t.prototype.mapBody=function(e){var t=e.projectKey;return a(a({},e),{projectKey:void 0,projectId:t})},t.prototype.buildSendingOption=function(e){return{url:No.ReportDevRange,body:a(a({},this.mapBody(this.buildBaseRangeBody())),{debugInfo:this.debugInfo+(e||"")})}},t.prototype.send=function(e,t){return s(this,void 0,Promise,(function(){return u(this,(function(n){return t?[2,Promise.resolve(this.sendBeacon(this.buildSendingOption(e)))]:[2,this.sendRange(No.ReportDevRange,this.messageBox,{tag:e})]}))}))},t}(ka),_a=function(){function e(){this.eventParasite={},this.eventPackageIndex=0,this.eventTaskRunner=new Yi("event"),this.playRangeParasite={},this.playRangePackageIndex=0,this.playRangeTaskRunner=new Yi("playrange"),this.devRangeParasite={},this.devRangePackageIndex=0,this.devRangeTaskRunner=new Yi("devrange"),this.init()}return Object.defineProperty(e.prototype,"rangeOption",{get:function(){return a(a({},this.option),{split_session:!0})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"option",{get:function(){return{maxCount:20,maxTime:2e4}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var e=this;document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.clear(" from clear")}))},e.prototype.pushMessages=function(e){var t=this;e.forEach((function(e){return t.pushMessage(e)}))},e.prototype.pushMessage=function(e){"network"===e.tag||"Log"===e.tag?this.pushDevRange(e):e.type?this.pushPlayRange(e):e.eventTypeId&&this.pushEvent(e)},e.prototype.close=function(e){void 0===e&&(e=" from stream close"),k.warn("stream close result:",this.eventPackage.safeSendBeacon(e),this.playRangePackage.safeSendBeacon(e),this.devRangePackage.safeSendBeacon(e))},e.prototype.closeAsync=function(e){var t,n,r;return void 0===e&&(e=" from stream close"),Promise.allSettled([null===(t=this.playRangePackage)||void 0===t?void 0:t.closeSend(e),null===(n=this.eventPackage)||void 0===n?void 0:n.closeSend(e),null===(r=this.devRangePackage)||void 0===r?void 0:r.closeSend(e)])},e.prototype.pushDevRange=function(e){this.devRangePackage&&(!0!==this.devRangePackage.finished||this.devRangePackage.locked)||(this.devRangePackage=new xa(a(a({},this.rangeOption),{maxTime:2e3,debugInfo:"devrange"}),++this.devRangePackageIndex,this.devRangeTaskRunner,this.devRangeParasite)),!this.devRangePackage.locked&&this.devRangePackage.push(e)&&(this.devRangePackage=new xa(a(a({},this.rangeOption),{maxTime:2e3,debugInfo:"devrange"}),++this.devRangePackageIndex,this.devRangeTaskRunner,this.devRangeParasite),this.devRangePackage.push(e))},e.prototype.pushPlayRange=function(e){this.playRangePackage&&(!0!==this.playRangePackage.finished||this.playRangePackage.locked)||(this.playRangePackage=new Ta(a(a({},this.rangeOption),{debugInfo:"playrange"}),++this.playRangePackageIndex,this.playRangeTaskRunner,this.playRangeParasite)),!this.playRangePackage.locked&&this.playRangePackage.push(e)&&(this.playRangePackage=new Ta(a(a({},this.rangeOption),{debugInfo:"playrange"}),++this.playRangePackageIndex,this.playRangeTaskRunner,this.playRangeParasite),this.playRangePackage.push(e))},e.prototype.pushEvent=function(e){this.eventPackage&&(!0!==this.eventPackage.finished||this.eventPackage.locked)||(this.eventPackage=new ba(a(a({},this.option),{debugInfo:"event"}),++this.eventPackageIndex,this.eventTaskRunner,this.eventParasite)),!this.eventPackage.locked&&this.eventPackage.push(e)&&(this.eventPackage=new ba(a(a({},this.option),{debugInfo:"event"}),++this.eventPackageIndex,this.eventTaskRunner,this.eventParasite),this.eventPackage.push(e))},e.prototype.clear=function(e){var t,n,r;null===(t=this.eventPackage)||void 0===t||t.safeSend(e),null===(n=this.playRangePackage)||void 0===n||n.safeSend(e),null===(r=this.devRangePackage)||void 0===r||r.safeSend(e)},e.prototype.lock=function(){var e,t,n;null===(e=this.eventPackage)||void 0===e||e.lock(),null===(t=this.playRangePackage)||void 0===t||t.lock(),null===(n=this.devRangePackage)||void 0===n||n.lock()},e.prototype.waitUntilRunningStopped=function(){return s(this,void 0,void 0,(function(){var e,t,n;return u(this,(function(r){switch(r.label){case 0:return[4,this.playRangeTaskRunner.stopped];case 1:return e=r.sent(),[4,this.eventTaskRunner.stopped];case 2:return t=r.sent(),[4,this.devRangeTaskRunner.stopped];case 3:return n=r.sent(),[2,e&&t&&n]}}))}))},e}(),Ia=new _a;function Ca(){var e=Qo.queue?{consoleInfos:Qo.queue.newlyInfos.length,consoleErrors:Qo.queue.newlyErrors.length,consoleWarnings:Qo.queue.newlyWarnings.length}:{consoleInfos:0,consoleErrors:0,consoleWarnings:0},t=a({title:document.title,url:location.href,uri:location.origin+location.pathname,urlPath:location.pathname,urlHost:location.host,referrer:document.referrer,deviceType:R(),browser:D(),operatingSystem:P().name,viewportWidth:window.$d("innerWidth"),viewportHeight:window.$d("innerHeight"),displayWidth:window.$d("screen.width"),displayHeight:window.$d("screen.height"),userAgent:navigator.userAgent,pageWhich:Ii.pageWhich},e);return Qo.queue.markAllAsHistory(),t}var Ea={data:{},reset:function(){return Ea.clear(),Ea.init(),Ea},clear:function(){return Ea.data={}},init:function(){Ea.data.$viewport_width_pre=window.$d("innerWidth"),Ea.data.$viewport_height_pre=window.$d("innerHeight")}},Oa=Ea.reset().data,Ma=Ea;function Na(e){var t,n,r,o=e.relativeTime,i=e.clientTime,a=e.isRefresh,s=e.method,u="init"===s;return{tag:"pagechange",eventTypeId:1,eventAttr:{isRefresh:a,method:s},serverTime:o,clientTime:i,isCreateSession:u,userInfo:u?{uid:Uo.shareInstance().uid,username:(null===(t=Uo.shareInstance().info)||void 0===t?void 0:t.name)||"",email:(null===(n=Uo.shareInstance().info)||void 0===n?void 0:n.email)||"",phone:(null===(r=Uo.shareInstance().info)||void 0===r?void 0:r.phone)||""}:void 0,userActive:!0,publicAttr:Ca()}}var Ra=["Scroll","pagechange","SessionClose","StreamClose"],Da=function(){function e(){}return e.prototype.trackEvent=function(e){var t=null;if(this.checkViewChange(e)){if(this.nextData){var n=this.getCreateEventTimes(e);t=this.createEvent(n.serverTime,n.clientTime)}this.monitorWaitCreate(e.serverTime,e.clientTime)}return this.lastServerActiveTime=e.serverTime,this.lastClientActiveTime=e.clientTime,t},e.prototype.checkViewChange=function(e){return Ra.some((function(t){return e.tag===t}))},e.prototype.getCreateEventTimes=function(e){return"SessionClose"===e.tag||"StreamClose"===e.tag?{serverTime:this.lastServerActiveTime,clientTime:this.lastClientActiveTime}:{serverTime:e.serverTime,clientTime:e.clientTime}},e.prototype.monitorWaitCreate=function(e,t){this.nextData={publiccommons:this.getCommonCoverValues(),serverStarttime:e,clientStarttime:t}},e.prototype.createEvent=function(e,t){var n,r=e-(null===(n=this.nextData)||void 0===n?void 0:n.serverStarttime);return r<4e3?null:function(e){var t=e.serverTime,n=e.clientTime,r=e.serverStaytime,o=e.publiccommons,i=document.body.scrollHeight;return{tag:"webviewportstay",eventTypeId:4,eventAttr:{pageLength:i,viewportPosition:window.scrollY,viewportPositionPercentage:0===i?0:100*window.scrollY/i,stayTime:r},serverTime:t,clientTime:n,userActive:!0,publicAttr:a(a({},Ca()),o)}}(a(a({},this.nextData),{serverTime:e,clientTime:t,clientStaytime:t-this.nextData.clientStarttime,serverStaytime:r}))},e.prototype.getCommonCoverValues=function(){return{title:document.title,url:location.href,urlPath:location.pathname,urlHost:location.host,referrer:document.referrer}},e}(),Pa=new Da;function Aa(e){return a(a({},e),{sessionId:Ne.shareInstance().sessionId,uid:Uo.shareInstance().uid})}function La(e){return a(a({},e),{sessionId:Ne.shareInstance().sessionId})}function ja(e){var t;return e.seq=t?t.__id_generater=(t.__id_generater||0)+1:++U,e}var Fa=new Oi,Ua=Fa,Ba=Ho(Do,"emit"),qa=Ho(Ii,"next"),Ha=Ho(Xi,"next"),za={pipe:function(e){return e}},Va=Ho(za),Wa=Ho(Uo.shareInstance(),"identify"),$a=function(){Va.start(),Ba.start(),qa.start(),Ha.start(),Wa.start()},Ka=function(){Ba.stop(),qa.stop(),Ha.stop(),Wa.stop()},Ga=Ho(Fa,"overLimit");Ga.next((function(){Ka()})).next((function(){Ga.stop(),hr({eventTimeListOver:Fa.queueLength})})),Ba.next((function(e){return function(e){if(e.data.source===Wn.MouseInteraction){var t=e.data;Object.keys(Kn).some((function(e){return e==t.type}))&&(e.tag=Kn[t.type])}else{var n=e.data;Object.keys(Wn).some((function(e){return e==n.source}))&&(e.tag=Wn[n.source])}return e}(e)})).next((function(e){return 3===(t=e).type&&(t.data.source!==Wn.MouseMove&&t.data.source!==Wn.MouseInteraction&&t.data.source!==Wn.Scroll&&t.data.source!==Wn.ViewportResize&&t.data.source!==Wn.Input&&t.data.source!==Wn.TouchMove||(t.userActive=!0)),t;var t})).next((function(e){return e})).next((function(e,t){var n=function(e){if(e.data.source==Wn.ViewportResize){var t=window.$d("innerWidth"),n=window.$d("innerHeight"),r=Math.floor(e.data.width*window.devicePixelRatio),o=Math.floor(e.data.height*window.devicePixelRatio);Oa.$viewport_width_pre=Oa.$viewport_width_pre||t,Oa.$viewport_height_pre=Oa.$viewport_height_pre||n;var i=r/Oa.$viewport_width_pre-1,a=o/Oa.$viewport_height_pre-1,s=i.toFixed(2),u=a.toFixed(2);if(s||u){var c={viewportWidthPre:Oa.$viewport_width_pre,viewportWidthPost:r,viewportHeightPre:Oa.$viewport_height_pre,viewportHeightPost:o,viewportWidthChangeRate:Number(u),viewportHeightChangeRate:Number(u)};if(c&&(c.viewportWidthPost!=c.viewportWidthPre||c.viewportHeightPost!=c.viewportHeightPre)){Oa.$viewport_width_pre=r,Oa.$viewport_height_pre=o;var l=e.timestamp,p=e.clienttime;return{eventTypeId:6,tag:"ViewportResize",eventAttr:c,publicAttr:Ca(),userActive:!0,serverTime:l,clientTime:p}}}}}(e)||function(e){if("Click"===e.tag){var t=Mo.getNode(e.data.id);if(t){var n=e.timestamp,r=e.clienttime,o={elementId:t.id,elementIndex:function(){if(t.parentNode)for(var e=t.parentNode.childNodes,n=0;n<=e.length;n++)if(e[n]===t)return"".concat(n+1);return"1"}(),elementText:function(){if(function(e,t){for(var n=e.parentNode;n&&n.ELEMENT_NODE===n.nodeType;){if(n.matches(t))return n;n=n.parentNode}return!1}(t,"a"))return qt.textMask(t,t.innerText);if("INPUT"==t.tagName)return qt.textMask(t,t.value);if("BUTTON"==t.tagName)return qt.textMask(t,t.innerText);if("TEXTAREA"==t.tagName)return qt.textMask(t,t.value);if("SELECT"==t.tagName)return qt.textMask(t,t.value);if(t.nodeType===t.ELEMENT_NODE){var e=p([],l(t.childNodes),!1).reduce((function(e,t){var n;return t?(t.nodeType===t.TEXT_NODE&&(e+=(null===(n=t.textContent)||void 0===n?void 0:n.trim())||""),e):e}),"");return qt.textMask(t.firstChild,e)}}(),cssSelector:ln(t).source,elementTargetUrl:t.href instanceof SVGAnimatedString?t.href.baseVal:"string"==typeof t.href?t.href:"",elementType:t.tagName,elementName:t.name,elementClassName:t.className instanceof SVGAnimatedString?t.className.baseVal:"string"==typeof t.className?t.className:""};return{eventTypeId:2,tag:"Click",userActive:!0,eventAttr:o,publicAttr:Ca(),serverTime:n,clientTime:r}}}}(e)||function(e){var t,n;if("Blur"===e.tag){var r=e.data.id,o=Mo.getNode(r);if(o){var i=Ii.latestHistory||{},a=i.prevInput,s=i.prevFocus,u=null==s?void 0:s.data.id,c=null==a?void 0:a.data.text,l=void 0;if(a&&(!u||u===r)&&c&&-1!=["INPUT","TEXTAREA"].indexOf(o.tagName)&&-1==["radio","checkbox"].indexOf(o.type)){var p=e.timestamp,d=e.clienttime,h={cssSelector:ln(o).source,textInput:(n=o.value||c,Dr.logConfig.singlePropMaxLength<((null==n?void 0:n.length)||0)&&(n=n.substring(0,Dr.logConfig.singlePropMaxLength)),qt.textMask(o,n)),textInputTime:function(){var e=Ii.latestHistory||{},t=e.userdata,n=e.prevFocus,r=e.prevInputStart,o=Eo.getTime(p);return n?o-n.timestamp:r?o-r.timestamp:p-t.relativeTime+Eo.sleepTime}()};l={eventTypeId:5,tag:"Input",eventAttr:h,publicAttr:Ca(),userActive:!0,serverTime:p,clientTime:d}}if((f=Ii.latestHistory)&&(f.prevInputStart=null,f.prevFocus=null,f.prevInput=null),l)return l}}else if("Input"===e.tag||"Focus"===e.tag){var f;r=e.data.id,(f=Ii.latestHistory)&&("Focus"===e.tag?(f.prevFocus=e,f.prevInputStart=null,f.prevInput=null):"Input"===e.tag&&(f.prevInputStart?(null===(t=f.prevInputStart)||void 0===t?void 0:t.data.id)===r&&(f.prevInput=e):(f.prevInputStart=e,f.prevInput=e)))}}(e)||function(e){if(e.userActive)return{eventTypeId:25,tag:e.tag,serverTime:e.timestamp,clientTime:e.clienttime,userActive:!0}}(e);return n||t})).next((function(e){Fa.add((function(t){e.serverTime=t(e.serverTime),za.pipe(e)}))})),qa.next((function(e){return Ii.pushHistory(e),e})).next((function(e){return Na(e)})).next((function(e){Fa.add((function(t){e.serverTime=t(e.serverTime),za.pipe(e)}))})),Ha.next((function(e,t){var n;switch(e.name){case"LCP":return(null===(n=Ii.latestHistory)||void 0===n?void 0:n.userdata.isRefresh)?function(e){var t=e.LCP,n=e.pageLoad,r=e.timestamp;return{tag:"pageload",eventTypeId:7,eventAttr:{largestContentfulPaint:t,pageLoad:n,loadingPerformance:void 0===t?"":t<=2500?"良好":t>2500&&t<4e3?"一般":t>=4e3?"较差":""},publicAttr:Ca(),serverTime:r[0],clientTime:r[1],userActive:!0}}(e):t;case"FID":return function(e){var t=e.FID,n=e.timestamp;return{tag:"firstinteractionresponsiveness",eventTypeId:9,eventAttr:{firstInputDelay:t.value,firstInteractionAction:t.entries[0].name,firstInteractionPerformance:t.value<=100?"良好":t.value>100&&t.value<300?"一般":t.value>=300?"较差":""},publicAttr:Ca(),serverTime:n[0],clientTime:n[1],userActive:!0}}(e);default:return function(e){var t,n=e.CLS,r=e.timestamp;return{tag:"layoutshift",eventTypeId:8,eventAttr:{cumulativeLayoutShift:n,visualStability:(t="",n<=.1?t="良好":n>.1&&n<.25?t="一般":n>=.25&&(t="较差"),t)},serverTime:r[0],clientTime:r[1],publicAttr:Ca(),userActive:!0}}(e)}})).next((function(e){Fa.add((function(t){e.serverTime=t(e.serverTime),za.pipe(e)}))})),Wa.next((function(e){Fa.add((function(t){var n,r,o=(n=e.status===Po.loginSwitch&&e.data,{eventTypeId:27,tag:"UserInfo",serverTime:(r=Eo.getTimePair())[0],clientTime:r[1],split:n});o.serverTime=t(o.serverTime),za.pipe(o)}))})),Va.next((function(e){return e})).next((function(e){var t=[],n=e.serverTime,r=e.clientTime,o="UserInfo"===e.tag,i=o&&!!e.split,s=Ne.shareInstance().trackEvent({name:e.tag||"",time:n,active:e.userActive});if(i||s.needSplit&&!s.isFrequentInvoke){var u=function(e){var t=l(e,2),n=t[0],r=t[1];return Eo.getTimePair(),{tag:"SessionClose",ignoreTrack:!0,eventTypeId:28,serverTime:n,clientTime:r,eventAttr:{},sessionId:Ne.shareInstance().sessionId,uid:Uo.shareInstance().uid}}([n,r]);if(u.eventAttr.from=s.from,f(u),t.push(u),Ne.shareInstance().updateSession(n),i){var c=Se.shareInstance();c.resetDeviceId(c.prefab.get("device_id")),c.prefab.drop("device_id");var p=Uo.shareInstance(),d=p.prefab.has("uid")?p.prefab.get("uid"):e.split.uid;p.storeUser(d,e.split.info),c.prefab.drop("uid"),delete e.split}Ma.reset();var h=Ii.getInitNext([n,r]);Ii.pushHistory(h),t.push(Aa(Na(h)))}else f(e);return o?(delete e.split,t.push(Aa(function(e){return a(a({},e),{userInfo:{uid:Uo.shareInstance().uid,username:Uo.shareInstance().info.name,email:Uo.shareInstance().info.email,phone:Uo.shareInstance().info.phone}})}(e)))):t.push(Aa(e)),t;function f(e){var n=Pa.trackEvent(e);n&&t.push(Aa(n))}})).next((function(e){return e.forEach((function(e){return e.eventTypeId<=25&&ja(e)})),e})).next((function(e){Ia.pushMessages(e)})),S.shareInstance().addCloseStreamListener((function(e){setTimeout((function(){return S.shareInstance().removeCloseStreamListener()}),0),k.error("发起关闭会话",performance.now());var t,n,r={ignoreTrack:!0,eventTypeId:29,tag:"StreamClose",serverTime:(t=Eo.getTimePair())[0],clientTime:t[1],eventAttr:{},sessionId:Ne.shareInstance().sessionId,uid:Uo.shareInstance().uid,sentCallBack:function(){}};if(!e&&0!=Eo.isLoadingServeTime())return Ia.pushMessage(r),Ia.close(" from tab close");var o=new Promise((function(e){return s(void 0,void 0,void 0,(function(){return u(this,(function(t){return n=e,[2]}))}))}));return Fa.add((function(e){r.serverTime=e(r.serverTime),r.sentCallBack=function(){k.error("结束流事件发送成功",performance.now()),s(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,Ia.waitUntilRunningStopped()];case 1:return e.sent(),k.error("发送机发送完毕",performance.now()),Ia.lock(),n(!0),[2]}}))}))},za.pipe(r),Dr.close()})),e||Ia.close(" from tab close"),o}));var Xa=new Oi,Ja=Ho(Qo,"next"),Qa=Ho(Xa);Ja.next((function(e){return function(e){var t=Eo.getTimePair();return{tag:"Log",data:e,clienttime:t[1],pageWhich:Ii.pageWhich,timestamp:t[0],pageUrl:Ii.previousHistoryUrl}}(e)})).next((function(e){Xa.add((function(t){return e.timestamp=t(e.timestamp),e}))})),Qa.next((function(e){return La(e)})).next((function(e){Ia.pushMessage(e)}));var Ya=function(){Qa.start(),Ja.start()},Za=function(){Ja.stop()};var es=new Oi,ts=Ho(bi,"next"),ns=Ho(es);ts.next((function(e){return function(e){var t=e.relativelyTime;return{tag:"network",data:a(a({},e),{pageUrl:Ii.getPageUrlByTimestamp(t)||"",pageWhich:"".concat(Ii.pageWhich),clientTimestamp:t}),timestamp:t,clienttime:0}}(e)})).next((function(e){es.add((function(t){return e.timestamp=t(e.timestamp),e.data.clientTimestamp=e.timestamp,e}))})),ns.next((function(e){return La(e)})).next((function(e){Ia.pushMessage(e)}));var rs=function(){ns.start(),ts.start()},os=function(){ts.stop()},is=function(){function e(){var e=this;this.waitQueue=[],Ne.shareInstance().addSessionListener(void 0,(function(){setTimeout((function(){return e.toggle()}),0)}))}return e.prototype.sendBatch=function(e){var t=this;e.forEach((function(e){return t.waitQueue.push(e)})),this.toggle()},e.prototype.toggle=function(){this.waitQueue.length>0&&this.innerSendBatch(this.waitQueue.splice(0,this.waitQueue.length))},e.prototype.innerSendBatch=function(e){return s(this,void 0,void 0,(function(){var t,n,r,o,i,s,c=this;return u(this,(function(u){switch(u.label){case 0:return t=e.filter((function(e){return"js"===e.$filetype})),n=e.filter((function(e){return"css"===e.$filetype&&!e.uploadcss})),r=e.filter((function(e){return"css"===e.$filetype&&!0===e.uploadcss})),t.length>0?(o=N(),[4,this.json(No.ResourceDetectJS,{origin:o,referer:o?o+"/":"",user_agent:navigator.userAgent,originUrls:t.map((function(e){return e.originUrl})),name:t.map((function(e){return e.name})),projectKey:Se.shareInstance().projectKey,streamId:S.shareInstance().streamId})]):[3,2];case 1:i=u.sent(),u.label=2;case 2:return n.length>0?(o=N(),[4,this.json(No.ResourceBindCSS,{origin:o,referer:o?o+"/":"",user_agent:navigator.userAgent,css_urls:n.map((function(e){return e.originUrl})),start_time:1e3*Date.now(),projectKey:Se.shareInstance().projectKey,streamId:S.shareInstance().streamId})]):[3,4];case 3:(i=u.sent())&&i.data&&i.data.length>0&&(s=i.data.filter((function(e){return!e.exist})).map((function(e){return a({index:e.index},n.find((function(t){return t.originUrl===e.url})))})),s.length>0&&$r.downloadSourceFiles(s,{uploadcss:!0})),u.label=4;case 4:return r.length>0&&r.forEach((function(e){c.json(No.ResourceUpladCSS,{css_url:e.originUrl,file:e.file,index:e.index,name:e.name,projectKey:Se.shareInstance().projectKey,streamId:S.shareInstance().streamId})})),[2]}}))}))},e.prototype.json=function(e,t,n){var r=process.env.HOST;return a({"Content-Type":"application/json"},(null==n?void 0:n.headers)||{}),wr(r+e,t)},e}(),as=new is;$r.init(),$r.registerFinishCallback((function(e){as.sendBatch(e)}));var ss=Ho(Do,"emit"),us={pipe:function(e){return e}},cs=Ho(us);ss.next((function(e){return e.type===Vn.FullSnapshot&&$r.recursiveLoadUploadScripts(),e})).next((function(e){Ua.add((function(t){e.timestamp=t(e.timestamp),us.pipe(e)}))})),cs.next((function(e){return La(e)})).next((function(e){return Ia.pushMessage(e)}));var ls=function(){cs.start(),ss.start()},ps=function(){ss.stop()},ds=Ho(Ua,"overLimit");ds.next((function(){ps()})).next((function(){ds.stop(),hr({viewTimeListOver:Ua.queueLength})}));var hs,fs,ms=(hs=Dr,fs="init",(new qo).create(hs,!1,fs)),vs=Ho(Dr,"close").start(),gs=Ho(Dr,"open");function ys(){$a(),Ya(),rs(),ls()}function bs(){var e=Dr.switchList;e.log&&Qo.observe(),e.network&&bi.observe(),e.view&&Do.reset()}Ho(Dr,"setMode").next((function(){E(Dr.mode)})).start(),ms.next((function(e,t){if(e!==Cr.open)return t;ys()})).next((function(){qt.clearCssRule(),qt.setCssRule(Dr.viewConfig.selectors),qt.setGlobal(Dr.viewConfig.global),Ii.initRefresh(),Xi.observe(),bs()})),gs.next((function(){ys()})).next((function(){bs()})),vs.next((function(){Ka(),Za(),os(),ps()})).next((function(){Qo.disconnect(),bi.disconnect(),Do.destroy()}));var ws=function(){ms.start()},Ss=!1;hr({sdkRunStart:performance.now()}),window.addEventListener("beforeunload",(function(){hr({pageClose:performance.now(),sdkReady:Ss})}));var ks,Ts=function(){function e(){this.isInitReady=!1}return e.prototype.reset=function(){Uo.shareInstance().identify("")},Object.defineProperty(e.prototype,"mode",{get:function(){return Dr.mode},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){return s(this,void 0,void 0,(function(){var n,r;return u(this,(function(o){switch(o.label){case 0:return this.isInitReady=!1,k.log("userview-sdk init satrt",e,t),this.options=a({},t),this.projectKey=e,n=null==t?void 0:t.userInfo,hr({sdkInitStart:performance.now()}),Se.shareInstance().setup(e),Uo.shareInstance().setup(),n&&this.identify(n),[4,this.setup(e)];case 1:return r=o.sent(),this.isInitReady=!0,hr({sdkInitEnd:performance.now(),sdkStatus:r}),Ss=!0,[2]}}))}))},e.prototype.setHost=function(e){},e.prototype.userSet=function(e){return Uo.shareInstance().userSet(e)},e.prototype.setup=function(e){var t;return s(this,void 0,void 0,(function(){return u(this,(function(n){return S.shareInstance().setup(),Ne.shareInstance().setup(),ws(),[2,Dr.init({projectKey:e,mode:null===(t=this.options.config)||void 0===t?void 0:t.mode})]}))}))},e.prototype.quicklyClose=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e={sessionId:Ne.shareInstance().sessionId,streamId:S.shareInstance().streamId,projectId:Dr.projectKey},[4,S.shareInstance().closeStreamHandler(null,!0)];case 1:return t.sent(),[2,e]}}))}))},e.prototype.setMode=function(e){Dr.setMode(e)},e.prototype.identify=function(e){var t=Uo.shareInstance().identify(null==e?void 0:e.uid,null==e?void 0:e.info).status;this.isInitReady||t!==Po.loginSwitch||Uo.shareInstance().storeUser(null==e?void 0:e.uid,null==e?void 0:e.info)},e.prototype.track=function(e,t){},e}(),xs=new Ts;!function(e){e.initialize="initialize",e.identify="identify"}(ks||(ks={}));var _s,Is,Cs=window.__UV__INVOKE||[];_s=xs.identify,Is=xs.initialize,xs.initialize=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o;return u(this,(function(i){switch(i.label){case 0:try{n="userview_pre_user_"+e,r=localStorage.getItem(n)||"",(o=JSON.parse(r))&&o.uid&&((t=t||{}).userInfo=o)}catch(e){}return[4,Is.call(this,e,t)];case 1:return i.sent(),[2]}}))}))},xs.identify=function(e){if("object"===r(e)){var t={uid:e.uid,info:e.info};return e.info||(e.uid&&delete e.uid,t.info=a(a({},e),{name:e.username})),_s.call(xs,t)}hr({comptablityIdentifyError:"invalidOption"})},window.recordInfoCase=window.userview=xs,Cs.forEach((function(e){var t=e.method,n=e.args;xs[t].apply(xs,n)})),function(){if(document){var e=document.querySelector("#eaRecordScript");if(e){var t=e.getAttribute("projectKey");t?Cs.find((function(e){return e.method===ks.initialize}))||xs.initialize(t):hr({noProjectKey:"oldscript"})}}}(),window.__UV__INVOKE=[]}();